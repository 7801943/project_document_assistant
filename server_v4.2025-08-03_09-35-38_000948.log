2025-08-03 09:35:38.000 | INFO     | core.session:process_inactive_sessions:487 - 检测到 1 个不活动会话，将执行登出: admin
2025-08-03 09:35:38.001 | INFO     | core.session:process_inactive_sessions:493 - APScheduler: 用户 'admin' (会话 2e161de5-c90d-4da5-b539-c3b63899d156) 因不活动被自动登出。
2025-08-03 09:35:38.001 | INFO     | core.session:process_inactive_sessions:495 - APScheduler: 尝试关闭用户 'admin' 的不活动WebSocket连接。
2025-08-03 09:35:38.109 | DEBUG    | sse_proxy.sse2websocket1:run:304 - WebSocket 会话 2e161de5-c90d-4da5-b539-c3b63899d156 用户 admin 断开连接
2025-08-03 09:35:38.109 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-03 12:32:25.946 | INFO     | __main__:combined_lifespan:130 - COMBINED LIFESPAN END - PID: 98966 - 服务器关闭中...
2025-08-03 12:32:25.946 | INFO     | database.document_service:shutdown:469 - 正在关闭 DocumentQueryService...
2025-08-03 12:32:25.954 | INFO     | database.document_service:shutdown:474 - Watchdog 监控已停止。
2025-08-03 12:32:25.954 | INFO     | database.document_service:shutdown:482 - 后台更新任务已取消。
2025-08-03 12:32:25.955 | INFO     | database.document_service:shutdown:487 - 数据库连接已关闭。
2025-08-03 12:32:25.955 | INFO     | database.document_service:shutdown:489 - DocumentQueryService 已成功关闭。
2025-08-03 12:32:25.955 | INFO     | __main__:combined_lifespan:134 - 统一文档查询服务已关闭。
2025-08-03 12:32:25.955 | INFO     | __main__:combined_lifespan:139 - APScheduler 调度器已关闭。
2025-08-03 12:32:25.955 | INFO     | __main__:combined_lifespan:140 - Custom application resources cleaned up.
2025-08-03 12:45:33.408 | INFO     | __main__:<module>:35 - Loguru 日志系统已初始化。
2025-08-03 12:45:33.408 | INFO     | __main__:<module>:36 - 项目根目录配置为: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-03 12:45:33.408 | INFO     | __main__:<module>:37 - 数据库路径配置为: data/document_service.db
2025-08-03 12:45:33.408 | INFO     | __main__:<module>:38 - 表格列读取配置已加载: {'变电站安装工程概算表': (2, 6), '变电站建筑工程概算表': (2, 6), '电缆输电线路安装工程概算表': (2, 6), '电缆输电线路建筑工程概算表': (2, 6)}
2025-08-03 12:45:33.408 | INFO     | __main__:<module>:39 - kkFileView 服务地址配置为: http://127.0.0.1:8012/kkfileview
2025-08-03 12:45:33.408 | INFO     | __main__:<module>:42 - Dify Agent API Key: ********kGHe
2025-08-03 12:45:33.408 | INFO     | __main__:<module>:43 - Session Secret Key: ********8e5f
2025-08-03 12:45:33.409 | INFO     | __main__:<module>:44 - 服务器ipv6地址为: http://[240e:479:668:3c1c:3a23:4208:8545:430e]:8888
2025-08-03 12:45:33.409 | INFO     | __main__:<module>:151 - FastAPI 应用已实例化并注册到 app_state。
2025-08-03 12:45:33.409 | INFO     | __main__:<module>:154 - CORS中间件已添加，允许所有来源。
2025-08-03 12:45:33.419 | INFO     | __main__:<module>:174 - MCP 服务器 '项目文件检索服务器' 已挂载到 FastAPI 应用的 '/mcp/' 路径。
2025-08-03 12:45:33.434 | INFO     | __main__:combined_lifespan:64 - COMBINED LIFESPAN START - PID: 3403251 - 服务器启动中...
2025-08-03 12:45:33.469 | INFO     | __main__:combined_lifespan:69 - HTTPX 客户端已创建并注册到 app_state。
2025-08-03 12:45:33.469 | INFO     | utils.utils:check_embedding_service_health:28 - 正在检查嵌入模型服务，目标URL: http://127.0.0.1:8001/v1/models
2025-08-03 12:45:33.475 | INFO     | utils.utils:check_embedding_service_health:37 - 嵌入模型服务可用，模型列表: ['/home/zhouxiang/models/BAAI_bge-m3']
2025-08-03 12:45:33.475 | INFO     | core.session:__init__:79 - SessionStateManager已初始化。整体HTTP不活动超时: 3600秒
2025-08-03 12:45:33.475 | INFO     | __main__:combined_lifespan:77 - SessionStateManager 已实例化并注册到 app_state。
2025-08-03 12:45:33.475 | INFO     | database.document_service:__init__:164 - 有效文档根目录: {'项目文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/Projects1'), '规范文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/规程规范'), '管理文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/管理文件')}
2025-08-03 12:45:33.476 | DEBUG    | database.document_service:_init_db:180 - 初始化数据库
2025-08-03 12:45:33.476 | DEBUG    | database.document_service:_init_db:201 - 数据库初始化完成
2025-08-03 12:45:33.476 | INFO     | database.document_service:__init__:177 - DocumentQueryService 初始化完成
2025-08-03 12:45:33.476 | INFO     | database.document_service:full_scan:324 - 开始全量扫描...
2025-08-03 12:45:33.476 | INFO     | database.document_service:full_scan:327 - 正在扫描 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-03 12:45:38.695 | INFO     | database.document_service:full_scan:327 - 正在扫描 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-03 12:45:38.907 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_12_479_254_639_268_0.jpg
2025-08-03 12:45:38.908 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_19_1142_1062_132_174_0.jpg
2025-08-03 12:45:38.908 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_67_179_250_1020_1864_0.jpg
2025-08-03 12:45:38.908 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_68_163_248_1019_1887_0.jpg
2025-08-03 12:45:38.908 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_235_1053_1153_960_0.jpg
2025-08-03 12:45:38.908 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_257_392_1118_414_0.jpg
2025-08-03 12:45:38.908 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_227_383_1163_510_0.jpg
2025-08-03 12:45:38.909 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_234_1152_1146_503_0.jpg
2025-08-03 12:45:38.909 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_71_416_1374_824_646_0.jpg
2025-08-03 12:45:38.909 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_73_362_1146_917_618_0.jpg
2025-08-03 12:45:38.909 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_74_573_1274_462_123_0.jpg
2025-08-03 12:45:38.909 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_76_248_1224_1104_782_0.jpg
2025-08-03 12:45:38.909 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_78_242_276_1113_842_0.jpg
2025-08-03 12:45:38.909 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_80_347_280_898_515_0.jpg
2025-08-03 12:45:38.909 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_86_210_747_1187_915_0.jpg
2025-08-03 12:45:38.910 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_87_238_256_1180_936_0.jpg
2025-08-03 12:45:38.910 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_91_256_269_1156_955_0.jpg
2025-08-03 12:45:38.910 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_232_301_1140_940_0.jpg
2025-08-03 12:45:38.910 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_233_1466_1147_602_0.jpg
2025-08-03 12:45:38.910 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_93_324_268_737_1834_0.jpg
2025-08-03 12:45:38.913 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_361_435_977_304_0.jpg
2025-08-03 12:45:38.914 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_616_930_468_258_0.jpg
2025-08-03 12:45:38.914 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_287_1114_1128_645_0.jpg
2025-08-03 12:45:38.914 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_304_320_1113_638_0.jpg
2025-08-03 12:45:38.914 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_214_315_1133_645_0.jpg
2025-08-03 12:45:38.914 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_220_1122_1142_645_0.jpg
2025-08-03 12:45:38.914 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_287_1119_1136_651_0.jpg
2025-08-03 12:45:38.915 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_299_324_1134_642_0.jpg
2025-08-03 12:45:38.915 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_203_320_1145_655_0.jpg
2025-08-03 12:45:38.915 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_227_1129_1130_645_0.jpg
2025-08-03 12:45:38.915 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_290_1126_1125_656_0.jpg
2025-08-03 12:45:38.915 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_306_322_1119_646_0.jpg
2025-08-03 12:45:38.915 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_212_221_1133_659_0.jpg
2025-08-03 12:45:38.915 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_225_1049_1127_636_0.jpg
2025-08-03 12:45:38.915 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_0_1237_154_289_162_0.jpg
2025-08-03 12:45:38.916 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_253_704_552_467_0.jpg
2025-08-03 12:45:38.916 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_884_684_459_455_0.jpg
2025-08-03 12:45:38.916 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_143_500_318_578_556_0.jpg
2025-08-03 12:45:38.916 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_146_315_228_1095_400_0.jpg
2025-08-03 12:45:38.916 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_150_286_250_1129_814_0.jpg
2025-08-03 12:45:38.916 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_248_725_1164_564_0.jpg
2025-08-03 12:45:38.916 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_388_215_897_435_0.jpg
2025-08-03 12:45:38.917 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_287_1311_1133_384_0.jpg
2025-08-03 12:45:38.917 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_70_393_948_902_341_0.jpg
2025-08-03 12:45:38.917 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_72_258_681_1160_1355_0.jpg
2025-08-03 12:45:38.917 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_75_240_362_1177_1656_0.jpg
2025-08-03 12:45:38.917 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_78_240_318_1168_1731_0.jpg
2025-08-03 12:45:38.917 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_81_248_343_1165_1687_0.jpg
2025-08-03 12:45:38.917 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_84_238_386_1162_1624_0.jpg
2025-08-03 12:45:38.917 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_86_239_653_1166_1338_0.jpg
2025-08-03 12:45:38.918 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_88_623_450_653_646_0.jpg
2025-08-03 12:45:38.918 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_90_238_296_1174_1720_0.jpg
2025-08-03 12:45:38.918 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_91_225_299_1187_1707_0.jpg
2025-08-03 12:45:38.918 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_94_257_289_1171_1697_0.jpg
2025-08-03 12:45:38.918 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_97_227_303_1170_1731_0.jpg
2025-08-03 12:45:38.918 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_101_225_672_1178_1353_0.jpg
2025-08-03 12:45:38.918 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_102_240_291_1203_1722_0.jpg
2025-08-03 12:45:38.918 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_103_240_297_1178_1734_0.jpg
2025-08-03 12:45:38.919 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_119_475_1184_667_691_0.jpg
2025-08-03 12:45:38.919 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_121_593_1023_425_178_0.jpg
2025-08-03 12:45:38.919 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_122_444_294_775_206_0.jpg
2025-08-03 12:45:38.919 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_413_902_778_279_0.jpg
2025-08-03 12:45:38.919 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_419_1314_768_347_0.jpg
2025-08-03 12:45:38.919 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_126_387_330_904_455_0.jpg
2025-08-03 12:45:38.919 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_129_362_691_912_684_0.jpg
2025-08-03 12:45:38.920 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_137_501_1634_612_391_0.jpg
2025-08-03 12:45:38.920 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_138_536_226_623_387_0.jpg
2025-08-03 12:45:38.920 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_177_316_1559_1037_507_0.jpg
2025-08-03 12:45:38.920 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_187_373_890_922_309_0.jpg
2025-08-03 12:45:38.920 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_389_874_879_339_0.jpg
2025-08-03 12:45:38.920 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_509_232_635_564_0.jpg
2025-08-03 12:45:38.920 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_514_1307_644_653_0.jpg
2025-08-03 12:45:38.920 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_318_1309_1020_458_0.jpg
2025-08-03 12:45:38.921 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_397_458_892_388_0.jpg
2025-08-03 12:45:38.921 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_539_1403_583_424_0.jpg
2025-08-03 12:45:38.921 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_194_438_645_754_434_0.jpg
2025-08-03 12:45:38.921 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_365_222_908_608_0.jpg
2025-08-03 12:45:38.921 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_385_1267_869_447_0.jpg
2025-08-03 12:45:38.921 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_206_501_795_660_1153_0.jpg
2025-08-03 12:45:38.921 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_208_581_1522_499_443_0.jpg
2025-08-03 12:45:38.922 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_209_536_235_551_971_0.jpg
2025-08-03 12:45:38.922 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_210_246_516_270_300_0.jpg
2025-08-03 12:45:38.922 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_128_411_445_833_494_0.jpg
2025-08-03 12:45:38.922 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_428_384_769_490_0.jpg
2025-08-03 12:45:38.922 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_49_529_271_627_470_0.jpg
2025-08-03 12:45:38.922 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_66_257_325_1140_552_0.jpg
2025-08-03 12:45:38.923 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_1090_878_289_229_0.jpg
2025-08-03 12:45:38.923 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_432_894_219_206_0.jpg
2025-08-03 12:45:38.923 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_728_895_247_200_0.jpg
2025-08-03 12:45:38.923 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1095_623_266_169_0.jpg
2025-08-03 12:45:38.923 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1141_832_201_101_0.jpg
2025-08-03 12:45:38.923 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_444_641_235_139_0.jpg
2025-08-03 12:45:38.923 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_459_831_166_104_0.jpg
2025-08-03 12:45:38.923 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_724_603_276_178_0.jpg
2025-08-03 12:45:38.924 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_747_821_223_122_0.jpg
2025-08-03 12:45:38.931 | INFO     | database.document_service:full_scan:327 - 正在扫描 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-03 12:45:38.931 | INFO     | database.document_service:full_scan:332 - 全量扫描完成，共处理文件数: 1554
2025-08-03 12:45:38.931 | DEBUG    | database.document_service:_start_watchdog:335 - 启动文件监控 Watchdog
2025-08-03 12:45:38.931 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-03 12:45:38.932 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-03 12:45:38.932 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-03 12:45:38.947 | INFO     | database.document_service:_start_watchdog:423 - Watchdog 已启动
2025-08-03 12:45:38.947 | INFO     | database.document_service:start:465 - DocumentQueryService 已启动
2025-08-03 12:45:38.947 | INFO     | __main__:combined_lifespan:83 - 统一文档查询服务 (DocumentQueryService) 已启动。
2025-08-03 12:45:38.948 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/Projects1', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-03 12:45:38.948 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/规程规范', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-03 12:45:38.948 | INFO     | __main__:combined_lifespan:88 - 项目和规程的文件服务已初始化。
2025-08-03 12:45:38.949 | INFO     | __main__:combined_lifespan:93 - AsyncIOScheduler 已实例化并注册到 app_state。
2025-08-03 12:45:38.949 | INFO     | __main__:combined_lifespan:97 - FastMCP lifespan context entered.
2025-08-03 12:45:38.949 | INFO     | __main__:combined_lifespan:117 - 处理不活动用户会话任务已添加到APScheduler (每 60s)。
2025-08-03 12:45:38.949 | INFO     | __main__:combined_lifespan:120 - 清理用户会话中已打开文件token任务已添加到APScheduler (每 120s)。
2025-08-03 12:45:38.950 | INFO     | __main__:combined_lifespan:123 - APScheduler 调度器已启动。
2025-08-03 12:45:38.950 | INFO     | __main__:combined_lifespan:124 - 所有初始化完成... yield
2025-08-03 12:45:38.950 | DEBUG    | database.document_service:_debounced_update_loop:426 - 启动去抖更新循环
2025-08-03 12:46:03.532 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: 682ddc55-221d-4fd0-b9bf-b76eba22dfe5, IP: 2409:8a20:2cc3:7eb0:1928:5b0:a4b4:2e2d) 登录/状态更新成功。
2025-08-03 12:46:03.532 | INFO     | api.route:login:69 - 用户 'admin' (IP: 2409:8a20:2cc3:7eb0:1928:5b0:a4b4:2e2d, Session: 682ddc55-221d-4fd0-b9bf-b76eba22dfe5) 登录成功。
2025-08-03 12:46:08.164 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 682ddc55-221d-4fd0-b9bf-b76eba22dfe5) 的 WebSocket 已连接并关联。
2025-08-03 12:46:08.237 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-03 12:46:19.657 | INFO     | my_mcp_tools.mcp_tools:query_project_files:737 - 工具调用 (新版): query_project_files, 项目关键字='船闸', 年份='None'
2025-08-03 12:46:19.657 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-03 12:46:19.668 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:766 - 模糊匹配查询到 1 个项目: ['江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计']
2025-08-03 12:46:19.668 | INFO     | my_mcp_tools.mcp_tools:query_project_files:770 - 模糊匹配到唯一项目: '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计'
2025-08-03 12:46:19.669 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计']
2025-08-03 12:46:19.670 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计'，包含 77 个文件。
2025-08-03 12:46:19.671 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-03 12:46:19.673 | DEBUG    | api.route:test_button_clicked:231 - test_button_clicked 调用结果:meta=None content=[TextContent(type='text', text='{"project_name": "江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计", "project_files": ["2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/testlogmsg.txt", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/会议纪要_江苏苏州船闸110千伏变电站2号3号主变扩建工程2024.7.23.docx", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/材料清册解析.py", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/测试/02容西220千伏变电站110千伏间隔保护改造工程.zip", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/测试/03新坊220千伏变电站110千伏间隔保护改造工程.zip", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/测试/Top Gun • Danger Zone • Kenny Loggins.mkv", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/测试/WANGFEI.mp3", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/测试/口是心非-张雨生 国语MV.mp3", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/测试/王傑 Dave Wang - 是否我真的一無所有 Is It True That I Have Nothing Of My Own (官方完整版MV).mp3", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/测试/电投能源.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/测试/苏电发展接入意见〔2024〕110号(盖章).pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/测试/辛晓琪这首《俩俩相忘》经典好听，相濡以沫，不如相忘于江湖.mp3", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/测试/關淑怡-難得有情人(粵語版).mp3", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/测试/高资/S24020C-A01-01-初步设计说明书（签字）(1).pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/测试/高资/S24020C-A01-02-材料清册（签字）.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/测试/高资/苏电发展接入意见〔2024〕117号(盖章).pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/测试/高资/苏电设规划〔2024〕110号(盖章).pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/测试/高资/镇供电发展〔2024〕290号\u3000国网江苏省电力有限公司镇江供电分公司关于江苏镇江高资100MW农光_.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-01 胥口~石湖T接船闸变电站110千伏线路工程（电缆）初步设计说明书20240715.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-02 电缆线路路径图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-03 苏州市2025年市区电网接线示意图 Model (1).pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-04 电缆土建一览图-船闸20240605 Model (1).pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-05 电缆引下接线示意图 Model (1).pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-06 船闸变110kV屋内配电装置平面布置图 Model (1).pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-07 电缆金属护层接地方式图 Model (1).pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-08 电缆支架示意图 Model (1).pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-09 电缆敷设断面图 Model (1).pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-10 接头井内电缆布置示意图 Model (1).pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-11 电缆沟接地图 Model (1).pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-12 电缆防火示意图 Model (1).pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-13 电缆夹具 Model (1).pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-14 设备材料清册1-2.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/概算书/.~lock.胥口～石湖T接船闸变110千伏线路工程-概算7.23.xlsx#", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/概算书/胥口～石湖T接船闸变110千伏线路工程-概算7.23.xlsx", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/概算书/胥口～石湖T接船闸变110千伏线路工程-概算7.23.zwzj", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-01 初步设计说明书.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-D1-01 电气主接线图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-D1-02 电气总平面及一层平面布置图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-D1-03 二层平面布置图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-D1-04 三层平面布置图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-D1-05 电气总断面布置图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-D2-01 二次设备室平面布置图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-D2-02 继电保护配置图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-D2-03 计算机监控系统示意图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-ML 目录.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-X1-01 2022年苏州市区35千伏及以上电网地理接线示意图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-X1-02 2025年苏州市区35千伏及以上电网地理接线示意图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.zwzj", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-01 初步设计说明书.docx", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-D1-01 电气主接线图.dwg", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-D1-02~05 电气总平面及各层平面布置图、断面图.dwg", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-D2-01~03.dwg", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-ML 目录.dwg", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-X1-01.dwg", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-X1-02.dwg", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/test.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/江苏苏州船闸110千伏变电站2号3号主变扩建工程-初设汇报.pptx", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.zwzj", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-A-01 初步设计说明书.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-A-02 主要设备材料清册.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-D1-01 电气主接线图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-D1-02 电气总平面及一层平面布置图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-D1-03 二层平面布置图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-D1-04 三层平面布置图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-D1-05 电气总断面布置图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-D2-01 二次设备室平面布置图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-D2-02 继电保护配置图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-D2-03 计算机监控系统示意图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-ML 目录.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-X1-01 2022年苏州市区35千伏及以上电网地理接线示意图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-X1-02 2025年苏州市区35千伏及以上电网地理接线示意图.pdf", "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/船闸110千伏变电站2号3号主变扩建工程-概算书.pdf"], "hint": "文件较多，若用户无要求，无需罗列"}', annotations=None)] isError=False
2025-08-03 12:46:24.345 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/a9e0aa71c7f3468ab3ddfc275891c931/WANGFEI.mp3
2025-08-03 12:47:01.897 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/c38c0539edf7473a8c90cb1369387885/会议纪要_江苏苏州船闸110千伏变电站2号3号主变扩建工程2024.7.23.docx
2025-08-03 12:47:01.903 | INFO     | core.session:get_downloadable_file_info:439 - 下载token 'c38c0539edf7473a8c90cb1369387885' (文件: 会议纪要_江苏苏州船闸110千伏变电站2号3号主变扩建工程2024.7.23.docx, 用户: admin) 在 working_directory 中验证成功。
2025-08-03 12:47:01.904 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '会议纪要_江苏苏州船闸110千伏变电站2号3号主变扩建工程2024.7.23_3362aa18.docx' 与Token关联文件名 '会议纪要_江苏苏州船闸110千伏变电站2号3号主变扩建工程2024.7.23.docx' 不匹配。将使用Token关联文件名。
2025-08-03 12:47:01.904 | DEBUG    | api.route:download_file_via_token:186 - Token 'c38c0539edf7473a8c90cb1369387885' 验证成功。准备下载文件: '会议纪要_江苏苏州船闸110千伏变电站2号3号主变扩建工程2024.7.23.docx' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/会议纪要_江苏苏州船闸110千伏变电站2号3号主变扩建工程2024.7.23.docx', URL文件名: '会议纪要_江苏苏州船闸110千伏变电站2号3号主变扩建工程2024.7.23_3362aa18.docx')
2025-08-03 12:47:13.019 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/d042e3c64a284f62ad6685ea42493f63/382-S230168C-A-01 胥口~石湖T接船闸变电站110千伏线路工程（电缆）初步设计说明书20240715.pdf
2025-08-03 12:47:14.865 | INFO     | core.session:get_downloadable_file_info:439 - 下载token 'd042e3c64a284f62ad6685ea42493f63' (文件: 382-S230168C-A-01 胥口~石湖T接船闸变电站110千伏线路工程（电缆）初步设计说明书20240715.pdf, 用户: admin) 在 working_directory 中验证成功。
2025-08-03 12:47:14.865 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '382-S230168C-A-01 胥口~石湖T接船闸变电站110千伏线路工程（电缆）初步设计说明书20240715_a0b32b69.pdf' 与Token关联文件名 '382-S230168C-A-01 胥口~石湖T接船闸变电站110千伏线路工程（电缆）初步设计说明书20240715.pdf' 不匹配。将使用Token关联文件名。
2025-08-03 12:47:14.865 | DEBUG    | api.route:download_file_via_token:186 - Token 'd042e3c64a284f62ad6685ea42493f63' 验证成功。准备下载文件: '382-S230168C-A-01 胥口~石湖T接船闸变电站110千伏线路工程（电缆）初步设计说明书20240715.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-01 胥口~石湖T接船闸变电站110千伏线路工程（电缆）初步设计说明书20240715.pdf', URL文件名: '382-S230168C-A-01 胥口~石湖T接船闸变电站110千伏线路工程（电缆）初步设计说明书20240715_a0b32b69.pdf')
2025-08-03 12:47:14.868 | INFO     | core.session:get_downloadable_file_info:439 - 下载token 'd042e3c64a284f62ad6685ea42493f63' (文件: 382-S230168C-A-01 胥口~石湖T接船闸变电站110千伏线路工程（电缆）初步设计说明书20240715.pdf, 用户: admin) 在 working_directory 中验证成功。
2025-08-03 12:47:14.868 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '382-S230168C-A-01 胥口~石湖T接船闸变电站110千伏线路工程（电缆）初步设计说明书20240715_a0b32b69.pdf' 与Token关联文件名 '382-S230168C-A-01 胥口~石湖T接船闸变电站110千伏线路工程（电缆）初步设计说明书20240715.pdf' 不匹配。将使用Token关联文件名。
2025-08-03 12:47:14.868 | DEBUG    | api.route:download_file_via_token:186 - Token 'd042e3c64a284f62ad6685ea42493f63' 验证成功。准备下载文件: '382-S230168C-A-01 胥口~石湖T接船闸变电站110千伏线路工程（电缆）初步设计说明书20240715.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/图纸/382-S230168C-A-01 胥口~石湖T接船闸变电站110千伏线路工程（电缆）初步设计说明书20240715.pdf', URL文件名: '382-S230168C-A-01 胥口~石湖T接船闸变电站110千伏线路工程（电缆）初步设计说明书20240715_a0b32b69.pdf')
2025-08-03 13:01:16.028 | DEBUG    | sse_proxy.sse2websocket1:run:304 - WebSocket 会话 682ddc55-221d-4fd0-b9bf-b76eba22dfe5 用户 admin 断开连接
2025-08-03 13:01:16.028 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-03 13:01:16.028 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-03 13:01:16.129 | INFO     | __main__:combined_lifespan:130 - COMBINED LIFESPAN END - PID: 3403251 - 服务器关闭中...
2025-08-03 13:01:16.129 | INFO     | database.document_service:shutdown:469 - 正在关闭 DocumentQueryService...
2025-08-03 13:01:16.137 | INFO     | database.document_service:shutdown:474 - Watchdog 监控已停止。
2025-08-03 13:01:16.137 | INFO     | database.document_service:shutdown:482 - 后台更新任务已取消。
2025-08-03 13:01:16.138 | INFO     | database.document_service:shutdown:487 - 数据库连接已关闭。
2025-08-03 13:01:16.138 | INFO     | database.document_service:shutdown:489 - DocumentQueryService 已成功关闭。
2025-08-03 13:01:16.138 | INFO     | __main__:combined_lifespan:134 - 统一文档查询服务已关闭。
2025-08-03 13:01:16.138 | INFO     | __main__:combined_lifespan:139 - APScheduler 调度器已关闭。
2025-08-03 13:01:16.138 | INFO     | __main__:combined_lifespan:140 - Custom application resources cleaned up.
2025-08-03 13:08:47.458 | INFO     | __main__:<module>:35 - Loguru 日志系统已初始化。
2025-08-03 13:08:47.458 | INFO     | __main__:<module>:36 - 项目根目录配置为: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-03 13:08:47.459 | INFO     | __main__:<module>:37 - 数据库路径配置为: data/document_service.db
2025-08-03 13:08:47.459 | INFO     | __main__:<module>:38 - 表格列读取配置已加载: {'变电站安装工程概算表': (2, 6), '变电站建筑工程概算表': (2, 6), '电缆输电线路安装工程概算表': (2, 6), '电缆输电线路建筑工程概算表': (2, 6)}
2025-08-03 13:08:47.459 | INFO     | __main__:<module>:39 - kkFileView 服务地址配置为: http://127.0.0.1:8012/kkfileview
2025-08-03 13:08:47.459 | INFO     | __main__:<module>:42 - Dify Agent API Key: ********kGHe
2025-08-03 13:08:47.459 | INFO     | __main__:<module>:43 - Session Secret Key: ********2234
2025-08-03 13:08:47.459 | INFO     | __main__:<module>:44 - 服务器ipv6地址为: http://[240e:479:668:3c1c:3a23:4208:8545:430e]:8888
2025-08-03 13:08:47.460 | INFO     | __main__:<module>:151 - FastAPI 应用已实例化并注册到 app_state。
2025-08-03 13:08:47.460 | INFO     | __main__:<module>:154 - CORS中间件已添加，允许所有来源。
2025-08-03 13:08:47.470 | INFO     | __main__:<module>:174 - MCP 服务器 '项目文件检索服务器' 已挂载到 FastAPI 应用的 '/mcp/' 路径。
2025-08-03 13:08:47.486 | INFO     | __main__:combined_lifespan:64 - COMBINED LIFESPAN START - PID: 3436546 - 服务器启动中...
2025-08-03 13:08:47.522 | INFO     | __main__:combined_lifespan:69 - HTTPX 客户端已创建并注册到 app_state。
2025-08-03 13:08:47.522 | INFO     | utils.utils:check_embedding_service_health:28 - 正在检查嵌入模型服务，目标URL: http://127.0.0.1:8001/v1/models
2025-08-03 13:08:47.529 | INFO     | utils.utils:check_embedding_service_health:37 - 嵌入模型服务可用，模型列表: ['/home/zhouxiang/models/BAAI_bge-m3']
2025-08-03 13:08:47.529 | INFO     | core.session:__init__:79 - SessionStateManager已初始化。整体HTTP不活动超时: 3600秒
2025-08-03 13:08:47.529 | INFO     | __main__:combined_lifespan:77 - SessionStateManager 已实例化并注册到 app_state。
2025-08-03 13:08:47.529 | INFO     | database.document_service:__init__:164 - 有效文档根目录: {'项目文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/Projects1'), '规范文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/规程规范'), '管理文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/管理文件')}
2025-08-03 13:08:47.529 | DEBUG    | database.document_service:_init_db:180 - 初始化数据库
2025-08-03 13:08:47.529 | DEBUG    | database.document_service:_init_db:201 - 数据库初始化完成
2025-08-03 13:08:47.530 | INFO     | database.document_service:__init__:177 - DocumentQueryService 初始化完成
2025-08-03 13:08:47.530 | INFO     | database.document_service:full_scan:324 - 开始全量扫描...
2025-08-03 13:08:47.530 | INFO     | database.document_service:full_scan:327 - 正在扫描 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-03 13:08:53.239 | INFO     | database.document_service:full_scan:327 - 正在扫描 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-03 13:08:53.457 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_12_479_254_639_268_0.jpg
2025-08-03 13:08:53.457 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_19_1142_1062_132_174_0.jpg
2025-08-03 13:08:53.458 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_67_179_250_1020_1864_0.jpg
2025-08-03 13:08:53.458 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_68_163_248_1019_1887_0.jpg
2025-08-03 13:08:53.458 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_235_1053_1153_960_0.jpg
2025-08-03 13:08:53.458 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_257_392_1118_414_0.jpg
2025-08-03 13:08:53.458 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_227_383_1163_510_0.jpg
2025-08-03 13:08:53.458 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_234_1152_1146_503_0.jpg
2025-08-03 13:08:53.459 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_71_416_1374_824_646_0.jpg
2025-08-03 13:08:53.459 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_73_362_1146_917_618_0.jpg
2025-08-03 13:08:53.459 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_74_573_1274_462_123_0.jpg
2025-08-03 13:08:53.459 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_76_248_1224_1104_782_0.jpg
2025-08-03 13:08:53.459 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_78_242_276_1113_842_0.jpg
2025-08-03 13:08:53.459 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_80_347_280_898_515_0.jpg
2025-08-03 13:08:53.459 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_86_210_747_1187_915_0.jpg
2025-08-03 13:08:53.460 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_87_238_256_1180_936_0.jpg
2025-08-03 13:08:53.460 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_91_256_269_1156_955_0.jpg
2025-08-03 13:08:53.460 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_232_301_1140_940_0.jpg
2025-08-03 13:08:53.460 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_233_1466_1147_602_0.jpg
2025-08-03 13:08:53.460 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_93_324_268_737_1834_0.jpg
2025-08-03 13:08:53.464 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_361_435_977_304_0.jpg
2025-08-03 13:08:53.464 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_616_930_468_258_0.jpg
2025-08-03 13:08:53.464 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_287_1114_1128_645_0.jpg
2025-08-03 13:08:53.464 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_304_320_1113_638_0.jpg
2025-08-03 13:08:53.465 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_214_315_1133_645_0.jpg
2025-08-03 13:08:53.465 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_220_1122_1142_645_0.jpg
2025-08-03 13:08:53.465 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_287_1119_1136_651_0.jpg
2025-08-03 13:08:53.465 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_299_324_1134_642_0.jpg
2025-08-03 13:08:53.465 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_203_320_1145_655_0.jpg
2025-08-03 13:08:53.465 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_227_1129_1130_645_0.jpg
2025-08-03 13:08:53.466 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_290_1126_1125_656_0.jpg
2025-08-03 13:08:53.466 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_306_322_1119_646_0.jpg
2025-08-03 13:08:53.466 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_212_221_1133_659_0.jpg
2025-08-03 13:08:53.466 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_225_1049_1127_636_0.jpg
2025-08-03 13:08:53.466 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_0_1237_154_289_162_0.jpg
2025-08-03 13:08:53.466 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_253_704_552_467_0.jpg
2025-08-03 13:08:53.467 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_884_684_459_455_0.jpg
2025-08-03 13:08:53.467 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_143_500_318_578_556_0.jpg
2025-08-03 13:08:53.467 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_146_315_228_1095_400_0.jpg
2025-08-03 13:08:53.467 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_150_286_250_1129_814_0.jpg
2025-08-03 13:08:53.467 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_248_725_1164_564_0.jpg
2025-08-03 13:08:53.467 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_388_215_897_435_0.jpg
2025-08-03 13:08:53.467 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_287_1311_1133_384_0.jpg
2025-08-03 13:08:53.468 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_70_393_948_902_341_0.jpg
2025-08-03 13:08:53.468 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_72_258_681_1160_1355_0.jpg
2025-08-03 13:08:53.468 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_75_240_362_1177_1656_0.jpg
2025-08-03 13:08:53.468 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_78_240_318_1168_1731_0.jpg
2025-08-03 13:08:53.468 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_81_248_343_1165_1687_0.jpg
2025-08-03 13:08:53.468 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_84_238_386_1162_1624_0.jpg
2025-08-03 13:08:53.469 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_86_239_653_1166_1338_0.jpg
2025-08-03 13:08:53.469 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_88_623_450_653_646_0.jpg
2025-08-03 13:08:53.469 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_90_238_296_1174_1720_0.jpg
2025-08-03 13:08:53.469 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_91_225_299_1187_1707_0.jpg
2025-08-03 13:08:53.469 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_94_257_289_1171_1697_0.jpg
2025-08-03 13:08:53.470 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_97_227_303_1170_1731_0.jpg
2025-08-03 13:08:53.470 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_101_225_672_1178_1353_0.jpg
2025-08-03 13:08:53.470 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_102_240_291_1203_1722_0.jpg
2025-08-03 13:08:53.470 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_103_240_297_1178_1734_0.jpg
2025-08-03 13:08:53.470 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_119_475_1184_667_691_0.jpg
2025-08-03 13:08:53.471 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_121_593_1023_425_178_0.jpg
2025-08-03 13:08:53.471 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_122_444_294_775_206_0.jpg
2025-08-03 13:08:53.471 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_413_902_778_279_0.jpg
2025-08-03 13:08:53.471 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_419_1314_768_347_0.jpg
2025-08-03 13:08:53.471 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_126_387_330_904_455_0.jpg
2025-08-03 13:08:53.471 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_129_362_691_912_684_0.jpg
2025-08-03 13:08:53.472 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_137_501_1634_612_391_0.jpg
2025-08-03 13:08:53.472 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_138_536_226_623_387_0.jpg
2025-08-03 13:08:53.472 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_177_316_1559_1037_507_0.jpg
2025-08-03 13:08:53.472 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_187_373_890_922_309_0.jpg
2025-08-03 13:08:53.472 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_389_874_879_339_0.jpg
2025-08-03 13:08:53.472 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_509_232_635_564_0.jpg
2025-08-03 13:08:53.473 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_514_1307_644_653_0.jpg
2025-08-03 13:08:53.473 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_318_1309_1020_458_0.jpg
2025-08-03 13:08:53.473 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_397_458_892_388_0.jpg
2025-08-03 13:08:53.473 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_539_1403_583_424_0.jpg
2025-08-03 13:08:53.473 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_194_438_645_754_434_0.jpg
2025-08-03 13:08:53.473 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_365_222_908_608_0.jpg
2025-08-03 13:08:53.474 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_385_1267_869_447_0.jpg
2025-08-03 13:08:53.474 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_206_501_795_660_1153_0.jpg
2025-08-03 13:08:53.474 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_208_581_1522_499_443_0.jpg
2025-08-03 13:08:53.474 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_209_536_235_551_971_0.jpg
2025-08-03 13:08:53.474 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_210_246_516_270_300_0.jpg
2025-08-03 13:08:53.474 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_128_411_445_833_494_0.jpg
2025-08-03 13:08:53.474 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_428_384_769_490_0.jpg
2025-08-03 13:08:53.474 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_49_529_271_627_470_0.jpg
2025-08-03 13:08:53.475 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_66_257_325_1140_552_0.jpg
2025-08-03 13:08:53.475 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_1090_878_289_229_0.jpg
2025-08-03 13:08:53.475 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_432_894_219_206_0.jpg
2025-08-03 13:08:53.475 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_728_895_247_200_0.jpg
2025-08-03 13:08:53.475 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1095_623_266_169_0.jpg
2025-08-03 13:08:53.475 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1141_832_201_101_0.jpg
2025-08-03 13:08:53.475 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_444_641_235_139_0.jpg
2025-08-03 13:08:53.475 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_459_831_166_104_0.jpg
2025-08-03 13:08:53.476 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_724_603_276_178_0.jpg
2025-08-03 13:08:53.476 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_747_821_223_122_0.jpg
2025-08-03 13:08:53.483 | INFO     | database.document_service:full_scan:327 - 正在扫描 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-03 13:08:53.483 | INFO     | database.document_service:full_scan:332 - 全量扫描完成，共处理文件数: 1554
2025-08-03 13:08:53.484 | DEBUG    | database.document_service:_start_watchdog:335 - 启动文件监控 Watchdog
2025-08-03 13:08:53.484 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-03 13:08:53.484 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-03 13:08:53.484 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-03 13:08:53.501 | INFO     | database.document_service:_start_watchdog:423 - Watchdog 已启动
2025-08-03 13:08:53.501 | INFO     | database.document_service:start:465 - DocumentQueryService 已启动
2025-08-03 13:08:53.501 | INFO     | __main__:combined_lifespan:83 - 统一文档查询服务 (DocumentQueryService) 已启动。
2025-08-03 13:08:53.502 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/Projects1', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-03 13:08:53.502 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/规程规范', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-03 13:08:53.502 | INFO     | __main__:combined_lifespan:88 - 项目和规程的文件服务已初始化。
2025-08-03 13:08:53.503 | INFO     | __main__:combined_lifespan:93 - AsyncIOScheduler 已实例化并注册到 app_state。
2025-08-03 13:08:53.503 | INFO     | __main__:combined_lifespan:97 - FastMCP lifespan context entered.
2025-08-03 13:08:53.503 | INFO     | __main__:combined_lifespan:117 - 处理不活动用户会话任务已添加到APScheduler (每 60s)。
2025-08-03 13:08:53.503 | INFO     | __main__:combined_lifespan:120 - 清理用户会话中已打开文件token任务已添加到APScheduler (每 120s)。
2025-08-03 13:08:53.504 | INFO     | __main__:combined_lifespan:123 - APScheduler 调度器已启动。
2025-08-03 13:08:53.504 | INFO     | __main__:combined_lifespan:124 - 所有初始化完成... yield
2025-08-03 13:08:53.504 | DEBUG    | database.document_service:_debounced_update_loop:426 - 启动去抖更新循环
2025-08-04 11:17:57.233 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: 14ea8e94-ae04-4c84-8d90-446fd1dcbca4, IP: 127.0.0.1) 登录/状态更新成功。
2025-08-04 11:17:57.234 | INFO     | api.route:login:69 - 用户 'admin' (IP: 127.0.0.1, Session: 14ea8e94-ae04-4c84-8d90-446fd1dcbca4) 登录成功。
2025-08-04 11:17:57.318 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 14ea8e94-ae04-4c84-8d90-446fd1dcbca4) 的 WebSocket 已连接并关联。
2025-08-04 11:17:57.399 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-04 12:18:53.505 | INFO     | core.session:process_inactive_sessions:487 - 检测到 1 个不活动会话，将执行登出: admin
2025-08-04 12:18:53.505 | INFO     | core.session:process_inactive_sessions:493 - APScheduler: 用户 'admin' (会话 14ea8e94-ae04-4c84-8d90-446fd1dcbca4) 因不活动被自动登出。
2025-08-04 12:18:53.505 | INFO     | core.session:process_inactive_sessions:495 - APScheduler: 尝试关闭用户 'admin' 的不活动WebSocket连接。
2025-08-04 12:18:53.505 | DEBUG    | sse_proxy.sse2websocket1:run:304 - WebSocket 会话 14ea8e94-ae04-4c84-8d90-446fd1dcbca4 用户 admin 断开连接
2025-08-04 12:18:53.506 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-05 16:21:53.904 | INFO     | api.route:logout:80 - HTTP会话已清除 (用户: 未知)。
2025-08-05 16:21:55.517 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: 73ef1247-2977-40c7-8bd2-62fdc4a1cf28, IP: 240e:479:668:3c1c:4413:4dd5:7b4e:65f9) 登录/状态更新成功。
2025-08-05 16:21:55.517 | INFO     | api.route:login:69 - 用户 'admin' (IP: 240e:479:668:3c1c:4413:4dd5:7b4e:65f9, Session: 73ef1247-2977-40c7-8bd2-62fdc4a1cf28) 登录成功。
2025-08-05 16:21:55.661 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 73ef1247-2977-40c7-8bd2-62fdc4a1cf28) 的 WebSocket 已连接并关联。
2025-08-05 16:21:55.731 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-05 16:22:33.273 | INFO     | api.upload:handle_project_upload:140 - 用户 'admin' 开始上传项目 '东余变主变扩建工程' 到年份 '2025' (覆盖: False)。
2025-08-05 16:22:33.278 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-E01概算书（完整签名）/B6511C-E01/B6511C-E01-01 概算书（签名件）.pdf
2025-08-05 16:22:33.280 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-E01概算书（完整签名）/B6511C-E01/B6511C-E01-ML 目录（签名件）.pdf
2025-08-05 16:22:33.281 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-06 2024年本工程周边220kV电网接线示意图（签名件）.pdf
2025-08-05 16:22:33.283 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-07 投产年本工程周边220kV电网接线示意图（签名件）.pdf
2025-08-05 16:22:33.287 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-08 电气主接线图（签名件）.pdf
2025-08-05 16:22:33.291 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-09 电气总平面布置图（签名件）.pdf
2025-08-05 16:22:33.295 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-10 电气一层平面布置图（签名件）.pdf
2025-08-05 16:22:33.298 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-11 电气总断面图（签名件）.pdf
2025-08-05 16:22:33.300 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-12 10kV电抗器室断面图（签名件）.pdf
2025-08-05 16:22:33.301 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-13 10kV消弧线圈断面图（签名件）.pdf
2025-08-05 16:22:33.303 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-14 继电保护配置图（签名件）.pdf
2025-08-05 16:22:33.305 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-15 二次设备室平面布置图（签名件）.pdf
2025-08-05 16:22:33.306 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-16 主变间隔保护、监测TA配置图（签名件）.pdf
2025-08-05 16:22:33.308 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-17 220kV线路、110kV线路间隔保护、监测TA配置图（签名件）.pdf
2025-08-05 16:22:33.309 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-18 10kV线路、电容器、电抗器及分段保护、测控TA配置图（签名件）.pdf
2025-08-05 16:22:33.311 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-19 计算机监控系统配置图（签名件）.pdf
2025-08-05 16:22:33.314 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-20 土建总平面布置图（签名件）.pdf
2025-08-05 16:22:33.316 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-21 雨淋阀室平面、屋面图（签名件）.pdf
2025-08-05 16:22:33.317 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-22 室外给水排水管道布置图（签名件）.pdf
2025-08-05 16:22:33.319 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-ML 目录（签名件）.pdf
2025-08-05 16:22:33.325 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf
2025-08-05 16:22:33.327 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-02 主要设备及材料清册（签名件）.pdf
2025-08-05 16:22:33.329 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-03 安全性专篇（签名件）.pdf
2025-08-05 16:22:33.331 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-04 绿色低碳建造设计专篇（签名件）.pdf
2025-08-05 16:22:33.334 | DEBUG    | core.file_service:save_uploaded_file_async:71 - 已成功保存上传的文件到: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-05 施工组织及机械化施工设计专篇（签名件）.pdf
2025-08-05 16:22:33.334 | INFO     | core.file_service:save_uploaded_directory_async:214 - 已成功将 25 个文件保存到目录: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审
2025-08-05 16:22:33.334 | INFO     | api.upload:handle_project_upload:152 - 成功上传 25 个文件到 '2025/东余变主变扩建工程/送审'。
2025-08-05 16:22:33.335 | INFO     | core.file_service:create_placeholder_file_async:163 - 已成功创建占位文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/收口/placeholder.txt
2025-08-05 16:22:33.336 | INFO     | core.file_service:create_placeholder_file_async:163 - 已成功创建占位文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/过程文件/placeholder.txt
2025-08-05 16:22:33.336 | INFO     | api.upload:handle_project_upload:157 - 已成功创建辅助目录的占位文件: '2025/东余变主变扩建工程/收口' 和 '2025/东余变主变扩建工程/过程文件'。
2025-08-05 16:22:37.079 | DEBUG    | database.document_service:_debounced_update_loop:440 - 开始批量更新 27 个文件...位于目录{'/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-E01概算书（完整签名）/B6511C-E01/B6511C-E01-01 概算书（签名件）.pdf': 1754382153.278331, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-E01概算书（完整签名）/B6511C-E01/B6511C-E01-ML 目录（签名件）.pdf': 1754382153.2801452, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-06 2024年本工程周边220kV电网接线示意图（签名件）.pdf': 1754382153.2817886, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-07 投产年本工程周边220kV电网接线示意图（签名件）.pdf': 1754382153.283236, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-08 电气主接线图（签名件）.pdf': 1754382153.286767, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-09 电气总平面布置图（签名件）.pdf': 1754382153.2913935, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-10 电气一层平面布置图（签名件）.pdf': 1754382153.2954345, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-11 电气总断面图（签名件）.pdf': 1754382153.2983603, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-12 10kV电抗器室断面图（签名件）.pdf': 1754382153.3001878, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-13 10kV消弧线圈断面图（签名件）.pdf': 1754382153.3018079, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-14 继电保护配置图（签名件）.pdf': 1754382153.3032231, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-15 二次设备室平面布置图（签名件）.pdf': 1754382153.3049421, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-16 主变间隔保护、监测TA配置图（签名件）.pdf': 1754382153.3064914, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-17 220kV线路、110kV线路间隔保护、监测TA配置图（签名件）.pdf': 1754382153.3080354, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-18 10kV线路、电容器、电抗器及分段保护、测控TA配置图（签名件）.pdf': 1754382153.3096952, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-19 计算机监控系统配置图（签名件）.pdf': 1754382153.3113937, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-20 土建总平面布置图（签名件）.pdf': 1754382153.3138866, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-21 雨淋阀室平面、屋面图（签名件）.pdf': 1754382153.315819, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-22 室外给水排水管道布置图（签名件）.pdf': 1754382153.3177207, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/320-B6511C-A-ML 目录（签名件）.pdf': 1754382153.3192115, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf': 1754382153.3248744, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-02 主要设备及材料清册（签名件）.pdf': 1754382153.3275707, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-03 安全性专篇（签名件）.pdf': 1754382153.3295283, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-04 绿色低碳建造设计专篇（签名件）.pdf': 1754382153.3315985, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-05 施工组织及机械化施工设计专篇（签名件）.pdf': 1754382153.3343153, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/收口/placeholder.txt': 1754382153.335835, '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/过程文件/placeholder.txt': 1754382153.3370516}
2025-08-05 16:22:37.157 | INFO     | database.document_service:_debounced_update_loop:459 - 已更新至数据库
2025-08-05 16:22:45.184 | DEBUG    | api.route:search_project_files:264 - 在 /api/projects/search 中，用户 'admin' 的WebSocket连接状态: connected=True, websocket_obj_exists=True
2025-08-05 16:22:45.184 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') LIKE ? with params: ['项目文件', '%东余%']
2025-08-05 16:22:45.185 | DEBUG    | api.route:search_project_files:277 - find_params={'document_type': '项目文件', 'project_name': '%东余%'}, find_document nums:27
2025-08-05 16:22:45.185 | INFO     | api.route:search_project_files:302 - len(project_list) == 1
2025-08-05 16:22:45.186 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '东余变主变扩建工程']
2025-08-05 16:22:45.186 | DEBUG    | api.route:search_project_files:314 - 即将为用户 'admin' 更新工作目录 '2025/东余变主变扩建工程'，包含 27 个文件。
2025-08-05 16:22:45.187 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '2025/东余变主变扩建工程'，包含 27 个文件。
2025-08-05 16:22:45.187 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-05 16:23:15.691 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-05 16:23:15.691 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 73ef1247-2977-40c7-8bd2-62fdc4a1cf28, 对话ID: 1265a2d6-9005-4588-8ce1-a1bf93024c0e, 查询: 帮我打开东余的项目文件，生成评审意见
2025-08-05 16:23:15.691 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:qwen3-235b-a22b-instruct-2507
2025-08-05 16:23:17.434 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '3', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user": "admin", "project_name": "东余"}'}}]
2025-08-05 16:23:17.434 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user": "admin", "project_name": "东余"}
2025-08-05 16:23:17.477 | INFO     | my_mcp_tools.mcp_tools:query_project_files:737 - 工具调用 (新版): query_project_files, 项目关键字='东余', 年份='None'
2025-08-05 16:23:17.478 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-05 16:23:17.489 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:766 - 模糊匹配查询到 1 个项目: ['东余变主变扩建工程']
2025-08-05 16:23:17.489 | INFO     | my_mcp_tools.mcp_tools:query_project_files:770 - 模糊匹配到唯一项目: '东余变主变扩建工程'
2025-08-05 16:23:17.489 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '东余变主变扩建工程']
2025-08-05 16:23:17.490 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '东余变主变扩建工程'，包含 27 个文件。
2025-08-05 16:23:17.491 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-05 16:23:17.496 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:qwen3-235b-a22b-instruct-2507
2025-08-05 16:23:20.464 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '24', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf", "file_category": "普通文档"}'}}]
2025-08-05 16:23:20.464 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf", "file_category": "普通文档"}
2025-08-05 16:23:20.509 | INFO     | my_mcp_tools.mcp_tools:read_project_file:646 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf', Category: '普通文档'
2025-08-05 16:23:20.509 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:82 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf (相对路径: 2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf)，分隔符: '	'
2025-08-05 16:23:27.140 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:87 - MCP Tool: 解析完成，文件: B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf, 内容长度: 81472
2025-08-05 16:23:27.141 | INFO     | my_mcp_tools.mcp_tools:read_project_file:705 - 从文件 2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf成功读取（预览100字）:检索号：B6511C
编 号：B6511C-A-01
江苏南通东余 220 千伏变电站第二台主变扩建
工程
初步设计
综合
江苏南通东余 220 千伏变电站第二台主变扩建
工程初步设计说明书
江苏科能
2025-08-05 16:23:27.141 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf' (token: 72a9903bf2fb485ba8360a27d79e9fe7), 有效期至: Wed Aug  6 00:23:27 2025
2025-08-05 16:23:27.142 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:718 - 文件 '2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf' 已在会话中注册, token: 72a9903bf2fb485ba8360a27d79e9fe7
2025-08-05 16:23:27.164 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:qwen3-235b-a22b-instruct-2507
2025-08-05 16:23:27.176 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/72a9903bf2fb485ba8360a27d79e9fe7/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf
2025-08-05 16:23:28.089 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）_94e62a1d.pdf' 与Token关联文件名 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf' 不匹配。将使用Token关联文件名。
2025-08-05 16:23:28.089 | DEBUG    | api.route:download_file_via_token:186 - Token '72a9903bf2fb485ba8360a27d79e9fe7' 验证成功。准备下载文件: 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf', URL文件名: 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）_94e62a1d.pdf')
2025-08-05 16:23:28.092 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）_94e62a1d.pdf' 与Token关联文件名 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf' 不匹配。将使用Token关联文件名。
2025-08-05 16:23:28.093 | DEBUG    | api.route:download_file_via_token:186 - Token '72a9903bf2fb485ba8360a27d79e9fe7' 验证成功。准备下载文件: 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf', URL文件名: 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）_94e62a1d.pdf')
2025-08-05 16:23:59.924 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '31', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "主变扩建工程初步设计中电气二次部分的主要技术方案和保护配置要求", "knowledge_base_name": "二次"}'}}]
2025-08-05 16:23:59.924 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "主变扩建工程初步设计中电气二次部分的主要技术方案和保护配置要求", "knowledge_base_name": "二次"}
2025-08-05 16:23:59.966 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:265 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '主变扩建工程初步设计中电气二次部分的主要技术方案和保护配置要求...', top_k: 5
2025-08-05 16:23:59.966 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:278 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-05 16:24:00.239 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:292 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-05 16:24:00.240 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:306 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='主变扩建工程初步设计中电气二次部分的主要技术方案和保护配置要求...', top_k=5
2025-08-05 16:24:00.607 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:313 - 从知识库 '二次' 检索到 5 条结果。
2025-08-05 16:24:00.615 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:qwen3-235b-a22b-instruct-2507
2025-08-05 16:24:03.512 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '38', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "主变扩建工程中水喷雾灭火系统的消防给水系统设计规范", "knowledge_base_name": "消防"}'}}]
2025-08-05 16:24:03.512 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "主变扩建工程中水喷雾灭火系统的消防给水系统设计规范", "knowledge_base_name": "消防"}
2025-08-05 16:24:03.554 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:265 - 工具调用: query_specification_knowledge_base, 知识库: 消防, 用户查询: '主变扩建工程中水喷雾灭火系统的消防给水系统设计规范...', top_k: 5
2025-08-05 16:24:03.554 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:278 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '消防', 'page': 1, 'limit': 10}
2025-08-05 16:24:03.640 | WARNING  | my_mcp_tools.mcp_tools:query_specification_knowledge_base:284 - 未找到名为 '消防' 的知识库。响应: {'data': [], 'has_more': False, 'limit': 10, 'total': 0, 'page': 1}
2025-08-05 16:24:03.646 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:qwen3-235b-a22b-instruct-2507
2025-08-05 16:24:28.738 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '45', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "主变扩建工程中水喷雾灭火系统的消防给水系统设计规范", "knowledge_base_name": "电气"}'}}]
2025-08-05 16:24:28.738 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "主变扩建工程中水喷雾灭火系统的消防给水系统设计规范", "knowledge_base_name": "电气"}
2025-08-05 16:24:28.780 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:265 - 工具调用: query_specification_knowledge_base, 知识库: 电气, 用户查询: '主变扩建工程中水喷雾灭火系统的消防给水系统设计规范...', top_k: 5
2025-08-05 16:24:28.780 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:278 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '电气', 'page': 1, 'limit': 10}
2025-08-05 16:24:28.873 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:292 - 成功获取到知识库 '电气' 的ID: 95bde3ad-88fe-4994-8599-34f155626984
2025-08-05 16:24:28.873 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:306 - 正在向 http://127.0.0.1/v1/datasets/95bde3ad-88fe-4994-8599-34f155626984/retrieve 发起检索请求。Payload (部分): query='主变扩建工程中水喷雾灭火系统的消防给水系统设计规范...', top_k=5
2025-08-05 16:24:29.196 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:313 - 从知识库 '电气' 检索到 5 条结果。
2025-08-05 16:24:29.203 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:qwen3-235b-a22b-instruct-2507
2025-08-05 16:24:33.555 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:479:668:3c1c:4413:4dd5:7b4e:65f9'.
2025-08-05 16:24:55.899 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '52', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "主变扩建工程中水喷雾灭火系统的消防给水系统设计规范", "knowledge_base_name": "二次"}'}}]
2025-08-05 16:24:55.899 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "主变扩建工程中水喷雾灭火系统的消防给水系统设计规范", "knowledge_base_name": "二次"}
2025-08-05 16:24:55.949 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:265 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '主变扩建工程中水喷雾灭火系统的消防给水系统设计规范...', top_k: 5
2025-08-05 16:24:55.950 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:278 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-05 16:24:56.034 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:292 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-05 16:24:56.034 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:306 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='主变扩建工程中水喷雾灭火系统的消防给水系统设计规范...', top_k=5
2025-08-05 16:24:56.245 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:313 - 从知识库 '二次' 检索到 4 条结果。
2025-08-05 16:24:56.251 | WARNING  | sse_proxy.sse2websocket1:_handle_stream:115 - 递归深度超过最大限制(5)，终止工具调用
2025-08-05 16:25:44.578 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:479:668:3c1c:4413:4dd5:7b4e:65f9'.
2025-08-05 16:25:44.579 | INFO     | api.admin:update_admin_config:164 - 从服务商 'kimi' 的预设中加载了 API Key。
2025-08-05 16:25:44.579 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: https://api.moonshot.cn/v1
2025-08-05 16:25:44.579 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: kimi-k2-0711-preview
2025-08-05 16:25:44.579 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******XvEL
2025-08-05 16:25:44.592 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:479:668:3c1c:4413:4dd5:7b4e:65f9'.
2025-08-05 16:25:49.410 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 296b2675-2c6c-4868-988b-a3d37097947c。清空历史记录。
2025-08-05 16:26:11.399 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-05 16:26:11.399 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 73ef1247-2977-40c7-8bd2-62fdc4a1cf28, 对话ID: 296b2675-2c6c-4868-988b-a3d37097947c, 查询: 帮我打开东余主变扩建工程，生成评审意见
2025-08-05 16:26:11.399 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-05 16:26:17.852 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '70', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user": "admin", "project_name": "东余主变扩建工程"}'}}]
2025-08-05 16:26:17.852 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user": "admin", "project_name": "东余主变扩建工程"}
2025-08-05 16:26:17.901 | INFO     | my_mcp_tools.mcp_tools:query_project_files:737 - 工具调用 (新版): query_project_files, 项目关键字='东余主变扩建工程', 年份='None'
2025-08-05 16:26:17.901 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-05 16:26:17.915 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:766 - 模糊匹配查询到 0 个项目: []
2025-08-05 16:26:17.915 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:784 - 使用向量检索辅助判断，候选项目数: 18
2025-08-05 16:26:17.915 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:170 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-05 16:26:18.169 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:200 - 向量检索 Top-3 结果: [('东余变主变扩建工程', 0.9866066781560421), ('1-无锡石园220千伏变电站第二台主变扩建工程', 0.606299840811451), ('江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计', 0.5820063474563466)]
2025-08-05 16:26:18.169 | INFO     | my_mcp_tools.mcp_tools:query_project_files:789 - 向量检索匹配top1项目: '东余变主变扩建工程'
2025-08-05 16:26:18.170 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '东余变主变扩建工程']
2025-08-05 16:26:18.171 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '东余变主变扩建工程'，包含 27 个文件。
2025-08-05 16:26:18.171 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-05 16:26:18.177 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-05 16:26:23.484 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '87', 'type': 'function', 'function': {'name': 'write_review_doc', 'arguments': '{"get_manual": true, "template_type": "主变扩建工程模板"}'}}]
2025-08-05 16:26:23.484 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: write_review_doc with args: {"get_manual": true, "template_type": "主变扩建工程模板"}
2025-08-05 16:26:23.536 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-05 16:26:34.030 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '177', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf", "file_category": "普通文档"}'}}]
2025-08-05 16:26:34.030 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf", "file_category": "普通文档"}
2025-08-05 16:26:34.076 | INFO     | my_mcp_tools.mcp_tools:read_project_file:646 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf', Category: '普通文档'
2025-08-05 16:26:34.077 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:82 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf (相对路径: 2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf)，分隔符: '	'
2025-08-05 16:26:40.705 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:87 - MCP Tool: 解析完成，文件: B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf, 内容长度: 81472
2025-08-05 16:26:40.706 | INFO     | my_mcp_tools.mcp_tools:read_project_file:705 - 从文件 2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf成功读取（预览100字）:检索号：B6511C
编 号：B6511C-A-01
江苏南通东余 220 千伏变电站第二台主变扩建
工程
初步设计
综合
江苏南通东余 220 千伏变电站第二台主变扩建
工程初步设计说明书
江苏科能
2025-08-05 16:26:40.706 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf' (token: bc9807efaa7548138b5f8e878548ba71), 有效期至: Wed Aug  6 00:26:40 2025
2025-08-05 16:26:40.706 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:718 - 文件 '2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf' 已在会话中注册, token: bc9807efaa7548138b5f8e878548ba71
2025-08-05 16:26:40.732 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-05 16:26:40.758 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/bc9807efaa7548138b5f8e878548ba71/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf
2025-08-05 16:26:41.494 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）_b6a79cd2.pdf' 与Token关联文件名 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf' 不匹配。将使用Token关联文件名。
2025-08-05 16:26:41.494 | DEBUG    | api.route:download_file_via_token:186 - Token 'bc9807efaa7548138b5f8e878548ba71' 验证成功。准备下载文件: 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf', URL文件名: 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）_b6a79cd2.pdf')
2025-08-05 16:26:41.496 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）_b6a79cd2.pdf' 与Token关联文件名 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf' 不匹配。将使用Token关联文件名。
2025-08-05 16:26:41.497 | DEBUG    | api.route:download_file_via_token:186 - Token 'bc9807efaa7548138b5f8e878548ba71' 验证成功。准备下载文件: 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/东余变主变扩建工程/送审/东余变主变扩建工程/B6511C-A初步设计说明书（完整签名）/B6511C-A/B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）.pdf', URL文件名: 'B6511C-A-01 江苏南通东余220千伏变电站第二台主变扩建工程初步设计说明书（签名件）_b6a79cd2.pdf')
2025-08-05 16:27:44.207 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '723', 'type': 'function', 'function': {'name': 'write_review_doc', 'arguments': '{"template_type": "主变扩建工程模板", "project_name": "江苏南通东余220千伏变电站第二台主变扩建工程", "get_manual": false, "content": "{\\n  \\"substation_name\\": \\"东余变\\",\\n  \\"line_protection_model_config\\": \\"本期220kV扩建2回备用出线间隔，暂不配置线路保护；本期110kV扩建4回出线间隔，每回110kV线路配置光纤电流差动保护，含完整的后备保护及重合闸功能。\\",\\n  \\"protection_config\\": \\"本期#2主变电气量保护采用双重化配置，非电量保护单套配置，每套电气量保护均具有完整的主、后备保护功能。\\",\\n  \\"MV_LV_equipment_config\\": \\"本期10kV线路、分段、接地变、站用变、无功补偿装置各配置保护测控装置1套，其中分段配置备自投装置。\\",\\n  \\"energy_terminal_config\\": \\"本期#2主变各侧配置0.2S级数字量关口计量表4只，安装于原有主变电能表柜内；本期扩建4回110kV线路间隔配置0.2S级数字量关口校核表4只；10kV线路、电容器、电抗器间隔配置0.5S级模拟量平衡电能表18只。\\",\\n  \\"switch_config\\": \\"本期新增10kV间隔层交换机2台，主变220kV过程层交换机4台，主变110kV过程层交换机4台，220kV线路过程层交换机4台，110kV线路过程层交换机4台，110kV过程层中心交换机2台。\\",\\n  \\"online_monitoring\\": \\"本期配置#2主变压器油色谱在线监测系统1套，视频监控系统扩容。\\",\\n  \\"fault_recorder_config\\": \\"东余变前期已配置主变、220kV、110kV故障录波器各1套，满足本期扩建要求，维持不变。\\",\\n  \\"Miscellaneous\\": \\"本期拆除前期#1接地变消弧线圈成套装置和#2站用变，更换为2台1500/1000kVA接地变消弧线圈成套装置。\\",\\n  \\"hint\\": \\"1.本期220kV备用出线间隔未配置线路保护，需明确后期配置方案；2.110kV出线间隔保护配置完整；3.二次设备布置在前期二次设备室内，需核实空间是否充足；4.消防系统改造规模较大，需关注施工期间消防安全措施。\\"\\n}"}'}}]
2025-08-05 16:27:44.207 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: write_review_doc with args: {"template_type": "主变扩建工程模板", "project_name": "江苏南通东余220千伏变电站第二台主变扩建工程", "get_manual": false, "content": "{\n  \"substation_name\": \"东余变\",\n  \"line_protection_model_config\": \"本期220kV扩建2回备用出线间隔，暂不配置线路保护；本期110kV扩建4回出线间隔，每回110kV线路配置光纤电流差动保护，含完整的后备保护及重合闸功能。\",\n  \"protection_config\": \"本期#2主变电气量保护采用双重化配置，非电量保护单套配置，每套电气量保护均具有完整的主、后备保护功能。\",\n  \"MV_LV_equipment_config\": \"本期10kV线路、分段、接地变、站用变、无功补偿装置各配置保护测控装置1套，其中分段配置备自投装置。\",\n  \"energy_terminal_config\": \"本期#2主变各侧配置0.2S级数字量关口计量表4只，安装于原有主变电能表柜内；本期扩建4回110kV线路间隔配置0.2S级数字量关口校核表4只；10kV线路、电容器、电抗器间隔配置0.5S级模拟量平衡电能表18只。\",\n  \"switch_config\": \"本期新增10kV间隔层交换机2台，主变220kV过程层交换机4台，主变110kV过程层交换机4台，220kV线路过程层交换机4台，110kV线路过程层交换机4台，110kV过程层中心交换机2台。\",\n  \"online_monitoring\": \"本期配置#2主变压器油色谱在线监测系统1套，视频监控系统扩容。\",\n  \"fault_recorder_config\": \"东余变前期已配置主变、220kV、110kV故障录波器各1套，满足本期扩建要求，维持不变。\",\n  \"Miscellaneous\": \"本期拆除前期#1接地变消弧线圈成套装置和#2站用变，更换为2台1500/1000kVA接地变消弧线圈成套装置。\",\n  \"hint\": \"1.本期220kV备用出线间隔未配置线路保护，需明确后期配置方案；2.110kV出线间隔保护配置完整；3.二次设备布置在前期二次设备室内，需核实空间是否充足；4.消防系统改造规模较大，需关注施工期间消防安全措施。\"\n}"}
2025-08-05 16:27:44.253 | DEBUG    | my_mcp_tools.mcp_tools:write_review_doc:977 - 获取到的content：{
  "substation_name": "东余变",
  "line_protection_model_config": "本期220kV扩建2回备用出线间隔，暂不配置线路保护；本期110kV扩建4回出线间隔，每回110kV线路配置光纤电流差动保护，含完整的后备保护及重合闸功能。",
  "protection_config": "本期#2主变电气量保护采用双重化配置，非电量保护单套配置，每套电气量保护均具有完整的主、后备保护功能。",
  "MV_LV_equipment_config": "本期10kV线路、分段、接地变、站用变、无功补偿装置各配置保护测控装置1套，其中分段配置备自投装置。",
  "energy_terminal_config": "本期#2主变各侧配置0.2S级数字量关口计量表4只，安装于原有主变电能表柜内；本期扩建4回110kV线路间隔配置0.2S级数字量关口校核表4只；10kV线路、电容器、电抗器间隔配置0.5S级模拟量平衡电能表18只。",
  "switch_config": "本期新增10kV间隔层交换机2台，主变220kV过程层交换机4台，主变110kV过程层交换机4台，220kV线路过程层交换机4台，110kV线路过程层交换机4台，110kV过程层中心交换机2台。",
  "online_monitoring": "本期配置#2主变压器油色谱在线监测系统1套，视频监控系统扩容。",
  "fault_recorder_config": "东余变前期已配置主变、220kV、110kV故障录波器各1套，满足本期扩建要求，维持不变。",
  "Miscellaneous": "本期拆除前期#1接地变消弧线圈成套装置和#2站用变，更换为2台1500/1000kVA接地变消弧线圈成套装置。",
  "hint": "1.本期220kV备用出线间隔未配置线路保护，需明确后期配置方案；2.110kV出线间隔保护配置完整；3.二次设备布置在前期二次设备室内，需核实空间是否充足；4.消防系统改造规模较大，需关注施工期间消防安全措施。"
}
2025-08-05 16:27:44.308 | INFO     | my_mcp_tools.mcp_tools:write_review_doc:999 - 成功生成评审意见文档: data/review_output/（二次）江苏南通东余220千伏变电站第二台主变扩建工程评审意见.docx
2025-08-05 16:27:44.314 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-05 17:26:51.334 | DEBUG    | sse_proxy.sse2websocket1:run:304 - WebSocket 会话 73ef1247-2977-40c7-8bd2-62fdc4a1cf28 用户 admin 断开连接
2025-08-05 17:26:51.334 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-05 17:26:51.334 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-05 17:26:53.504 | INFO     | core.session:process_inactive_sessions:487 - 检测到 1 个不活动会话，将执行登出: admin
2025-08-05 17:26:53.504 | INFO     | core.session:process_inactive_sessions:493 - APScheduler: 用户 'admin' (会话 73ef1247-2977-40c7-8bd2-62fdc4a1cf28) 因不活动被自动登出。
2025-08-06 15:01:33.922 | WARNING  | core.auth:verify_active_session:31 - verify_active_session: 用户 'admin'在SessionStateManager中未找到。可能是会话已过期被清理。
2025-08-07 08:38:06.997 | INFO     | __main__:combined_lifespan:130 - COMBINED LIFESPAN END - PID: 3436546 - 服务器关闭中...
2025-08-07 08:38:06.997 | INFO     | database.document_service:shutdown:469 - 正在关闭 DocumentQueryService...
2025-08-07 08:38:07.006 | INFO     | database.document_service:shutdown:474 - Watchdog 监控已停止。
2025-08-07 08:38:07.007 | INFO     | database.document_service:shutdown:482 - 后台更新任务已取消。
2025-08-07 08:38:07.007 | INFO     | database.document_service:shutdown:487 - 数据库连接已关闭。
2025-08-07 08:38:07.008 | INFO     | database.document_service:shutdown:489 - DocumentQueryService 已成功关闭。
2025-08-07 08:38:07.008 | INFO     | __main__:combined_lifespan:134 - 统一文档查询服务已关闭。
2025-08-07 08:38:07.008 | INFO     | __main__:combined_lifespan:139 - APScheduler 调度器已关闭。
2025-08-07 08:38:07.008 | INFO     | __main__:combined_lifespan:140 - Custom application resources cleaned up.
2025-08-07 08:39:11.102 | INFO     | __main__:<module>:35 - Loguru 日志系统已初始化。
2025-08-07 08:39:11.102 | INFO     | __main__:<module>:36 - 项目根目录配置为: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-07 08:39:11.102 | INFO     | __main__:<module>:37 - 数据库路径配置为: data/document_service.db
2025-08-07 08:39:11.102 | INFO     | __main__:<module>:38 - 表格列读取配置已加载: {'变电站安装工程概算表': (2, 6), '变电站建筑工程概算表': (2, 6), '电缆输电线路安装工程概算表': (2, 6), '电缆输电线路建筑工程概算表': (2, 6)}
2025-08-07 08:39:11.102 | INFO     | __main__:<module>:39 - kkFileView 服务地址配置为: http://127.0.0.1:8012/kkfileview
2025-08-07 08:39:11.102 | INFO     | __main__:<module>:42 - Dify Agent API Key: ********kGHe
2025-08-07 08:39:11.102 | INFO     | __main__:<module>:43 - Session Secret Key: ********27d3
2025-08-07 08:39:11.103 | INFO     | __main__:<module>:44 - 服务器ipv6地址为: http://[240e:479:668:3c1c:2ec6:6ec4:aba6:38c4]:8888
2025-08-07 08:39:11.103 | INFO     | __main__:<module>:151 - FastAPI 应用已实例化并注册到 app_state。
2025-08-07 08:39:11.103 | INFO     | __main__:<module>:154 - CORS中间件已添加，允许所有来源。
2025-08-07 08:39:11.113 | INFO     | __main__:<module>:174 - MCP 服务器 '项目文件检索服务器' 已挂载到 FastAPI 应用的 '/mcp/' 路径。
2025-08-07 08:39:11.135 | INFO     | __main__:combined_lifespan:64 - COMBINED LIFESPAN START - PID: 2546431 - 服务器启动中...
2025-08-07 08:39:11.175 | INFO     | __main__:combined_lifespan:69 - HTTPX 客户端已创建并注册到 app_state。
2025-08-07 08:39:11.175 | INFO     | utils.utils:check_embedding_service_health:28 - 正在检查嵌入模型服务，目标URL: http://127.0.0.1:8001/v1/models
2025-08-07 08:39:11.184 | INFO     | utils.utils:check_embedding_service_health:37 - 嵌入模型服务可用，模型列表: ['/home/zhouxiang/models/BAAI_bge-m3']
2025-08-07 08:39:11.184 | INFO     | core.session:__init__:79 - SessionStateManager已初始化。整体HTTP不活动超时: 3600秒
2025-08-07 08:39:11.184 | INFO     | __main__:combined_lifespan:77 - SessionStateManager 已实例化并注册到 app_state。
2025-08-07 08:39:11.184 | INFO     | database.document_service:__init__:164 - 有效文档根目录: {'项目文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/Projects1'), '规范文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/规程规范'), '管理文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/管理文件')}
2025-08-07 08:39:11.185 | DEBUG    | database.document_service:_init_db:180 - 初始化数据库
2025-08-07 08:39:11.185 | DEBUG    | database.document_service:_init_db:201 - 数据库初始化完成
2025-08-07 08:39:11.186 | INFO     | database.document_service:__init__:177 - DocumentQueryService 初始化完成
2025-08-07 08:39:11.186 | INFO     | database.document_service:full_scan:324 - 开始全量扫描...
2025-08-07 08:39:11.186 | INFO     | database.document_service:full_scan:327 - 正在扫描 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-07 08:39:26.546 | INFO     | database.document_service:full_scan:327 - 正在扫描 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-07 08:39:27.361 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_12_479_254_639_268_0.jpg
2025-08-07 08:39:27.361 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_19_1142_1062_132_174_0.jpg
2025-08-07 08:39:27.362 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_67_179_250_1020_1864_0.jpg
2025-08-07 08:39:27.362 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_68_163_248_1019_1887_0.jpg
2025-08-07 08:39:27.362 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_235_1053_1153_960_0.jpg
2025-08-07 08:39:27.362 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_257_392_1118_414_0.jpg
2025-08-07 08:39:27.362 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_227_383_1163_510_0.jpg
2025-08-07 08:39:27.362 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_234_1152_1146_503_0.jpg
2025-08-07 08:39:27.362 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_71_416_1374_824_646_0.jpg
2025-08-07 08:39:27.363 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_73_362_1146_917_618_0.jpg
2025-08-07 08:39:27.363 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_74_573_1274_462_123_0.jpg
2025-08-07 08:39:27.363 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_76_248_1224_1104_782_0.jpg
2025-08-07 08:39:27.363 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_78_242_276_1113_842_0.jpg
2025-08-07 08:39:27.363 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_80_347_280_898_515_0.jpg
2025-08-07 08:39:27.363 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_86_210_747_1187_915_0.jpg
2025-08-07 08:39:27.363 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_87_238_256_1180_936_0.jpg
2025-08-07 08:39:27.364 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_91_256_269_1156_955_0.jpg
2025-08-07 08:39:27.364 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_232_301_1140_940_0.jpg
2025-08-07 08:39:27.364 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_233_1466_1147_602_0.jpg
2025-08-07 08:39:27.364 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_93_324_268_737_1834_0.jpg
2025-08-07 08:39:27.405 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_361_435_977_304_0.jpg
2025-08-07 08:39:27.405 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_616_930_468_258_0.jpg
2025-08-07 08:39:27.405 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_287_1114_1128_645_0.jpg
2025-08-07 08:39:27.406 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_304_320_1113_638_0.jpg
2025-08-07 08:39:27.406 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_214_315_1133_645_0.jpg
2025-08-07 08:39:27.406 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_220_1122_1142_645_0.jpg
2025-08-07 08:39:27.406 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_287_1119_1136_651_0.jpg
2025-08-07 08:39:27.406 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_299_324_1134_642_0.jpg
2025-08-07 08:39:27.406 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_203_320_1145_655_0.jpg
2025-08-07 08:39:27.406 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_227_1129_1130_645_0.jpg
2025-08-07 08:39:27.407 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_290_1126_1125_656_0.jpg
2025-08-07 08:39:27.407 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_306_322_1119_646_0.jpg
2025-08-07 08:39:27.407 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_212_221_1133_659_0.jpg
2025-08-07 08:39:27.407 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_225_1049_1127_636_0.jpg
2025-08-07 08:39:27.407 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_0_1237_154_289_162_0.jpg
2025-08-07 08:39:27.407 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_253_704_552_467_0.jpg
2025-08-07 08:39:27.407 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_884_684_459_455_0.jpg
2025-08-07 08:39:27.408 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_143_500_318_578_556_0.jpg
2025-08-07 08:39:27.408 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_146_315_228_1095_400_0.jpg
2025-08-07 08:39:27.408 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_150_286_250_1129_814_0.jpg
2025-08-07 08:39:27.408 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_248_725_1164_564_0.jpg
2025-08-07 08:39:27.408 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_388_215_897_435_0.jpg
2025-08-07 08:39:27.408 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_287_1311_1133_384_0.jpg
2025-08-07 08:39:27.408 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_70_393_948_902_341_0.jpg
2025-08-07 08:39:27.408 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_72_258_681_1160_1355_0.jpg
2025-08-07 08:39:27.409 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_75_240_362_1177_1656_0.jpg
2025-08-07 08:39:27.409 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_78_240_318_1168_1731_0.jpg
2025-08-07 08:39:27.409 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_81_248_343_1165_1687_0.jpg
2025-08-07 08:39:27.409 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_84_238_386_1162_1624_0.jpg
2025-08-07 08:39:27.409 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_86_239_653_1166_1338_0.jpg
2025-08-07 08:39:27.409 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_88_623_450_653_646_0.jpg
2025-08-07 08:39:27.409 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_90_238_296_1174_1720_0.jpg
2025-08-07 08:39:27.410 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_91_225_299_1187_1707_0.jpg
2025-08-07 08:39:27.410 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_94_257_289_1171_1697_0.jpg
2025-08-07 08:39:27.410 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_97_227_303_1170_1731_0.jpg
2025-08-07 08:39:27.410 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_101_225_672_1178_1353_0.jpg
2025-08-07 08:39:27.410 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_102_240_291_1203_1722_0.jpg
2025-08-07 08:39:27.410 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_103_240_297_1178_1734_0.jpg
2025-08-07 08:39:27.410 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_119_475_1184_667_691_0.jpg
2025-08-07 08:39:27.410 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_121_593_1023_425_178_0.jpg
2025-08-07 08:39:27.411 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_122_444_294_775_206_0.jpg
2025-08-07 08:39:27.411 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_413_902_778_279_0.jpg
2025-08-07 08:39:27.411 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_419_1314_768_347_0.jpg
2025-08-07 08:39:27.411 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_126_387_330_904_455_0.jpg
2025-08-07 08:39:27.411 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_129_362_691_912_684_0.jpg
2025-08-07 08:39:27.411 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_137_501_1634_612_391_0.jpg
2025-08-07 08:39:27.412 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_138_536_226_623_387_0.jpg
2025-08-07 08:39:27.412 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_177_316_1559_1037_507_0.jpg
2025-08-07 08:39:27.412 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_187_373_890_922_309_0.jpg
2025-08-07 08:39:27.412 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_389_874_879_339_0.jpg
2025-08-07 08:39:27.412 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_509_232_635_564_0.jpg
2025-08-07 08:39:27.413 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_514_1307_644_653_0.jpg
2025-08-07 08:39:27.413 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_318_1309_1020_458_0.jpg
2025-08-07 08:39:27.413 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_397_458_892_388_0.jpg
2025-08-07 08:39:27.413 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_539_1403_583_424_0.jpg
2025-08-07 08:39:27.413 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_194_438_645_754_434_0.jpg
2025-08-07 08:39:27.414 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_365_222_908_608_0.jpg
2025-08-07 08:39:27.414 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_385_1267_869_447_0.jpg
2025-08-07 08:39:27.414 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_206_501_795_660_1153_0.jpg
2025-08-07 08:39:27.414 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_208_581_1522_499_443_0.jpg
2025-08-07 08:39:27.414 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_209_536_235_551_971_0.jpg
2025-08-07 08:39:27.414 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_210_246_516_270_300_0.jpg
2025-08-07 08:39:27.414 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_128_411_445_833_494_0.jpg
2025-08-07 08:39:27.415 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_428_384_769_490_0.jpg
2025-08-07 08:39:27.415 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_49_529_271_627_470_0.jpg
2025-08-07 08:39:27.415 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_66_257_325_1140_552_0.jpg
2025-08-07 08:39:27.415 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_1090_878_289_229_0.jpg
2025-08-07 08:39:27.415 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_432_894_219_206_0.jpg
2025-08-07 08:39:27.415 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_728_895_247_200_0.jpg
2025-08-07 08:39:27.415 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1095_623_266_169_0.jpg
2025-08-07 08:39:27.415 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1141_832_201_101_0.jpg
2025-08-07 08:39:27.416 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_444_641_235_139_0.jpg
2025-08-07 08:39:27.416 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_459_831_166_104_0.jpg
2025-08-07 08:39:27.416 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_724_603_276_178_0.jpg
2025-08-07 08:39:27.416 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_747_821_223_122_0.jpg
2025-08-07 08:39:27.473 | INFO     | database.document_service:full_scan:327 - 正在扫描 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-07 08:39:27.474 | INFO     | database.document_service:full_scan:332 - 全量扫描完成，共处理文件数: 1581
2025-08-07 08:39:27.474 | DEBUG    | database.document_service:_start_watchdog:335 - 启动文件监控 Watchdog
2025-08-07 08:39:27.474 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-07 08:39:27.474 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-07 08:39:27.474 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-07 08:39:27.494 | INFO     | database.document_service:_start_watchdog:423 - Watchdog 已启动
2025-08-07 08:39:27.494 | INFO     | database.document_service:start:465 - DocumentQueryService 已启动
2025-08-07 08:39:27.494 | INFO     | __main__:combined_lifespan:83 - 统一文档查询服务 (DocumentQueryService) 已启动。
2025-08-07 08:39:27.494 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/Projects1', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-07 08:39:27.494 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/规程规范', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-07 08:39:27.494 | INFO     | __main__:combined_lifespan:88 - 项目和规程的文件服务已初始化。
2025-08-07 08:39:27.507 | INFO     | __main__:combined_lifespan:93 - AsyncIOScheduler 已实例化并注册到 app_state。
2025-08-07 08:39:27.507 | INFO     | __main__:combined_lifespan:97 - FastMCP lifespan context entered.
2025-08-07 08:39:27.515 | INFO     | __main__:combined_lifespan:117 - 处理不活动用户会话任务已添加到APScheduler (每 60s)。
2025-08-07 08:39:27.515 | INFO     | __main__:combined_lifespan:120 - 清理用户会话中已打开文件token任务已添加到APScheduler (每 120s)。
2025-08-07 08:39:27.526 | INFO     | __main__:combined_lifespan:123 - APScheduler 调度器已启动。
2025-08-07 08:39:27.526 | INFO     | __main__:combined_lifespan:124 - 所有初始化完成... yield
2025-08-07 08:39:27.526 | DEBUG    | database.document_service:_debounced_update_loop:426 - 启动去抖更新循环
2025-08-07 09:22:52.762 | WARNING  | api.admin:admin_access:29 - Admin access denied for user 'None' from IP '2409:8924:662:f8e:4563:8b59:9e01:38f9'. Reason: user is not admin or IP mismatch (expected N/A).
2025-08-07 12:03:37.372 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: bd143ffa-4d9d-4427-b782-be21a8bd75eb, IP: 2409:8924:620:5262:1578:3d4f:5432:f646) 登录/状态更新成功。
2025-08-07 12:03:37.372 | INFO     | api.route:login:69 - 用户 'admin' (IP: 2409:8924:620:5262:1578:3d4f:5432:f646, Session: bd143ffa-4d9d-4427-b782-be21a8bd75eb) 登录成功。
2025-08-07 12:03:45.889 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: bd143ffa-4d9d-4427-b782-be21a8bd75eb) 的 WebSocket 已连接并关联。
2025-08-07 12:03:45.966 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-07 12:04:03.703 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '2409:8924:620:5262:1578:3d4f:5432:f646'.
2025-08-07 12:04:13.188 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '2409:8924:620:5262:1578:3d4f:5432:f646'.
2025-08-07 12:04:13.189 | INFO     | api.admin:update_admin_config:164 - 从服务商 'kimi' 的预设中加载了 API Key。
2025-08-07 12:04:13.190 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: https://api.moonshot.cn/v1
2025-08-07 12:04:13.190 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: kimi-k2-0711-preview
2025-08-07 12:04:13.190 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******XvEL
2025-08-07 12:04:13.277 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '2409:8924:620:5262:1578:3d4f:5432:f646'.
2025-08-07 12:04:14.551 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 51a95daf-cfac-42cc-9ee0-b36f3b781379。清空历史记录。
2025-08-07 12:04:37.664 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-07 12:04:37.664 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 bd143ffa-4d9d-4427-b782-be21a8bd75eb, 对话ID: 51a95daf-cfac-42cc-9ee0-b36f3b781379, 查询: 查下二次知识库，主变低压侧66kV的母线是否配置母线保护？
2025-08-07 12:04:37.664 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-07 12:04:44.633 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '27', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "主变低压侧66kV母线保护配置要求", "knowledge_base_name": "二次"}'}}]
2025-08-07 12:04:44.633 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "主变低压侧66kV母线保护配置要求", "knowledge_base_name": "二次"}
2025-08-07 12:04:44.676 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '主变低压侧66kV母线保护配置要求...', top_k: 5
2025-08-07 12:04:44.676 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-07 12:04:44.952 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-07 12:04:44.952 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='主变低压侧66kV母线保护配置要求...', top_k=5
2025-08-07 12:04:45.350 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 5 条结果。
2025-08-07 12:04:45.357 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-07 12:06:39.221 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-07 12:06:39.222 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 bd143ffa-4d9d-4427-b782-be21a8bd75eb, 对话ID: 51a95daf-cfac-42cc-9ee0-b36f3b781379, 查询: 再查下辅助设备智能监控系统的要求里，500kV变电站是否要设置机器人
2025-08-07 12:06:39.222 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-07 12:06:45.988 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '54', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "500kV变电站辅助设备智能监控系统 机器人配置要求", "knowledge_base_name": "二次"}'}}]
2025-08-07 12:06:45.988 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "500kV变电站辅助设备智能监控系统 机器人配置要求", "knowledge_base_name": "二次"}
2025-08-07 12:06:46.033 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '500kV变电站辅助设备智能监控系统 机器人配置要求...', top_k: 5
2025-08-07 12:06:46.033 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-07 12:06:46.129 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-07 12:06:46.129 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='500kV变电站辅助设备智能监控系统 机器人配置要求...', top_k=5
2025-08-07 12:06:46.408 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 5 条结果。
2025-08-07 12:06:46.415 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-07 12:07:00.217 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '80', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "变电站智能巡检机器人 配置要求 500kV", "knowledge_base_name": "二次"}'}}]
2025-08-07 12:07:00.218 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "变电站智能巡检机器人 配置要求 500kV", "knowledge_base_name": "二次"}
2025-08-07 12:07:00.260 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '变电站智能巡检机器人 配置要求 500kV...', top_k: 5
2025-08-07 12:07:00.260 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-07 12:07:00.343 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-07 12:07:00.343 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='变电站智能巡检机器人 配置要求 500kV...', top_k=5
2025-08-07 12:07:00.562 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 5 条结果。
2025-08-07 12:07:00.568 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-07 12:07:13.721 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-07 12:07:13.721 | INFO     | sse_proxy.sse2websocket1:run:265 - 会话 bd143ffa-4d9d-4427-b782-be21a8bd75eb 用户 admin 中止响应流任务
2025-08-07 12:07:13.721 | INFO     | sse_proxy.sse2websocket1:_start:101 - 会话 bd143ffa-4d9d-4427-b782-be21a8bd75eb 被取消
2025-08-07 12:07:34.522 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-07 12:07:34.523 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 bd143ffa-4d9d-4427-b782-be21a8bd75eb, 对话ID: 51a95daf-cfac-42cc-9ee0-b36f3b781379, 查询: 找下二次的规范文件，我看看有没有辅助设备监控系统的规范
2025-08-07 12:07:34.523 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-07 12:07:40.363 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '106', 'type': 'function', 'function': {'name': 'open_specification_files', 'arguments': '{"user": "admin", "query_spec_filename": "/ALL", "category": "二次", "read_file": false}'}}]
2025-08-07 12:07:40.363 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: open_specification_files with args: {"user": "admin", "query_spec_filename": "/ALL", "category": "二次", "read_file": false}
2025-08-07 12:07:40.411 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:834 - 工具调用: open_specification_files, 查询: '/ALL', 类别: '二次', 读取文件: False, Top N: 10
2025-08-07 12:07:40.411 | DEBUG    | database.document_service:_db_query:550 - 查询规范文件分类 (适配器): 二次
2025-08-07 12:07:40.412 | INFO     | database.document_service:_db_query:571 - 查询到 '二次' 分类的规范共 16 条
2025-08-07 12:07:40.412 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:856 - 用户请求 '二次' 类别下的所有规范。
2025-08-07 12:07:40.418 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-07 12:08:00.126 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-07 12:08:00.126 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 bd143ffa-4d9d-4427-b782-be21a8bd75eb, 对话ID: 51a95daf-cfac-42cc-9ee0-b36f3b781379, 查询: 读取
2025-08-07 12:08:00.126 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-07 12:08:07.703 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '146', 'type': 'function', 'function': {'name': 'open_specification_files', 'arguments': '{"user": "admin", "query_spec_filename": "QGDW 10688-2024 变电站辅助监控系统设计规范", "category": "二次", "read_file": true}'}}]
2025-08-07 12:08:07.704 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: open_specification_files with args: {"user": "admin", "query_spec_filename": "QGDW 10688-2024 变电站辅助监控系统设计规范", "category": "二次", "read_file": true}
2025-08-07 12:08:07.747 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:834 - 工具调用: open_specification_files, 查询: 'QGDW 10688-2024 变电站辅助监控系统设计规范', 类别: '二次', 读取文件: True, Top N: 10
2025-08-07 12:08:07.748 | DEBUG    | database.document_service:_db_query:550 - 查询规范文件分类 (适配器): 二次
2025-08-07 12:08:07.748 | INFO     | database.document_service:_db_query:571 - 查询到 '二次' 分类的规范共 16 条
2025-08-07 12:08:07.748 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-07 12:08:07.948 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-10 结果: [('变电站辅助设备监控系统设计规范', 0.8772395309827452), ('QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范', 0.7736490076448137), ('NBT 11315-2023 变电站辅助控制系统设计规程', 0.7624637609808589), ('QGDW 12301-2023 变电站硬压板在线监测技术规范', 0.7415023860946723), ('QGDW 10536-2021-变压器油中溶解气体在线监测装置技术规范', 0.7111615059215095), ('QGDW10347-2023电能计量装置通用设计', 0.7077829346741957), ('QGDW 11486-2022 继电保护和安全自动装置验收规范', 0.6983527999507657), ('IEEE 移相变压器继电保护应用指南 双语对照-2024-12-31-20-34-13', 0.6456281432689663), ('GB∕T 37755-2019 智能变电站光纤回路建模及编码技术规范', 0.6288088561017464), ('GB／T-14285—2023《继电保护和安全自动装置技术规程》_md', 0.6244005441642748)]
2025-08-07 12:08:07.948 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:881 - 最匹配文件 '二次/变电站辅助设备监控系统设计规范/QGDW 10688-2024 变电站辅助监控系统设计规范.pdf' 相似度(0.8772) > 0.7，准备读取内容。
2025-08-07 12:08:07.948 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/变电站辅助设备监控系统设计规范/QGDW 10688-2024 变电站辅助监控系统设计规范.pdf (相对路径: 二次/变电站辅助设备监控系统设计规范/QGDW 10688-2024 变电站辅助监控系统设计规范.pdf)，分隔符: '
'
2025-08-07 12:08:16.274 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: QGDW 10688-2024 变电站辅助监控系统设计规范.pdf, 内容长度: 25215
2025-08-07 12:08:16.274 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '二次/变电站辅助设备监控系统设计规范/QGDW 10688-2024 变电站辅助监控系统设计规范.pdf' (token: a953593da80c43e2aa132186537030e4), 有效期至: Thu Aug  7 20:08:16 2025
2025-08-07 12:08:16.285 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-07 12:08:20.095 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/a953593da80c43e2aa132186537030e4/QGDW 10688-2024 变电站辅助监控系统设计规范.pdf
2025-08-07 12:08:30.401 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'QGDW 10688-2024 变电站辅助监控系统设计规范_f96c243c.pdf' 与Token关联文件名 'QGDW 10688-2024 变电站辅助监控系统设计规范.pdf' 不匹配。将使用Token关联文件名。
2025-08-07 12:08:30.401 | DEBUG    | api.route:download_file_via_token:186 - Token 'a953593da80c43e2aa132186537030e4' 验证成功。准备下载文件: 'QGDW 10688-2024 变电站辅助监控系统设计规范.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/规程规范/二次/变电站辅助设备监控系统设计规范/QGDW 10688-2024 变电站辅助监控系统设计规范.pdf', URL文件名: 'QGDW 10688-2024 变电站辅助监控系统设计规范_f96c243c.pdf')
2025-08-07 12:08:30.403 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'QGDW 10688-2024 变电站辅助监控系统设计规范_f96c243c.pdf' 与Token关联文件名 'QGDW 10688-2024 变电站辅助监控系统设计规范.pdf' 不匹配。将使用Token关联文件名。
2025-08-07 12:08:30.404 | DEBUG    | api.route:download_file_via_token:186 - Token 'a953593da80c43e2aa132186537030e4' 验证成功。准备下载文件: 'QGDW 10688-2024 变电站辅助监控系统设计规范.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/规程规范/二次/变电站辅助设备监控系统设计规范/QGDW 10688-2024 变电站辅助监控系统设计规范.pdf', URL文件名: 'QGDW 10688-2024 变电站辅助监控系统设计规范_f96c243c.pdf')
2025-08-07 12:10:33.092 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-07 12:10:33.092 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 bd143ffa-4d9d-4427-b782-be21a8bd75eb, 对话ID: 51a95daf-cfac-42cc-9ee0-b36f3b781379, 查询: 找下电流互感器的规范
2025-08-07 12:10:33.093 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-07 12:10:38.148 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '175', 'type': 'function', 'function': {'name': 'open_specification_files', 'arguments': '{"user": "admin", "query_spec_filename": "电流互感器", "category": "电气", "read_file": false}'}}]
2025-08-07 12:10:38.148 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: open_specification_files with args: {"user": "admin", "query_spec_filename": "电流互感器", "category": "电气", "read_file": false}
2025-08-07 12:10:38.192 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:834 - 工具调用: open_specification_files, 查询: '电流互感器', 类别: '电气', 读取文件: False, Top N: 10
2025-08-07 12:10:38.192 | DEBUG    | database.document_service:_db_query:550 - 查询规范文件分类 (适配器): 电气
2025-08-07 12:10:38.192 | INFO     | database.document_service:_db_query:571 - 查询到 '电气' 分类的规范共 2 条
2025-08-07 12:10:38.193 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-07 12:10:38.271 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-10 结果: [('DLT-866-2015 电流互感器和电压互感器选择及计算规程_md', 0.7736216098040591), ('33-GB-50217-2018-电力工程电缆设计标准_md', 0.42026014073960044)]
2025-08-07 12:10:38.277 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-07 12:11:26.421 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-07 12:11:26.421 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 bd143ffa-4d9d-4427-b782-be21a8bd75eb, 对话ID: 51a95daf-cfac-42cc-9ee0-b36f3b781379, 查询: 读取
2025-08-07 12:11:26.422 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-07 12:11:32.871 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '220', 'type': 'function', 'function': {'name': 'open_specification_files', 'arguments': '{"user": "admin", "query_spec_filename": "DLT-866-2015 电流互感器和电压互感器选择及计算规程", "category": "电气", "read_file": true}'}}]
2025-08-07 12:11:32.872 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: open_specification_files with args: {"user": "admin", "query_spec_filename": "DLT-866-2015 电流互感器和电压互感器选择及计算规程", "category": "电气", "read_file": true}
2025-08-07 12:11:32.920 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:834 - 工具调用: open_specification_files, 查询: 'DLT-866-2015 电流互感器和电压互感器选择及计算规程', 类别: '电气', 读取文件: True, Top N: 10
2025-08-07 12:11:32.920 | DEBUG    | database.document_service:_db_query:550 - 查询规范文件分类 (适配器): 电气
2025-08-07 12:11:32.920 | INFO     | database.document_service:_db_query:571 - 查询到 '电气' 分类的规范共 2 条
2025-08-07 12:11:32.920 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-07 12:11:33.023 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-10 结果: [('DLT-866-2015 电流互感器和电压互感器选择及计算规程_md', 0.983848741099412), ('33-GB-50217-2018-电力工程电缆设计标准_md', 0.5297415824958394)]
2025-08-07 12:11:33.023 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:881 - 最匹配文件 '电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/DLT-866-2015 电流互感器和电压互感器选择及计算规程.md' 相似度(0.9838) > 0.7，准备读取内容。
2025-08-07 12:11:33.024 | DEBUG    | my_mcp_tools.mcp_tools:_get_spec_file_content:96 - MCP Tool: 尝试读取规程文件: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/DLT-866-2015 电流互感器和电压互感器选择及计算规程.md
2025-08-07 12:11:33.026 | DEBUG    | my_mcp_tools.mcp_tools:_get_spec_file_content:100 - MCP Tool: 读取完成，文件: DLT-866-2015 电流互感器和电压互感器选择及计算规程.md, 内容长度: 262961
2025-08-07 12:11:33.026 | WARNING  | my_mcp_tools.mcp_tools:open_specification_files:900 - 文件 '电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/DLT-866-2015 电流互感器和电压互感器选择及计算规程.md' 内容过长，可能超过模型上下文窗口。
2025-08-07 12:11:33.026 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/DLT-866-2015 电流互感器和电压互感器选择及计算规程.md' (token: f3e62fb713cf460c8afe572a33740b10), 有效期至: Thu Aug  7 20:11:33 2025
2025-08-07 12:11:33.032 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-07 12:11:34.099 | DEBUG    | api.route:download_file_via_token:186 - Token 'f3e62fb713cf460c8afe572a33740b10' 验证成功。准备下载文件: 'DLT-866-2015 电流互感器和电压互感器选择及计算规程.md' (路径: '/media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/DLT-866-2015 电流互感器和电压互感器选择及计算规程.md', URL文件名: 'DLT-866-2015 电流互感器和电压互感器选择及计算规程.md')
2025-08-07 12:12:47.297 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-07 12:12:47.297 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 bd143ffa-4d9d-4427-b782-be21a8bd75eb, 对话ID: 51a95daf-cfac-42cc-9ee0-b36f3b781379, 查询: 你能查到P级电流互感器的准确级倍数规定
2025-08-07 12:12:47.297 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-07 12:12:52.792 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '252', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "P级电流互感器 准确限值系数 准确级倍数 ALF", "knowledge_base_name": "电气"}'}}]
2025-08-07 12:12:52.792 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "P级电流互感器 准确限值系数 准确级倍数 ALF", "knowledge_base_name": "电气"}
2025-08-07 12:12:52.841 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 电气, 用户查询: 'P级电流互感器 准确限值系数 准确级倍数 ALF...', top_k: 5
2025-08-07 12:12:52.842 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '电气', 'page': 1, 'limit': 10}
2025-08-07 12:12:52.938 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '电气' 的ID: 95bde3ad-88fe-4994-8599-34f155626984
2025-08-07 12:12:52.938 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/95bde3ad-88fe-4994-8599-34f155626984/retrieve 发起检索请求。Payload (部分): query='P级电流互感器 准确限值系数 准确级倍数 ALF...', top_k=5
2025-08-07 12:12:53.249 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '电气' 检索到 4 条结果。
2025-08-07 12:12:53.257 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:kimi-k2-0711-preview
2025-08-07 12:13:14.967 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-07 12:13:14.968 | INFO     | sse_proxy.sse2websocket1:run:265 - 会话 bd143ffa-4d9d-4427-b782-be21a8bd75eb 用户 admin 中止响应流任务
2025-08-07 12:13:14.968 | INFO     | sse_proxy.sse2websocket1:_start:101 - 会话 bd143ffa-4d9d-4427-b782-be21a8bd75eb 被取消
2025-08-07 12:13:18.116 | DEBUG    | core.session:logout_user:152 - 用户 'admin' (会话: bd143ffa-4d9d-4427-b782-be21a8bd75eb) 已从状态管理器登出。
2025-08-07 12:13:18.116 | DEBUG    | core.session:logout_user:154 - 用户 'admin' 登出时，其WebSocket连接处于活动状态，将尝试关闭。
2025-08-07 12:13:19.250 | INFO     | api.route:logout:80 - HTTP会话已清除 (用户: admin)。
2025-08-07 12:13:19.251 | DEBUG    | sse_proxy.sse2websocket1:run:304 - WebSocket 会话 bd143ffa-4d9d-4427-b782-be21a8bd75eb 用户 admin 断开连接
2025-08-07 12:13:19.251 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 06:35:02.078 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: 34ddbd9b-2204-4a1d-9d98-8a7a0e1ce05d, IP: 240e:3a1:7d0:ab80::e7) 登录/状态更新成功。
2025-08-08 06:35:02.078 | INFO     | api.route:login:69 - 用户 'admin' (IP: 240e:3a1:7d0:ab80::e7, Session: 34ddbd9b-2204-4a1d-9d98-8a7a0e1ce05d) 登录成功。
2025-08-08 06:35:03.457 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 34ddbd9b-2204-4a1d-9d98-8a7a0e1ce05d) 的 WebSocket 已连接并关联。
2025-08-08 06:35:03.528 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-08 06:35:13.714 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 06:38:14.427 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 06:38:14.428 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: http://240e:3a1:7d0:ab80::e7:1234/v1/chat/completions
2025-08-08 06:38:14.428 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******
2025-08-08 06:38:14.428 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: openai/gpt-oss-20b
2025-08-08 06:38:14.452 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 06:38:20.101 | ERROR    | sse_proxy.sse2websocket1:run:307 - WebSocket 错误 (会话 34ddbd9b-2204-4a1d-9d98-8a7a0e1ce05d): Invalid port: '3a1:7d0:ab80::e7:1234'
2025-08-08 06:38:20.101 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 06:38:20.101 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 06:39:20.042 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 06:39:20.042 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: http://240e:3a1:7d0:ab80::e7:1234/v1
2025-08-08 06:39:20.042 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******
2025-08-08 06:39:20.042 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: openai/gpt-oss-20b
2025-08-08 06:39:20.063 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 06:52:51.613 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 06:52:51.613 | INFO     | api.admin:update_admin_config:164 - 从服务商 'tencent' 的预设中加载了 API Key。
2025-08-08 06:52:51.613 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: http://[240e:3a1:7d0:ab80::e7]:1234/v1
2025-08-08 06:52:51.613 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: openai/gpt-oss-20b
2025-08-08 06:52:51.613 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******zI0G
2025-08-08 06:52:51.635 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 06:54:45.656 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 06:54:45.656 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: http://[240e:3a1:7d0:ab80::e7]:1234/v1
2025-08-08 06:54:45.656 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******
2025-08-08 06:54:45.656 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: openai/gpt-oss-20b
2025-08-08 06:54:45.675 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 06:54:59.377 | DEBUG    | core.session:logout_user:152 - 用户 'admin' (会话: 34ddbd9b-2204-4a1d-9d98-8a7a0e1ce05d) 已从状态管理器登出。
2025-08-08 06:54:59.377 | INFO     | api.route:logout:80 - HTTP会话已清除 (用户: admin)。
2025-08-08 06:55:02.822 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: 2fd9c275-26ff-4c37-9ea7-1c16734b1955, IP: 240e:3a1:7d0:ab80::e7) 登录/状态更新成功。
2025-08-08 06:55:02.822 | INFO     | api.route:login:69 - 用户 'admin' (IP: 240e:3a1:7d0:ab80::e7, Session: 2fd9c275-26ff-4c37-9ea7-1c16734b1955) 登录成功。
2025-08-08 06:55:02.969 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 2fd9c275-26ff-4c37-9ea7-1c16734b1955) 的 WebSocket 已连接并关联。
2025-08-08 06:55:03.042 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-08 06:55:10.603 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 06:55:35.455 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 06:55:35.455 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: http://[240e:3a1:7d0:ab80::e7]:1234/v1
2025-08-08 06:55:35.455 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******
2025-08-08 06:55:35.455 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: openai/gpt-oss-20b
2025-08-08 06:55:35.474 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 06:55:38.402 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 9ff59004-1c55-475e-9338-dcab3015d002。清空历史记录。
2025-08-08 06:55:41.474 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 06:55:41.474 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2fd9c275-26ff-4c37-9ea7-1c16734b1955, 对话ID: 9ff59004-1c55-475e-9338-dcab3015d002, 查询: nihao
2025-08-08 06:55:41.474 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 06:55:42.836 | ERROR    | sse_proxy.sse2websocket1:_handle_stream:137 - 调用OpenAI API失败: Connection error.
2025-08-08 06:57:01.897 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: d3c142a2-a8ac-457d-8578-48f70a0eaf45。清空历史记录。
2025-08-08 06:57:06.543 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 06:57:06.543 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2fd9c275-26ff-4c37-9ea7-1c16734b1955, 对话ID: d3c142a2-a8ac-457d-8578-48f70a0eaf45, 查询: nihao
2025-08-08 06:57:06.543 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 06:57:07.884 | ERROR    | sse_proxy.sse2websocket1:_handle_stream:137 - 调用OpenAI API失败: Connection error.
2025-08-08 06:57:16.525 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 2fd9c275-26ff-4c37-9ea7-1c16734b1955) 的 WebSocket 已连接并关联。
2025-08-08 06:57:16.600 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-08 06:57:21.358 | DEBUG    | sse_proxy.sse2websocket1:run:304 - WebSocket 会话 2fd9c275-26ff-4c37-9ea7-1c16734b1955 用户 admin 断开连接
2025-08-08 06:57:21.359 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 06:57:21.359 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 06:57:21.363 | DEBUG    | core.session:logout_user:152 - 用户 'admin' (会话: 2fd9c275-26ff-4c37-9ea7-1c16734b1955) 已从状态管理器登出。
2025-08-08 06:57:21.363 | INFO     | api.route:logout:80 - HTTP会话已清除 (用户: admin)。
2025-08-08 06:58:36.945 | INFO     | __main__:<module>:35 - Loguru 日志系统已初始化。
2025-08-08 06:58:36.946 | INFO     | __main__:<module>:36 - 项目根目录配置为: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 06:58:36.946 | INFO     | __main__:<module>:37 - 数据库路径配置为: data/document_service.db
2025-08-08 06:58:36.946 | INFO     | __main__:<module>:38 - 表格列读取配置已加载: {'变电站安装工程概算表': (2, 6), '变电站建筑工程概算表': (2, 6), '电缆输电线路安装工程概算表': (2, 6), '电缆输电线路建筑工程概算表': (2, 6)}
2025-08-08 06:58:36.946 | INFO     | __main__:<module>:39 - kkFileView 服务地址配置为: http://127.0.0.1:8012/kkfileview
2025-08-08 06:58:36.946 | INFO     | __main__:<module>:42 - Dify Agent API Key: ********kGHe
2025-08-08 06:58:36.946 | INFO     | __main__:<module>:43 - Session Secret Key: ********813e
2025-08-08 06:58:36.946 | INFO     | __main__:<module>:44 - 服务器ipv6地址为: http://[240e:479:668:3c1c:240:be1d:8772:67fa]:8888
2025-08-08 06:58:36.947 | INFO     | __main__:<module>:151 - FastAPI 应用已实例化并注册到 app_state。
2025-08-08 06:58:36.947 | INFO     | __main__:<module>:154 - CORS中间件已添加，允许所有来源。
2025-08-08 06:58:36.957 | INFO     | __main__:<module>:174 - MCP 服务器 '项目文件检索服务器' 已挂载到 FastAPI 应用的 '/mcp/' 路径。
2025-08-08 06:58:36.972 | INFO     | __main__:combined_lifespan:64 - COMBINED LIFESPAN START - PID: 417919 - 服务器启动中...
2025-08-08 06:58:37.005 | INFO     | __main__:combined_lifespan:69 - HTTPX 客户端已创建并注册到 app_state。
2025-08-08 06:58:37.005 | INFO     | utils.utils:check_embedding_service_health:28 - 正在检查嵌入模型服务，目标URL: http://127.0.0.1:8001/v1/models
2025-08-08 06:58:37.014 | INFO     | utils.utils:check_embedding_service_health:37 - 嵌入模型服务可用，模型列表: ['/home/zhouxiang/models/BAAI_bge-m3']
2025-08-08 06:58:37.015 | INFO     | core.session:__init__:79 - SessionStateManager已初始化。整体HTTP不活动超时: 3600秒
2025-08-08 06:58:37.016 | INFO     | __main__:combined_lifespan:77 - SessionStateManager 已实例化并注册到 app_state。
2025-08-08 06:58:37.016 | INFO     | database.document_service:__init__:164 - 有效文档根目录: {'项目文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/Projects1'), '规范文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/规程规范'), '管理文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/管理文件')}
2025-08-08 06:58:37.016 | DEBUG    | database.document_service:_init_db:180 - 初始化数据库
2025-08-08 06:58:37.017 | DEBUG    | database.document_service:_init_db:201 - 数据库初始化完成
2025-08-08 06:58:37.017 | INFO     | database.document_service:__init__:177 - DocumentQueryService 初始化完成
2025-08-08 06:58:37.017 | INFO     | database.document_service:full_scan:324 - 开始全量扫描...
2025-08-08 06:58:37.017 | INFO     | database.document_service:full_scan:327 - 正在扫描 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 06:58:45.402 | INFO     | database.document_service:full_scan:327 - 正在扫描 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-08 06:58:45.621 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_12_479_254_639_268_0.jpg
2025-08-08 06:58:45.622 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_19_1142_1062_132_174_0.jpg
2025-08-08 06:58:45.622 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_67_179_250_1020_1864_0.jpg
2025-08-08 06:58:45.622 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_68_163_248_1019_1887_0.jpg
2025-08-08 06:58:45.622 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_235_1053_1153_960_0.jpg
2025-08-08 06:58:45.622 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_257_392_1118_414_0.jpg
2025-08-08 06:58:45.623 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_227_383_1163_510_0.jpg
2025-08-08 06:58:45.623 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_234_1152_1146_503_0.jpg
2025-08-08 06:58:45.623 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_71_416_1374_824_646_0.jpg
2025-08-08 06:58:45.623 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_73_362_1146_917_618_0.jpg
2025-08-08 06:58:45.623 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_74_573_1274_462_123_0.jpg
2025-08-08 06:58:45.623 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_76_248_1224_1104_782_0.jpg
2025-08-08 06:58:45.624 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_78_242_276_1113_842_0.jpg
2025-08-08 06:58:45.624 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_80_347_280_898_515_0.jpg
2025-08-08 06:58:45.624 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_86_210_747_1187_915_0.jpg
2025-08-08 06:58:45.624 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_87_238_256_1180_936_0.jpg
2025-08-08 06:58:45.624 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_91_256_269_1156_955_0.jpg
2025-08-08 06:58:45.624 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_232_301_1140_940_0.jpg
2025-08-08 06:58:45.625 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_233_1466_1147_602_0.jpg
2025-08-08 06:58:45.625 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_93_324_268_737_1834_0.jpg
2025-08-08 06:58:45.629 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_361_435_977_304_0.jpg
2025-08-08 06:58:45.629 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_616_930_468_258_0.jpg
2025-08-08 06:58:45.629 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_287_1114_1128_645_0.jpg
2025-08-08 06:58:45.629 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_304_320_1113_638_0.jpg
2025-08-08 06:58:45.629 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_214_315_1133_645_0.jpg
2025-08-08 06:58:45.629 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_220_1122_1142_645_0.jpg
2025-08-08 06:58:45.630 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_287_1119_1136_651_0.jpg
2025-08-08 06:58:45.630 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_299_324_1134_642_0.jpg
2025-08-08 06:58:45.630 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_203_320_1145_655_0.jpg
2025-08-08 06:58:45.630 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_227_1129_1130_645_0.jpg
2025-08-08 06:58:45.630 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_290_1126_1125_656_0.jpg
2025-08-08 06:58:45.631 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_306_322_1119_646_0.jpg
2025-08-08 06:58:45.631 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_212_221_1133_659_0.jpg
2025-08-08 06:58:45.631 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_225_1049_1127_636_0.jpg
2025-08-08 06:58:45.631 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_0_1237_154_289_162_0.jpg
2025-08-08 06:58:45.631 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_253_704_552_467_0.jpg
2025-08-08 06:58:45.631 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_884_684_459_455_0.jpg
2025-08-08 06:58:45.632 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_143_500_318_578_556_0.jpg
2025-08-08 06:58:45.632 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_146_315_228_1095_400_0.jpg
2025-08-08 06:58:45.632 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_150_286_250_1129_814_0.jpg
2025-08-08 06:58:45.632 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_248_725_1164_564_0.jpg
2025-08-08 06:58:45.632 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_388_215_897_435_0.jpg
2025-08-08 06:58:45.632 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_287_1311_1133_384_0.jpg
2025-08-08 06:58:45.633 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_70_393_948_902_341_0.jpg
2025-08-08 06:58:45.633 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_72_258_681_1160_1355_0.jpg
2025-08-08 06:58:45.633 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_75_240_362_1177_1656_0.jpg
2025-08-08 06:58:45.633 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_78_240_318_1168_1731_0.jpg
2025-08-08 06:58:45.633 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_81_248_343_1165_1687_0.jpg
2025-08-08 06:58:45.633 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_84_238_386_1162_1624_0.jpg
2025-08-08 06:58:45.634 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_86_239_653_1166_1338_0.jpg
2025-08-08 06:58:45.634 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_88_623_450_653_646_0.jpg
2025-08-08 06:58:45.634 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_90_238_296_1174_1720_0.jpg
2025-08-08 06:58:45.634 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_91_225_299_1187_1707_0.jpg
2025-08-08 06:58:45.634 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_94_257_289_1171_1697_0.jpg
2025-08-08 06:58:45.634 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_97_227_303_1170_1731_0.jpg
2025-08-08 06:58:45.635 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_101_225_672_1178_1353_0.jpg
2025-08-08 06:58:45.635 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_102_240_291_1203_1722_0.jpg
2025-08-08 06:58:45.635 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_103_240_297_1178_1734_0.jpg
2025-08-08 06:58:45.635 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_119_475_1184_667_691_0.jpg
2025-08-08 06:58:45.635 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_121_593_1023_425_178_0.jpg
2025-08-08 06:58:45.635 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_122_444_294_775_206_0.jpg
2025-08-08 06:58:45.636 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_413_902_778_279_0.jpg
2025-08-08 06:58:45.636 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_419_1314_768_347_0.jpg
2025-08-08 06:58:45.636 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_126_387_330_904_455_0.jpg
2025-08-08 06:58:45.636 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_129_362_691_912_684_0.jpg
2025-08-08 06:58:45.636 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_137_501_1634_612_391_0.jpg
2025-08-08 06:58:45.636 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_138_536_226_623_387_0.jpg
2025-08-08 06:58:45.637 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_177_316_1559_1037_507_0.jpg
2025-08-08 06:58:45.637 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_187_373_890_922_309_0.jpg
2025-08-08 06:58:45.637 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_389_874_879_339_0.jpg
2025-08-08 06:58:45.637 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_509_232_635_564_0.jpg
2025-08-08 06:58:45.637 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_514_1307_644_653_0.jpg
2025-08-08 06:58:45.637 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_318_1309_1020_458_0.jpg
2025-08-08 06:58:45.638 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_397_458_892_388_0.jpg
2025-08-08 06:58:45.638 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_539_1403_583_424_0.jpg
2025-08-08 06:58:45.638 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_194_438_645_754_434_0.jpg
2025-08-08 06:58:45.638 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_365_222_908_608_0.jpg
2025-08-08 06:58:45.638 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_385_1267_869_447_0.jpg
2025-08-08 06:58:45.638 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_206_501_795_660_1153_0.jpg
2025-08-08 06:58:45.639 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_208_581_1522_499_443_0.jpg
2025-08-08 06:58:45.639 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_209_536_235_551_971_0.jpg
2025-08-08 06:58:45.639 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_210_246_516_270_300_0.jpg
2025-08-08 06:58:45.639 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_128_411_445_833_494_0.jpg
2025-08-08 06:58:45.639 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_428_384_769_490_0.jpg
2025-08-08 06:58:45.639 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_49_529_271_627_470_0.jpg
2025-08-08 06:58:45.640 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_66_257_325_1140_552_0.jpg
2025-08-08 06:58:45.640 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_1090_878_289_229_0.jpg
2025-08-08 06:58:45.640 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_432_894_219_206_0.jpg
2025-08-08 06:58:45.640 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_728_895_247_200_0.jpg
2025-08-08 06:58:45.640 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1095_623_266_169_0.jpg
2025-08-08 06:58:45.641 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1141_832_201_101_0.jpg
2025-08-08 06:58:45.641 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_444_641_235_139_0.jpg
2025-08-08 06:58:45.641 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_459_831_166_104_0.jpg
2025-08-08 06:58:45.641 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_724_603_276_178_0.jpg
2025-08-08 06:58:45.641 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_747_821_223_122_0.jpg
2025-08-08 06:58:45.649 | INFO     | database.document_service:full_scan:327 - 正在扫描 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-08 06:58:45.649 | INFO     | database.document_service:full_scan:332 - 全量扫描完成，共处理文件数: 1581
2025-08-08 06:58:45.649 | DEBUG    | database.document_service:_start_watchdog:335 - 启动文件监控 Watchdog
2025-08-08 06:58:45.650 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 06:58:45.650 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-08 06:58:45.650 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-08 06:58:45.666 | INFO     | database.document_service:_start_watchdog:423 - Watchdog 已启动
2025-08-08 06:58:45.666 | INFO     | database.document_service:start:465 - DocumentQueryService 已启动
2025-08-08 06:58:45.666 | INFO     | __main__:combined_lifespan:83 - 统一文档查询服务 (DocumentQueryService) 已启动。
2025-08-08 06:58:45.666 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/Projects1', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-08 06:58:45.666 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/规程规范', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-08 06:58:45.666 | INFO     | __main__:combined_lifespan:88 - 项目和规程的文件服务已初始化。
2025-08-08 06:58:45.667 | INFO     | __main__:combined_lifespan:93 - AsyncIOScheduler 已实例化并注册到 app_state。
2025-08-08 06:58:45.667 | INFO     | __main__:combined_lifespan:97 - FastMCP lifespan context entered.
2025-08-08 06:58:45.668 | INFO     | __main__:combined_lifespan:117 - 处理不活动用户会话任务已添加到APScheduler (每 60s)。
2025-08-08 06:58:45.668 | INFO     | __main__:combined_lifespan:120 - 清理用户会话中已打开文件token任务已添加到APScheduler (每 120s)。
2025-08-08 06:58:45.668 | INFO     | __main__:combined_lifespan:123 - APScheduler 调度器已启动。
2025-08-08 06:58:45.668 | INFO     | __main__:combined_lifespan:124 - 所有初始化完成... yield
2025-08-08 06:58:45.668 | DEBUG    | database.document_service:_debounced_update_loop:426 - 启动去抖更新循环
2025-08-08 06:58:48.397 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: 154b005c-9125-475d-bdce-7de542e78bdf, IP: 240e:3a1:7d0:ab80::e7) 登录/状态更新成功。
2025-08-08 06:58:48.397 | INFO     | api.route:login:69 - 用户 'admin' (IP: 240e:3a1:7d0:ab80::e7, Session: 154b005c-9125-475d-bdce-7de542e78bdf) 登录成功。
2025-08-08 06:58:48.559 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 154b005c-9125-475d-bdce-7de542e78bdf) 的 WebSocket 已连接并关联。
2025-08-08 06:58:48.636 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-08 06:58:51.192 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 06:59:19.518 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 06:59:19.519 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: http://240e:3a1:7d0:ab80::e7:1234/v1
2025-08-08 06:59:19.519 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******
2025-08-08 06:59:19.520 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: openai/gpt-oss-20b
2025-08-08 06:59:19.539 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 06:59:36.139 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 06:59:36.140 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 154b005c-9125-475d-bdce-7de542e78bdf, 对话ID: cfdcda26-1b5c-4bb2-bf00-fcfb2b54a06e, 查询: 你好
2025-08-08 06:59:36.140 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:qwen3-235b-a22b-instruct-2507
2025-08-08 06:59:50.106 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 06:59:50.107 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 154b005c-9125-475d-bdce-7de542e78bdf, 对话ID: cfdcda26-1b5c-4bb2-bf00-fcfb2b54a06e, 查询: 帮我看看系统中有哪些项目
2025-08-08 06:59:50.107 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:qwen3-235b-a22b-instruct-2507
2025-08-08 06:59:51.559 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '3', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user": "admin", "project_name": "/ALL"}'}}]
2025-08-08 06:59:51.560 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user": "admin", "project_name": "/ALL"}
2025-08-08 06:59:51.602 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='/ALL', 年份='None'
2025-08-08 06:59:51.602 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 06:59:51.613 | INFO     | my_mcp_tools.mcp_tools:query_project_files:747 - 收到全部项目查询请求
2025-08-08 06:59:51.619 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:qwen3-235b-a22b-instruct-2507
2025-08-08 07:00:04.956 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:00:04.956 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 154b005c-9125-475d-bdce-7de542e78bdf, 对话ID: cfdcda26-1b5c-4bb2-bf00-fcfb2b54a06e, 查询: 打开项目15
2025-08-08 07:00:04.956 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:qwen3-235b-a22b-instruct-2507
2025-08-08 07:00:07.910 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '8', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user": "admin", "project_name": "白衣河输变电工程初设收口版"}'}}]
2025-08-08 07:00:07.910 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user": "admin", "project_name": "白衣河输变电工程初设收口版"}
2025-08-08 07:00:07.958 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='白衣河输变电工程初设收口版', 年份='None'
2025-08-08 07:00:07.958 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:00:07.969 | INFO     | my_mcp_tools.mcp_tools:query_project_files:756 - 精确匹配到项目: '白衣河输变电工程初设收口版'
2025-08-08 07:00:07.969 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '白衣河输变电工程初设收口版']
2025-08-08 07:00:07.973 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '白衣河输变电工程初设收口版'，包含 340 个文件。
2025-08-08 07:00:07.978 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 07:00:07.986 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:qwen3-235b-a22b-instruct-2507
2025-08-08 07:00:21.446 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:00:21.446 | INFO     | sse_proxy.sse2websocket1:run:265 - 会话 154b005c-9125-475d-bdce-7de542e78bdf 用户 admin 中止响应流任务
2025-08-08 07:00:21.447 | INFO     | sse_proxy.sse2websocket1:_start:101 - 会话 154b005c-9125-475d-bdce-7de542e78bdf 被取消
2025-08-08 07:00:25.133 | ERROR    | sse_proxy.sse2websocket1:run:307 - WebSocket 错误 (会话 154b005c-9125-475d-bdce-7de542e78bdf): Invalid port: '3a1:7d0:ab80::e7:1234'
2025-08-08 07:00:25.133 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:00:25.133 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:00:49.225 | DEBUG    | core.session:logout_user:152 - 用户 'admin' (会话: 154b005c-9125-475d-bdce-7de542e78bdf) 已从状态管理器登出。
2025-08-08 07:00:49.225 | INFO     | api.route:logout:80 - HTTP会话已清除 (用户: admin)。
2025-08-08 07:00:52.475 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, IP: 240e:3a1:7d0:ab80::e7) 登录/状态更新成功。
2025-08-08 07:00:52.475 | INFO     | api.route:login:69 - 用户 'admin' (IP: 240e:3a1:7d0:ab80::e7, Session: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 登录成功。
2025-08-08 07:00:52.638 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:00:52.638 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:00:57.288 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 07:00:57.288 | INFO     | api.admin:update_admin_config:164 - 从服务商 'tencent' 的预设中加载了 API Key。
2025-08-08 07:00:57.288 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: http://240e:3a1:7d0:ab80::e7:1234/v1
2025-08-08 07:00:57.289 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: openai/gpt-oss-20b
2025-08-08 07:00:57.289 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******zI0G
2025-08-08 07:00:57.310 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 07:00:58.894 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:00:58.894 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:01:04.577 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:01:04.577 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:01:10.584 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:01:10.584 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:01:16.883 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:01:16.883 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:01:23.012 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:01:23.014 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:01:28.755 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:01:28.755 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:01:34.580 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:01:34.580 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:01:40.575 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:01:40.576 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:01:46.607 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:01:46.607 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:01:52.570 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:01:52.570 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:01:58.657 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:01:58.657 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:02:04.591 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:02:04.592 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:02:10.653 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:02:10.653 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:02:16.641 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:02:16.642 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:02:22.834 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:02:22.835 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:02:28.944 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:02:28.944 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:02:28.947 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 07:02:28.947 | INFO     | api.admin:update_admin_config:164 - 从服务商 'tencent' 的预设中加载了 API Key。
2025-08-08 07:02:28.947 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: http://[240e:3a1:7d0:ab80::e7]:1234/v1
2025-08-08 07:02:28.947 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: openai/gpt-oss-20b
2025-08-08 07:02:28.947 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******zI0G
2025-08-08 07:02:28.967 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 07:02:34.588 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f) 的 WebSocket 已连接并关联。
2025-08-08 07:02:34.665 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-08 07:02:40.558 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 2a05d24b-f41b-4667-8238-652938a4c91f。清空历史记录。
2025-08-08 07:02:49.034 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:02:49.034 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: 2a05d24b-f41b-4667-8238-652938a4c91f, 查询: nihao
2025-08-08 07:02:49.034 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:03:29.717 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:03:29.717 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: 2a05d24b-f41b-4667-8238-652938a4c91f, 查询: 看看系统中有哪些项目
2025-08-08 07:03:29.717 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:03:30.765 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '11', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"/ALL"}'}}]
2025-08-08 07:03:30.765 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"/ALL"}
2025-08-08 07:03:30.808 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='/ALL', 年份='None'
2025-08-08 07:03:30.808 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:03:30.819 | INFO     | my_mcp_tools.mcp_tools:query_project_files:747 - 收到全部项目查询请求
2025-08-08 07:03:30.825 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:03:40.530 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:03:40.530 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: 2a05d24b-f41b-4667-8238-652938a4c91f, 查询: 帮我打开项目1
2025-08-08 07:03:40.530 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:03:41.986 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '37', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"无锡石园220千伏变电站第二台主变扩建工程"}'}}]
2025-08-08 07:03:41.986 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"无锡石园220千伏变电站第二台主变扩建工程"}
2025-08-08 07:03:42.035 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='无锡石园220千伏变电站第二台主变扩建工程', 年份='None'
2025-08-08 07:03:42.035 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:03:42.045 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['1-无锡石园220千伏变电站第二台主变扩建工程']
2025-08-08 07:03:42.045 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '1-无锡石园220千伏变电站第二台主变扩建工程'
2025-08-08 07:03:42.046 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '1-无锡石园220千伏变电站第二台主变扩建工程']
2025-08-08 07:03:42.047 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '1-无锡石园220千伏变电站第二台主变扩建工程'，包含 55 个文件。
2025-08-08 07:03:42.048 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 07:03:42.055 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:03:51.078 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:03:51.078 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: 2a05d24b-f41b-4667-8238-652938a4c91f, 查询: 读取环评报告
2025-08-08 07:03:51.078 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:04:20.436 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:04:20.437 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: 2a05d24b-f41b-4667-8238-652938a4c91f, 查询: 读取环评报告
2025-08-08 07:04:20.437 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:04:41.639 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: a738567a-79e4-430e-888c-8bb62e6d470b。清空历史记录。
2025-08-08 07:04:55.187 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:04:55.187 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: a738567a-79e4-430e-888c-8bb62e6d470b, 查询: 看看系统中有哪些项目
2025-08-08 07:04:55.187 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:04:55.924 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '48', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"/ALL"}'}}]
2025-08-08 07:04:55.925 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"/ALL"}
2025-08-08 07:04:55.969 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='/ALL', 年份='None'
2025-08-08 07:04:55.969 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:04:55.981 | INFO     | my_mcp_tools.mcp_tools:query_project_files:747 - 收到全部项目查询请求
2025-08-08 07:04:55.986 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:05:05.428 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:05:05.428 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: a738567a-79e4-430e-888c-8bb62e6d470b, 查询: 打开丹华的项目
2025-08-08 07:05:05.428 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:05:06.413 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '61', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"丹华初设"}'}}]
2025-08-08 07:05:06.413 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"丹华初设"}
2025-08-08 07:05:06.459 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='丹华初设', 年份='None'
2025-08-08 07:05:06.459 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:05:06.476 | INFO     | my_mcp_tools.mcp_tools:query_project_files:756 - 精确匹配到项目: '丹华初设'
2025-08-08 07:05:06.477 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '丹华初设']
2025-08-08 07:05:06.479 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '丹华初设'，包含 153 个文件。
2025-08-08 07:05:06.480 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 07:05:06.489 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:05:07.172 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '72', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"/ALL"}'}}]
2025-08-08 07:05:07.173 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"/ALL"}
2025-08-08 07:05:07.217 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='/ALL', 年份='None'
2025-08-08 07:05:07.217 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:05:07.229 | INFO     | my_mcp_tools.mcp_tools:query_project_files:747 - 收到全部项目查询请求
2025-08-08 07:05:07.234 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:05:07.927 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '83', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"/ALL"}'}}]
2025-08-08 07:05:07.927 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"/ALL"}
2025-08-08 07:05:07.970 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='/ALL', 年份='None'
2025-08-08 07:05:07.970 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:05:07.981 | INFO     | my_mcp_tools.mcp_tools:query_project_files:747 - 收到全部项目查询请求
2025-08-08 07:05:07.987 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:05:08.931 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '94', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"/ALL"}'}}]
2025-08-08 07:05:08.931 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"/ALL"}
2025-08-08 07:05:08.975 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='/ALL', 年份='None'
2025-08-08 07:05:08.975 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:05:08.991 | INFO     | my_mcp_tools.mcp_tools:query_project_files:747 - 收到全部项目查询请求
2025-08-08 07:05:08.997 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:05:09.723 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '105', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"/ALL"}'}}]
2025-08-08 07:05:09.723 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"/ALL"}
2025-08-08 07:05:09.765 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='/ALL', 年份='None'
2025-08-08 07:05:09.765 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:05:09.776 | INFO     | my_mcp_tools.mcp_tools:query_project_files:747 - 收到全部项目查询请求
2025-08-08 07:05:09.781 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:05:10.489 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '116', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"/ALL"}'}}]
2025-08-08 07:05:10.489 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"/ALL"}
2025-08-08 07:05:10.534 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='/ALL', 年份='None'
2025-08-08 07:05:10.534 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:05:10.545 | INFO     | my_mcp_tools.mcp_tools:query_project_files:747 - 收到全部项目查询请求
2025-08-08 07:05:10.550 | WARNING  | sse_proxy.sse2websocket1:_handle_stream:115 - 递归深度超过最大限制(5)，终止工具调用
2025-08-08 07:05:24.838 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:05:24.838 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: a738567a-79e4-430e-888c-8bb62e6d470b, 查询: 读取会议纪要
2025-08-08 07:05:24.838 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:05:25.810 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '127', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"/ALL"}'}}]
2025-08-08 07:05:25.810 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"/ALL"}
2025-08-08 07:05:25.853 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='/ALL', 年份='None'
2025-08-08 07:05:25.853 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:05:25.869 | INFO     | my_mcp_tools.mcp_tools:query_project_files:747 - 收到全部项目查询请求
2025-08-08 07:05:25.875 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:05:26.630 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '138', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"/ALL"}'}}]
2025-08-08 07:05:26.630 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"/ALL"}
2025-08-08 07:05:26.673 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='/ALL', 年份='None'
2025-08-08 07:05:26.673 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:05:26.684 | INFO     | my_mcp_tools.mcp_tools:query_project_files:747 - 收到全部项目查询请求
2025-08-08 07:05:26.689 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:05:27.450 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '149', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"/ALL"}'}}]
2025-08-08 07:05:27.450 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"/ALL"}
2025-08-08 07:05:27.492 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='/ALL', 年份='None'
2025-08-08 07:05:27.492 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:05:27.503 | INFO     | my_mcp_tools.mcp_tools:query_project_files:747 - 收到全部项目查询请求
2025-08-08 07:05:27.508 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:05:28.227 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '160', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"/ALL"}'}}]
2025-08-08 07:05:28.228 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"/ALL"}
2025-08-08 07:05:28.269 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='/ALL', 年份='None'
2025-08-08 07:05:28.270 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:05:28.283 | INFO     | my_mcp_tools.mcp_tools:query_project_files:747 - 收到全部项目查询请求
2025-08-08 07:05:28.288 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:05:29.004 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '171', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"/ALL"}'}}]
2025-08-08 07:05:29.004 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"/ALL"}
2025-08-08 07:05:29.047 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='/ALL', 年份='None'
2025-08-08 07:05:29.047 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:05:29.058 | INFO     | my_mcp_tools.mcp_tools:query_project_files:747 - 收到全部项目查询请求
2025-08-08 07:05:29.063 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:05:29.910 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '186', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"/ALL","year":null}'}}]
2025-08-08 07:05:29.910 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"/ALL","year":null}
2025-08-08 07:05:29.956 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='/ALL', 年份='None'
2025-08-08 07:05:29.956 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:05:29.967 | INFO     | my_mcp_tools.mcp_tools:query_project_files:747 - 收到全部项目查询请求
2025-08-08 07:05:29.972 | WARNING  | sse_proxy.sse2websocket1:_handle_stream:115 - 递归深度超过最大限制(5)，终止工具调用
2025-08-08 07:05:56.643 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 16cf043b-51f3-4157-bf62-46031c79fb11。清空历史记录。
2025-08-08 07:06:03.850 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:06:03.850 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: 16cf043b-51f3-4157-bf62-46031c79fb11, 查询: 帮我读取丹华项目的会议纪要
2025-08-08 07:06:03.850 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:06:04.727 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '201', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"丹华","year":null}'}}]
2025-08-08 07:06:04.727 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"丹华","year":null}
2025-08-08 07:06:04.772 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='丹华', 年份='None'
2025-08-08 07:06:04.773 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:06:04.783 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['丹华初设']
2025-08-08 07:06:04.783 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '丹华初设'
2025-08-08 07:06:04.784 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '丹华初设']
2025-08-08 07:06:04.786 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '丹华初设'，包含 153 个文件。
2025-08-08 07:06:04.787 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 07:06:04.795 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:06:06.059 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '216', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"丹华","year":null}'}}]
2025-08-08 07:06:06.059 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"丹华","year":null}
2025-08-08 07:06:06.104 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='丹华', 年份='None'
2025-08-08 07:06:06.104 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:06:06.118 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['丹华初设']
2025-08-08 07:06:06.118 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '丹华初设'
2025-08-08 07:06:06.119 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '丹华初设']
2025-08-08 07:06:06.121 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '丹华初设'，包含 153 个文件。
2025-08-08 07:06:06.123 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 07:06:06.130 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:06:06.991 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '231', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"丹华","year":null}'}}]
2025-08-08 07:06:06.991 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"丹华","year":null}
2025-08-08 07:06:07.041 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='丹华', 年份='None'
2025-08-08 07:06:07.041 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:06:07.055 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['丹华初设']
2025-08-08 07:06:07.055 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '丹华初设'
2025-08-08 07:06:07.056 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '丹华初设']
2025-08-08 07:06:07.059 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '丹华初设'，包含 153 个文件。
2025-08-08 07:06:07.060 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 07:06:07.068 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:06:08.172 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '246', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"丹华","year":null}'}}]
2025-08-08 07:06:08.172 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"丹华","year":null}
2025-08-08 07:06:08.219 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='丹华', 年份='None'
2025-08-08 07:06:08.219 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:06:08.230 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['丹华初设']
2025-08-08 07:06:08.230 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '丹华初设'
2025-08-08 07:06:08.231 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '丹华初设']
2025-08-08 07:06:08.233 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '丹华初设'，包含 153 个文件。
2025-08-08 07:06:08.235 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 07:06:08.242 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:06:09.643 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '261', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"丹华","year":null}'}}]
2025-08-08 07:06:09.643 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"丹华","year":null}
2025-08-08 07:06:09.685 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='丹华', 年份='None'
2025-08-08 07:06:09.686 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:06:09.697 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['丹华初设']
2025-08-08 07:06:09.697 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '丹华初设'
2025-08-08 07:06:09.697 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '丹华初设']
2025-08-08 07:06:09.700 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '丹华初设'，包含 153 个文件。
2025-08-08 07:06:09.701 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 07:06:09.708 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:06:11.102 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '276', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"丹华","year":null}'}}]
2025-08-08 07:06:11.102 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"丹华","year":null}
2025-08-08 07:06:11.147 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='丹华', 年份='None'
2025-08-08 07:06:11.147 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:06:11.158 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['丹华初设']
2025-08-08 07:06:11.158 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '丹华初设'
2025-08-08 07:06:11.158 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '丹华初设']
2025-08-08 07:06:11.160 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '丹华初设'，包含 153 个文件。
2025-08-08 07:06:11.162 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 07:06:11.170 | WARNING  | sse_proxy.sse2websocket1:_handle_stream:115 - 递归深度超过最大限制(5)，终止工具调用
2025-08-08 07:08:03.313 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: a5633491-a203-45bb-ba45-99106aec1f24。清空历史记录。
2025-08-08 07:08:18.447 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:08:18.447 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: a5633491-a203-45bb-ba45-99106aec1f24, 查询: 查询下二次知识库，告诉我CT 的准确级倍数一般有多少
2025-08-08 07:08:18.447 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:08:20.632 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '297', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query":"CT 的准确级倍数一般有多少","knowledge_base_name":"二次"}'}}]
2025-08-08 07:08:20.632 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query":"CT 的准确级倍数一般有多少","knowledge_base_name":"二次"}
2025-08-08 07:08:20.680 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: 'CT 的准确级倍数一般有多少...', top_k: 5
2025-08-08 07:08:20.680 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 07:08:20.884 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 07:08:20.885 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='CT 的准确级倍数一般有多少...', top_k=5
2025-08-08 07:08:21.264 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 4 条结果。
2025-08-08 07:08:21.270 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:08:22.280 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '323', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query":"CT 的准确级倍数一般有多少","knowledge_base_name":"二次","top_k":5}'}}]
2025-08-08 07:08:22.280 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query":"CT 的准确级倍数一般有多少","knowledge_base_name":"二次","top_k":5}
2025-08-08 07:08:22.322 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: 'CT 的准确级倍数一般有多少...', top_k: 5
2025-08-08 07:08:22.322 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 07:08:22.406 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 07:08:22.406 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='CT 的准确级倍数一般有多少...', top_k=5
2025-08-08 07:08:22.852 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 4 条结果。
2025-08-08 07:08:22.858 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:08:23.859 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '349', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query":"CT 的准确级倍数一般有多少","knowledge_base_name":"二次","top_k":5}'}}]
2025-08-08 07:08:23.859 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query":"CT 的准确级倍数一般有多少","knowledge_base_name":"二次","top_k":5}
2025-08-08 07:08:23.901 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: 'CT 的准确级倍数一般有多少...', top_k: 5
2025-08-08 07:08:23.901 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 07:08:23.989 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 07:08:23.989 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='CT 的准确级倍数一般有多少...', top_k=5
2025-08-08 07:08:24.139 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 4 条结果。
2025-08-08 07:08:24.146 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:08:25.020 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '375', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query":"CT的准确级倍数一般有多少","knowledge_base_name":"二次","top_k":5}'}}]
2025-08-08 07:08:25.020 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query":"CT的准确级倍数一般有多少","knowledge_base_name":"二次","top_k":5}
2025-08-08 07:08:25.063 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: 'CT的准确级倍数一般有多少...', top_k: 5
2025-08-08 07:08:25.063 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 07:08:25.145 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 07:08:25.145 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='CT的准确级倍数一般有多少...', top_k=5
2025-08-08 07:08:25.398 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 4 条结果。
2025-08-08 07:08:25.405 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:08:26.401 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '401', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query":"CT的准确级倍数一般有多少","knowledge_base_name":"二次","top_k":5}'}}]
2025-08-08 07:08:26.402 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query":"CT的准确级倍数一般有多少","knowledge_base_name":"二次","top_k":5}
2025-08-08 07:08:26.443 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: 'CT的准确级倍数一般有多少...', top_k: 5
2025-08-08 07:08:26.443 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 07:08:26.523 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 07:08:26.523 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='CT的准确级倍数一般有多少...', top_k=5
2025-08-08 07:08:26.770 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 4 条结果。
2025-08-08 07:08:26.776 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:08:28.293 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '422', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query":"CT 的准确级倍数一般有多少","knowledge_base_name":"电气"}'}}]
2025-08-08 07:08:28.293 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query":"CT 的准确级倍数一般有多少","knowledge_base_name":"电气"}
2025-08-08 07:08:28.342 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 电气, 用户查询: 'CT 的准确级倍数一般有多少...', top_k: 5
2025-08-08 07:08:28.343 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '电气', 'page': 1, 'limit': 10}
2025-08-08 07:08:28.434 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '电气' 的ID: 95bde3ad-88fe-4994-8599-34f155626984
2025-08-08 07:08:28.434 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/95bde3ad-88fe-4994-8599-34f155626984/retrieve 发起检索请求。Payload (部分): query='CT 的准确级倍数一般有多少...', top_k=5
2025-08-08 07:08:28.745 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '电气' 检索到 5 条结果。
2025-08-08 07:08:28.752 | WARNING  | sse_proxy.sse2websocket1:_handle_stream:115 - 递归深度超过最大限制(5)，终止工具调用
2025-08-08 07:09:33.273 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 231cc074-428c-4383-b5a1-2f47bb0c4c55。清空历史记录。
2025-08-08 07:09:41.240 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:09:41.240 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: 231cc074-428c-4383-b5a1-2f47bb0c4c55, 查询: 系统中有哪些项目
2025-08-08 07:09:41.240 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:09:42.130 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '433', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"/ALL"}'}}]
2025-08-08 07:09:42.130 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"/ALL"}
2025-08-08 07:09:42.172 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='/ALL', 年份='None'
2025-08-08 07:09:42.172 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:09:42.183 | INFO     | my_mcp_tools.mcp_tools:query_project_files:747 - 收到全部项目查询请求
2025-08-08 07:09:42.189 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:10:06.205 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:10:06.205 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: 231cc074-428c-4383-b5a1-2f47bb0c4c55, 查询: 帮我打开项目5
2025-08-08 07:10:06.206 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:10:07.933 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '445', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"南京姚庄"}'}}]
2025-08-08 07:10:07.933 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"南京姚庄"}
2025-08-08 07:10:07.975 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='南京姚庄', 年份='None'
2025-08-08 07:10:07.975 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:10:07.985 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['南京姚庄110千伏变电站改造工程']
2025-08-08 07:10:07.986 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '南京姚庄110千伏变电站改造工程'
2025-08-08 07:10:07.986 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '南京姚庄110千伏变电站改造工程']
2025-08-08 07:10:07.987 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '南京姚庄110千伏变电站改造工程'，包含 12 个文件。
2025-08-08 07:10:07.987 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 07:10:07.992 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:10:25.974 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:10:25.974 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: 231cc074-428c-4383-b5a1-2f47bb0c4c55, 查询: 读取材料清册
2025-08-08 07:10:25.974 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:10:28.230 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '502', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/南京姚庄110千伏变电站改造工程/送审/姚庄110千伏变电站改造工程/初步设计阶段-材料清册.pdf","file_category":"普通文档"}'}}]
2025-08-08 07:10:28.230 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/南京姚庄110千伏变电站改造工程/送审/姚庄110千伏变电站改造工程/初步设计阶段-材料清册.pdf","file_category":"普通文档"}
2025-08-08 07:10:28.272 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/南京姚庄110千伏变电站改造工程/送审/姚庄110千伏变电站改造工程/初步设计阶段-材料清册.pdf', Category: '普通文档'
2025-08-08 07:10:28.272 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/南京姚庄110千伏变电站改造工程/送审/姚庄110千伏变电站改造工程/初步设计阶段-材料清册.pdf
2025-08-08 07:10:28.277 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:10:56.640 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:10:56.640 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: 231cc074-428c-4383-b5a1-2f47bb0c4c55, 查询: 文件名就可以了
2025-08-08 07:10:56.641 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:11:12.788 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:11:12.788 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: 231cc074-428c-4383-b5a1-2f47bb0c4c55, 查询: 检查你读取工具的调用路径
2025-08-08 07:11:12.788 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:13:55.609 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 463e8dbe-4248-4361-ad35-fe10db891185。清空历史记录。
2025-08-08 07:14:05.914 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:14:05.914 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: 463e8dbe-4248-4361-ad35-fe10db891185, 查询: 打开姚庄项目
2025-08-08 07:14:05.914 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:14:10.712 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '517', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"姚庄","year":null}'}}]
2025-08-08 07:14:10.712 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"姚庄","year":null}
2025-08-08 07:14:10.760 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='姚庄', 年份='None'
2025-08-08 07:14:10.760 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 07:14:10.770 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['南京姚庄110千伏变电站改造工程']
2025-08-08 07:14:10.770 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '南京姚庄110千伏变电站改造工程'
2025-08-08 07:14:10.771 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '南京姚庄110千伏变电站改造工程']
2025-08-08 07:14:10.772 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '南京姚庄110千伏变电站改造工程'，包含 12 个文件。
2025-08-08 07:14:10.772 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 07:14:10.777 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:14:23.545 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:14:23.545 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f, 对话ID: 463e8dbe-4248-4361-ad35-fe10db891185, 查询: 读取材料清册
2025-08-08 07:14:23.545 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:14:28.063 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '585', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/南京姚庄110千伏变电站改造工程/送审/姚庄110千伏变电站改造工程/姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf","file_category":"普通文档"}'}}]
2025-08-08 07:14:28.063 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/南京姚庄110千伏变电站改造工程/送审/姚庄110千伏变电站改造工程/姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf","file_category":"普通文档"}
2025-08-08 07:14:28.108 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/南京姚庄110千伏变电站改造工程/送审/姚庄110千伏变电站改造工程/姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf', Category: '普通文档'
2025-08-08 07:14:28.108 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/南京姚庄110千伏变电站改造工程/送审/姚庄110千伏变电站改造工程/姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf (相对路径: 2024/南京姚庄110千伏变电站改造工程/送审/姚庄110千伏变电站改造工程/姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf)，分隔符: '	'
2025-08-08 07:14:28.416 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: 姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf, 内容长度: 2655
2025-08-08 07:14:28.416 | INFO     | my_mcp_tools.mcp_tools:read_project_file:706 - 从文件 2024/南京姚庄110千伏变电站改造工程/送审/姚庄110千伏变电站改造工程/姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf成功读取（预览100字）:编 号:A01-02
姚庄 110 千伏变电站改造工程
初步设计
主要材料清册
能拓能源股份有限公司
工程设计乙级（新能源发电、送电工程、变电工程）
证书编号 A232030999
2024 年 07
2025-08-08 07:14:28.416 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/南京姚庄110千伏变电站改造工程/送审/姚庄110千伏变电站改造工程/姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf' (token: 4059e66b51ac4921baba7f5056d49313), 有效期至: Fri Aug  8 15:14:28 2025
2025-08-08 07:14:28.417 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/南京姚庄110千伏变电站改造工程/送审/姚庄110千伏变电站改造工程/姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf' 已在会话中注册, token: 4059e66b51ac4921baba7f5056d49313
2025-08-08 07:14:28.423 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 07:14:28.483 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/4059e66b51ac4921baba7f5056d49313/姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf
2025-08-08 07:14:28.925 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '姚庄110千伏变电站改造工程初步设计阶段-材料清册_8835aa5c.pdf' 与Token关联文件名 '姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 07:14:28.926 | DEBUG    | api.route:download_file_via_token:186 - Token '4059e66b51ac4921baba7f5056d49313' 验证成功。准备下载文件: '姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/南京姚庄110千伏变电站改造工程/送审/姚庄110千伏变电站改造工程/姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf', URL文件名: '姚庄110千伏变电站改造工程初步设计阶段-材料清册_8835aa5c.pdf')
2025-08-08 07:14:28.928 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '姚庄110千伏变电站改造工程初步设计阶段-材料清册_8835aa5c.pdf' 与Token关联文件名 '姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 07:14:28.928 | DEBUG    | api.route:download_file_via_token:186 - Token '4059e66b51ac4921baba7f5056d49313' 验证成功。准备下载文件: '姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/南京姚庄110千伏变电站改造工程/送审/姚庄110千伏变电站改造工程/姚庄110千伏变电站改造工程初步设计阶段-材料清册.pdf', URL文件名: '姚庄110千伏变电站改造工程初步设计阶段-材料清册_8835aa5c.pdf')
2025-08-08 07:14:54.029 | DEBUG    | sse_proxy.sse2websocket1:run:304 - WebSocket 会话 0fc058fc-a860-4d96-92f1-ecd50d5c2a6f 用户 admin 断开连接
2025-08-08 07:14:54.029 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 07:14:54.029 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 07:14:54.130 | INFO     | __main__:combined_lifespan:130 - COMBINED LIFESPAN END - PID: 417919 - 服务器关闭中...
2025-08-08 07:14:54.130 | INFO     | database.document_service:shutdown:469 - 正在关闭 DocumentQueryService...
2025-08-08 07:14:54.140 | INFO     | database.document_service:shutdown:474 - Watchdog 监控已停止。
2025-08-08 07:14:54.141 | INFO     | database.document_service:shutdown:482 - 后台更新任务已取消。
2025-08-08 07:14:54.141 | INFO     | database.document_service:shutdown:487 - 数据库连接已关闭。
2025-08-08 07:14:54.141 | INFO     | database.document_service:shutdown:489 - DocumentQueryService 已成功关闭。
2025-08-08 07:14:54.141 | INFO     | __main__:combined_lifespan:134 - 统一文档查询服务已关闭。
2025-08-08 07:14:54.141 | INFO     | __main__:combined_lifespan:139 - APScheduler 调度器已关闭。
2025-08-08 07:14:54.141 | INFO     | __main__:combined_lifespan:140 - Custom application resources cleaned up.
2025-08-08 08:16:32.239 | INFO     | __main__:<module>:35 - Loguru 日志系统已初始化。
2025-08-08 08:16:32.239 | INFO     | __main__:<module>:36 - 项目根目录配置为: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 08:16:32.239 | INFO     | __main__:<module>:37 - 数据库路径配置为: data/document_service.db
2025-08-08 08:16:32.239 | INFO     | __main__:<module>:38 - 表格列读取配置已加载: {'变电站安装工程概算表': (2, 6), '变电站建筑工程概算表': (2, 6), '电缆输电线路安装工程概算表': (2, 6), '电缆输电线路建筑工程概算表': (2, 6)}
2025-08-08 08:16:32.239 | INFO     | __main__:<module>:39 - kkFileView 服务地址配置为: http://127.0.0.1:8012/kkfileview
2025-08-08 08:16:32.240 | INFO     | __main__:<module>:42 - Dify Agent API Key: ********kGHe
2025-08-08 08:16:32.240 | INFO     | __main__:<module>:43 - Session Secret Key: ********cd78
2025-08-08 08:16:32.240 | INFO     | __main__:<module>:44 - 服务器ipv6地址为: http://[240e:479:668:3c1c:240:be1d:8772:67fa]:8888
2025-08-08 08:16:32.240 | INFO     | __main__:<module>:151 - FastAPI 应用已实例化并注册到 app_state。
2025-08-08 08:16:32.241 | INFO     | __main__:<module>:154 - CORS中间件已添加，允许所有来源。
2025-08-08 08:16:32.254 | INFO     | __main__:<module>:174 - MCP 服务器 '项目文件检索服务器' 已挂载到 FastAPI 应用的 '/mcp/' 路径。
2025-08-08 08:16:32.270 | INFO     | __main__:combined_lifespan:64 - COMBINED LIFESPAN START - PID: 513270 - 服务器启动中...
2025-08-08 08:16:32.309 | INFO     | __main__:combined_lifespan:69 - HTTPX 客户端已创建并注册到 app_state。
2025-08-08 08:16:32.309 | INFO     | utils.utils:check_embedding_service_health:28 - 正在检查嵌入模型服务，目标URL: http://127.0.0.1:8001/v1/models
2025-08-08 08:16:32.321 | INFO     | utils.utils:check_embedding_service_health:37 - 嵌入模型服务可用，模型列表: ['/home/zhouxiang/models/BAAI_bge-m3']
2025-08-08 08:16:32.321 | INFO     | core.session:__init__:79 - SessionStateManager已初始化。整体HTTP不活动超时: 3600秒
2025-08-08 08:16:32.322 | INFO     | __main__:combined_lifespan:77 - SessionStateManager 已实例化并注册到 app_state。
2025-08-08 08:16:32.322 | INFO     | database.document_service:__init__:164 - 有效文档根目录: {'项目文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/Projects1'), '规范文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/规程规范'), '管理文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/管理文件')}
2025-08-08 08:16:32.322 | DEBUG    | database.document_service:_init_db:180 - 初始化数据库
2025-08-08 08:16:32.323 | DEBUG    | database.document_service:_init_db:201 - 数据库初始化完成
2025-08-08 08:16:32.323 | INFO     | database.document_service:__init__:177 - DocumentQueryService 初始化完成
2025-08-08 08:16:32.323 | INFO     | database.document_service:full_scan:324 - 开始全量扫描...
2025-08-08 08:16:32.324 | INFO     | database.document_service:full_scan:327 - 正在扫描 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 08:16:38.397 | INFO     | database.document_service:full_scan:327 - 正在扫描 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-08 08:16:38.638 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_12_479_254_639_268_0.jpg
2025-08-08 08:16:38.638 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_19_1142_1062_132_174_0.jpg
2025-08-08 08:16:38.638 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_67_179_250_1020_1864_0.jpg
2025-08-08 08:16:38.638 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_68_163_248_1019_1887_0.jpg
2025-08-08 08:16:38.638 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_235_1053_1153_960_0.jpg
2025-08-08 08:16:38.639 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_257_392_1118_414_0.jpg
2025-08-08 08:16:38.639 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_227_383_1163_510_0.jpg
2025-08-08 08:16:38.639 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_234_1152_1146_503_0.jpg
2025-08-08 08:16:38.639 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_71_416_1374_824_646_0.jpg
2025-08-08 08:16:38.639 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_73_362_1146_917_618_0.jpg
2025-08-08 08:16:38.639 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_74_573_1274_462_123_0.jpg
2025-08-08 08:16:38.640 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_76_248_1224_1104_782_0.jpg
2025-08-08 08:16:38.640 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_78_242_276_1113_842_0.jpg
2025-08-08 08:16:38.640 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_80_347_280_898_515_0.jpg
2025-08-08 08:16:38.640 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_86_210_747_1187_915_0.jpg
2025-08-08 08:16:38.640 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_87_238_256_1180_936_0.jpg
2025-08-08 08:16:38.640 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_91_256_269_1156_955_0.jpg
2025-08-08 08:16:38.641 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_232_301_1140_940_0.jpg
2025-08-08 08:16:38.641 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_233_1466_1147_602_0.jpg
2025-08-08 08:16:38.641 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_93_324_268_737_1834_0.jpg
2025-08-08 08:16:38.645 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_361_435_977_304_0.jpg
2025-08-08 08:16:38.645 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_616_930_468_258_0.jpg
2025-08-08 08:16:38.645 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_287_1114_1128_645_0.jpg
2025-08-08 08:16:38.645 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_304_320_1113_638_0.jpg
2025-08-08 08:16:38.645 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_214_315_1133_645_0.jpg
2025-08-08 08:16:38.645 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_220_1122_1142_645_0.jpg
2025-08-08 08:16:38.646 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_287_1119_1136_651_0.jpg
2025-08-08 08:16:38.646 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_299_324_1134_642_0.jpg
2025-08-08 08:16:38.646 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_203_320_1145_655_0.jpg
2025-08-08 08:16:38.646 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_227_1129_1130_645_0.jpg
2025-08-08 08:16:38.646 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_290_1126_1125_656_0.jpg
2025-08-08 08:16:38.646 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_306_322_1119_646_0.jpg
2025-08-08 08:16:38.647 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_212_221_1133_659_0.jpg
2025-08-08 08:16:38.647 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_225_1049_1127_636_0.jpg
2025-08-08 08:16:38.647 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_0_1237_154_289_162_0.jpg
2025-08-08 08:16:38.647 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_253_704_552_467_0.jpg
2025-08-08 08:16:38.647 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_884_684_459_455_0.jpg
2025-08-08 08:16:38.647 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_143_500_318_578_556_0.jpg
2025-08-08 08:16:38.647 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_146_315_228_1095_400_0.jpg
2025-08-08 08:16:38.648 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_150_286_250_1129_814_0.jpg
2025-08-08 08:16:38.648 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_248_725_1164_564_0.jpg
2025-08-08 08:16:38.648 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_388_215_897_435_0.jpg
2025-08-08 08:16:38.648 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_287_1311_1133_384_0.jpg
2025-08-08 08:16:38.648 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_70_393_948_902_341_0.jpg
2025-08-08 08:16:38.648 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_72_258_681_1160_1355_0.jpg
2025-08-08 08:16:38.648 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_75_240_362_1177_1656_0.jpg
2025-08-08 08:16:38.649 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_78_240_318_1168_1731_0.jpg
2025-08-08 08:16:38.649 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_81_248_343_1165_1687_0.jpg
2025-08-08 08:16:38.649 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_84_238_386_1162_1624_0.jpg
2025-08-08 08:16:38.649 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_86_239_653_1166_1338_0.jpg
2025-08-08 08:16:38.649 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_88_623_450_653_646_0.jpg
2025-08-08 08:16:38.649 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_90_238_296_1174_1720_0.jpg
2025-08-08 08:16:38.650 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_91_225_299_1187_1707_0.jpg
2025-08-08 08:16:38.650 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_94_257_289_1171_1697_0.jpg
2025-08-08 08:16:38.650 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_97_227_303_1170_1731_0.jpg
2025-08-08 08:16:38.650 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_101_225_672_1178_1353_0.jpg
2025-08-08 08:16:38.651 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_102_240_291_1203_1722_0.jpg
2025-08-08 08:16:38.651 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_103_240_297_1178_1734_0.jpg
2025-08-08 08:16:38.651 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_119_475_1184_667_691_0.jpg
2025-08-08 08:16:38.651 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_121_593_1023_425_178_0.jpg
2025-08-08 08:16:38.652 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_122_444_294_775_206_0.jpg
2025-08-08 08:16:38.652 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_413_902_778_279_0.jpg
2025-08-08 08:16:38.652 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_419_1314_768_347_0.jpg
2025-08-08 08:16:38.652 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_126_387_330_904_455_0.jpg
2025-08-08 08:16:38.653 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_129_362_691_912_684_0.jpg
2025-08-08 08:16:38.653 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_137_501_1634_612_391_0.jpg
2025-08-08 08:16:38.653 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_138_536_226_623_387_0.jpg
2025-08-08 08:16:38.653 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_177_316_1559_1037_507_0.jpg
2025-08-08 08:16:38.654 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_187_373_890_922_309_0.jpg
2025-08-08 08:16:38.654 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_389_874_879_339_0.jpg
2025-08-08 08:16:38.654 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_509_232_635_564_0.jpg
2025-08-08 08:16:38.658 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_514_1307_644_653_0.jpg
2025-08-08 08:16:38.658 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_318_1309_1020_458_0.jpg
2025-08-08 08:16:38.658 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_397_458_892_388_0.jpg
2025-08-08 08:16:38.658 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_539_1403_583_424_0.jpg
2025-08-08 08:16:38.659 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_194_438_645_754_434_0.jpg
2025-08-08 08:16:38.659 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_365_222_908_608_0.jpg
2025-08-08 08:16:38.659 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_385_1267_869_447_0.jpg
2025-08-08 08:16:38.659 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_206_501_795_660_1153_0.jpg
2025-08-08 08:16:38.660 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_208_581_1522_499_443_0.jpg
2025-08-08 08:16:38.660 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_209_536_235_551_971_0.jpg
2025-08-08 08:16:38.660 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_210_246_516_270_300_0.jpg
2025-08-08 08:16:38.660 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_128_411_445_833_494_0.jpg
2025-08-08 08:16:38.660 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_428_384_769_490_0.jpg
2025-08-08 08:16:38.661 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_49_529_271_627_470_0.jpg
2025-08-08 08:16:38.661 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_66_257_325_1140_552_0.jpg
2025-08-08 08:16:38.661 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_1090_878_289_229_0.jpg
2025-08-08 08:16:38.661 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_432_894_219_206_0.jpg
2025-08-08 08:16:38.661 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_728_895_247_200_0.jpg
2025-08-08 08:16:38.662 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1095_623_266_169_0.jpg
2025-08-08 08:16:38.662 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1141_832_201_101_0.jpg
2025-08-08 08:16:38.662 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_444_641_235_139_0.jpg
2025-08-08 08:16:38.662 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_459_831_166_104_0.jpg
2025-08-08 08:16:38.663 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_724_603_276_178_0.jpg
2025-08-08 08:16:38.663 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_747_821_223_122_0.jpg
2025-08-08 08:16:38.674 | INFO     | database.document_service:full_scan:327 - 正在扫描 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-08 08:16:38.675 | INFO     | database.document_service:full_scan:332 - 全量扫描完成，共处理文件数: 1581
2025-08-08 08:16:38.675 | DEBUG    | database.document_service:_start_watchdog:335 - 启动文件监控 Watchdog
2025-08-08 08:16:38.675 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 08:16:38.676 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-08 08:16:38.676 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-08 08:16:38.710 | INFO     | database.document_service:_start_watchdog:423 - Watchdog 已启动
2025-08-08 08:16:38.710 | INFO     | database.document_service:start:465 - DocumentQueryService 已启动
2025-08-08 08:16:38.710 | INFO     | __main__:combined_lifespan:83 - 统一文档查询服务 (DocumentQueryService) 已启动。
2025-08-08 08:16:38.710 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/Projects1', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-08 08:16:38.711 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/规程规范', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-08 08:16:38.711 | INFO     | __main__:combined_lifespan:88 - 项目和规程的文件服务已初始化。
2025-08-08 08:16:38.712 | INFO     | __main__:combined_lifespan:93 - AsyncIOScheduler 已实例化并注册到 app_state。
2025-08-08 08:16:38.712 | INFO     | __main__:combined_lifespan:97 - FastMCP lifespan context entered.
2025-08-08 08:16:38.712 | INFO     | __main__:combined_lifespan:117 - 处理不活动用户会话任务已添加到APScheduler (每 60s)。
2025-08-08 08:16:38.712 | INFO     | __main__:combined_lifespan:120 - 清理用户会话中已打开文件token任务已添加到APScheduler (每 120s)。
2025-08-08 08:16:38.713 | INFO     | __main__:combined_lifespan:123 - APScheduler 调度器已启动。
2025-08-08 08:16:38.713 | INFO     | __main__:combined_lifespan:124 - 所有初始化完成... yield
2025-08-08 08:16:38.713 | DEBUG    | database.document_service:_debounced_update_loop:426 - 启动去抖更新循环
2025-08-08 08:17:04.640 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: 0056114f-0fb5-47e4-abfa-1191d78051b9, IP: 240e:479:668:3c1c:48de:21d5:4fd1:75a9) 登录/状态更新成功。
2025-08-08 08:17:04.640 | INFO     | api.route:login:69 - 用户 'admin' (IP: 240e:479:668:3c1c:48de:21d5:4fd1:75a9, Session: 0056114f-0fb5-47e4-abfa-1191d78051b9) 登录成功。
2025-08-08 08:17:05.114 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 0056114f-0fb5-47e4-abfa-1191d78051b9) 的 WebSocket 已连接并关联。
2025-08-08 08:17:05.198 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-08 08:17:14.345 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:479:668:3c1c:48de:21d5:4fd1:75a9'.
2025-08-08 08:17:26.209 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:479:668:3c1c:48de:21d5:4fd1:75a9'.
2025-08-08 08:17:26.210 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: http://[240e:3a1:7d0:ab80::e7]:1234/v1
2025-08-08 08:17:26.210 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: openai/gpt-oss-20b
2025-08-08 08:17:26.221 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:479:668:3c1c:48de:21d5:4fd1:75a9'.
2025-08-08 08:17:28.190 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: d20a4a7f-9f25-4fd8-8b3d-f12c074831d9。清空历史记录。
2025-08-08 08:17:37.891 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:17:37.891 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0056114f-0fb5-47e4-abfa-1191d78051b9, 对话ID: d20a4a7f-9f25-4fd8-8b3d-f12c074831d9, 查询: 打开船闸项目，读取材料清册
2025-08-08 08:17:37.891 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:17:41.173 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '15', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"船闸","year":null}'}}]
2025-08-08 08:17:41.173 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"船闸","year":null}
2025-08-08 08:17:41.220 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='船闸', 年份='None'
2025-08-08 08:17:41.221 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 08:17:41.232 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计']
2025-08-08 08:17:41.232 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计'
2025-08-08 08:17:41.233 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计']
2025-08-08 08:17:41.234 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计'，包含 77 个文件。
2025-08-08 08:17:41.235 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 08:17:41.242 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:17:48.535 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '116', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf","file_category":"普通文档"}'}}]
2025-08-08 08:17:48.535 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf","file_category":"普通文档"}
2025-08-08 08:17:48.582 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', Category: '普通文档'
2025-08-08 08:17:48.584 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf (相对路径: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf)，分隔符: '	'
2025-08-08 08:17:50.388 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: 382-B230168C-A-02 主要设备材料清册.pdf, 内容长度: 14465
2025-08-08 08:17:50.389 | INFO     | my_mcp_tools.mcp_tools:read_project_file:706 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf成功读取（预览100字）:文 件 编 号
382-B230168C-A-02
船闸 110 千伏变电站 2 号 3 号主变扩建工程
初步设计
要设备材料清册
智方设计股份有限公司
工程设计证书：甲级第 A132005184 号
2025-08-08 08:17:50.389 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf' (token: 31da547c4ad24658913ee18f7f1a1948), 有效期至: Fri Aug  8 16:17:50 2025
2025-08-08 08:17:50.390 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf' 已在会话中注册, token: 31da547c4ad24658913ee18f7f1a1948
2025-08-08 08:17:50.407 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:17:50.418 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/31da547c4ad24658913ee18f7f1a1948/382-B230168C-A-02 主要设备材料清册.pdf
2025-08-08 08:17:50.633 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '382-B230168C-A-02 主要设备材料清册_976bc601.pdf' 与Token关联文件名 '382-B230168C-A-02 主要设备材料清册.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 08:17:50.633 | DEBUG    | api.route:download_file_via_token:186 - Token '31da547c4ad24658913ee18f7f1a1948' 验证成功。准备下载文件: '382-B230168C-A-02 主要设备材料清册.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', URL文件名: '382-B230168C-A-02 主要设备材料清册_976bc601.pdf')
2025-08-08 08:17:50.635 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '382-B230168C-A-02 主要设备材料清册_976bc601.pdf' 与Token关联文件名 '382-B230168C-A-02 主要设备材料清册.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 08:17:50.636 | DEBUG    | api.route:download_file_via_token:186 - Token '31da547c4ad24658913ee18f7f1a1948' 验证成功。准备下载文件: '382-B230168C-A-02 主要设备材料清册.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', URL文件名: '382-B230168C-A-02 主要设备材料清册_976bc601.pdf')
2025-08-08 08:18:49.059 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:18:49.060 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0056114f-0fb5-47e4-abfa-1191d78051b9, 对话ID: d20a4a7f-9f25-4fd8-8b3d-f12c074831d9, 查询: 再读取收口概算，告诉我主变设备费多少
2025-08-08 08:18:49.060 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:20:59.754 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:20:59.754 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0056114f-0fb5-47e4-abfa-1191d78051b9, 对话ID: d20a4a7f-9f25-4fd8-8b3d-f12c074831d9, 查询: 继续
2025-08-08 08:20:59.754 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:21:25.474 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '216', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-01 初步设计说明书.pdf","file_category":"普通文档"}'}}]
2025-08-08 08:21:25.475 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-01 初步设计说明书.pdf","file_category":"普通文档"}
2025-08-08 08:21:25.529 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-01 初步设计说明书.pdf', Category: '普通文档'
2025-08-08 08:21:25.529 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-01 初步设计说明书.pdf (相对路径: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-01 初步设计说明书.pdf)，分隔符: '	'
2025-08-08 08:21:35.874 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: 382-B230168C-A-01 初步设计说明书.pdf, 内容长度: 57141
2025-08-08 08:21:35.874 | INFO     | my_mcp_tools.mcp_tools:read_project_file:706 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-01 初步设计说明书.pdf成功读取（预览100字）:文 件 编 号
382-B230168C-A-01
船闸 千伏变电站 号 号主变扩建
110 2 3
工程
初步设计说明书
智 方 设 计 股 份 有 限 公 司
工 程 设 计 证 书 ： 甲 级 
2025-08-08 08:21:35.875 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-01 初步设计说明书.pdf' (token: 52c8956f41b347f08f418c90028ec6dc), 有效期至: Fri Aug  8 16:21:35 2025
2025-08-08 08:21:35.875 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-01 初步设计说明书.pdf' 已在会话中注册, token: 52c8956f41b347f08f418c90028ec6dc
2025-08-08 08:21:35.897 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:21:35.912 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/52c8956f41b347f08f418c90028ec6dc/382-B230168C-A-01 初步设计说明书.pdf
2025-08-08 08:21:36.148 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '382-B230168C-A-01 初步设计说明书_b6507aa2.pdf' 与Token关联文件名 '382-B230168C-A-01 初步设计说明书.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 08:21:36.148 | DEBUG    | api.route:download_file_via_token:186 - Token '52c8956f41b347f08f418c90028ec6dc' 验证成功。准备下载文件: '382-B230168C-A-01 初步设计说明书.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-01 初步设计说明书.pdf', URL文件名: '382-B230168C-A-01 初步设计说明书_b6507aa2.pdf')
2025-08-08 08:21:36.151 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '382-B230168C-A-01 初步设计说明书_b6507aa2.pdf' 与Token关联文件名 '382-B230168C-A-01 初步设计说明书.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 08:21:36.151 | DEBUG    | api.route:download_file_via_token:186 - Token '52c8956f41b347f08f418c90028ec6dc' 验证成功。准备下载文件: '382-B230168C-A-01 初步设计说明书.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-01 初步设计说明书.pdf', URL文件名: '382-B230168C-A-01 初步设计说明书_b6507aa2.pdf')
2025-08-08 08:21:54.525 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '232', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"船闸项目","year":null}'}}]
2025-08-08 08:21:54.525 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"船闸项目","year":null}
2025-08-08 08:21:54.580 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='船闸项目', 年份='None'
2025-08-08 08:21:54.581 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 08:21:54.594 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 0 个项目: []
2025-08-08 08:21:54.594 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:785 - 使用向量检索辅助判断，候选项目数: 18
2025-08-08 08:21:54.594 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 08:21:54.821 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-3 结果: [('江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计', 0.6581897982751606), ('示例项目', 0.5153514321798993), ('1-无锡石园220千伏变电站第二台主变扩建工程', 0.46881214694737794)]
2025-08-08 08:21:54.822 | INFO     | my_mcp_tools.mcp_tools:query_project_files:790 - 向量检索匹配top1项目: '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计'
2025-08-08 08:21:54.823 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计']
2025-08-08 08:21:54.827 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计'，包含 77 个文件。
2025-08-08 08:21:54.828 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 08:21:54.840 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:22:43.146 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:22:43.146 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0056114f-0fb5-47e4-abfa-1191d78051b9, 对话ID: d20a4a7f-9f25-4fd8-8b3d-f12c074831d9, 查询: 有个文件叫概算，你读取下
2025-08-08 08:22:43.147 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:23:03.279 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '318', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx","file_category":"概算书文档"}'}}]
2025-08-08 08:23:03.279 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx","file_category":"概算书文档"}
2025-08-08 08:23:03.337 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', Category: '概算书文档'
2025-08-08 08:23:03.337 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx
2025-08-08 08:23:03.344 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:23:25.065 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '390', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx","file_category":"概算书文档"}'}}]
2025-08-08 08:23:25.065 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx","file_category":"概算书文档"}
2025-08-08 08:23:25.115 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', Category: '概算书文档'
2025-08-08 08:23:25.115 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx
2025-08-08 08:23:25.125 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:23:52.363 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:23:52.363 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0056114f-0fb5-47e4-abfa-1191d78051b9, 对话ID: d20a4a7f-9f25-4fd8-8b3d-f12c074831d9, 查询: 打开线路的概算
2025-08-08 08:23:52.363 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:24:13.355 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '489', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/概算书/胥口～石湖T接船闸变电站110千伏线路工程-概算7.23.xlsx","file_category":"概算书文档"}'}}]
2025-08-08 08:24:13.356 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/概算书/胥口～石湖T接船闸变电站110千伏线路工程-概算7.23.xlsx","file_category":"概算书文档"}
2025-08-08 08:24:13.410 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/概算书/胥口～石湖T接船闸变电站110千伏线路工程-概算7.23.xlsx', Category: '概算书文档'
2025-08-08 08:24:13.411 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/胥口~石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/概算书/胥口～石湖T接船闸变电站110千伏线路工程-概算7.23.xlsx
2025-08-08 08:24:13.417 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:24:36.771 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '588', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/胥口～石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/概算书/胥口～石湖T接船闸变电站110千伏线路工程-概算7.23.xlsx","file_category":"概算书文档"}'}}]
2025-08-08 08:24:36.771 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/胥口～石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/概算书/胥口～石湖T接船闸变电站110千伏线路工程-概算7.23.xlsx","file_category":"概算书文档"}
2025-08-08 08:24:36.824 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/胥口～石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/概算书/胥口～石湖T接船闸变电站110千伏线路工程-概算7.23.xlsx', Category: '概算书文档'
2025-08-08 08:24:36.824 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/胥口～石湖T接船闸变电站110千伏线路工程（电缆）收口版7.23/概算书/胥口～石湖T接船闸变电站110千伏线路工程-概算7.23.xlsx
2025-08-08 08:24:36.829 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:26:08.768 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:26:08.769 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0056114f-0fb5-47e4-abfa-1191d78051b9, 对话ID: d20a4a7f-9f25-4fd8-8b3d-f12c074831d9, 查询: 读取评审意见
2025-08-08 08:26:08.769 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:26:38.602 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '668', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx","file_category":"普通文档"}'}}]
2025-08-08 08:26:38.602 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx","file_category":"普通文档"}
2025-08-08 08:26:38.655 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx', Category: '普通文档'
2025-08-08 08:26:38.655 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx (相对路径: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx)，分隔符: '	'
2025-08-08 08:26:38.806 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: 苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx, 内容长度: 10375
2025-08-08 08:26:38.806 | INFO     | my_mcp_tools.mcp_tools:read_project_file:706 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx成功读取（预览100字）:

苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见

根据国网江苏省电力有限公司建设部初步设计评审计划安排，国网江苏电力设计咨询有限公司于2024年7月11日，开展了苏州船闸110kV变
2025-08-08 08:26:38.807 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx' (token: c56e95c52912422398172a8867ee3df9), 有效期至: Fri Aug  8 16:26:38 2025
2025-08-08 08:26:38.807 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx' 已在会话中注册, token: c56e95c52912422398172a8867ee3df9
2025-08-08 08:26:38.817 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:26:38.845 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/c56e95c52912422398172a8867ee3df9/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx
2025-08-08 08:26:38.856 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23_3760a68d.docx' 与Token关联文件名 '苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx' 不匹配。将使用Token关联文件名。
2025-08-08 08:26:38.856 | DEBUG    | api.route:download_file_via_token:186 - Token 'c56e95c52912422398172a8867ee3df9' 验证成功。准备下载文件: '苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx', URL文件名: '苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23_3760a68d.docx')
2025-08-08 08:27:37.141 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:27:37.141 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0056114f-0fb5-47e4-abfa-1191d78051b9, 对话ID: d20a4a7f-9f25-4fd8-8b3d-f12c074831d9, 查询: 看下评审意见的建设规模跟材料清册中是否一致
2025-08-08 08:27:37.142 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:27:58.450 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '745', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf","file_category":"普通文档"}'}}]
2025-08-08 08:27:58.451 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf","file_category":"普通文档"}
2025-08-08 08:27:58.496 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', Category: '普通文档'
2025-08-08 08:27:58.497 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf
2025-08-08 08:27:58.502 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:28:19.826 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '822', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf","file_category":"普通文档"}'}}]
2025-08-08 08:28:19.826 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf","file_category":"普通文档"}
2025-08-08 08:28:19.874 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', Category: '普通文档'
2025-08-08 08:28:19.874 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf
2025-08-08 08:28:19.880 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:29:21.309 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: a0fccfec-c5c9-42dd-9b9f-c9eb4ec57913。清空历史记录。
2025-08-08 08:29:36.643 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:29:36.643 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0056114f-0fb5-47e4-abfa-1191d78051b9, 对话ID: a0fccfec-c5c9-42dd-9b9f-c9eb4ec57913, 查询: 打开船闸大项目文件，读取变电工程的材料清册
2025-08-08 08:29:36.643 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:29:37.903 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '837', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"船闸","year":null}'}}]
2025-08-08 08:29:37.903 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"船闸","year":null}
2025-08-08 08:29:37.950 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='船闸', 年份='None'
2025-08-08 08:29:37.951 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 08:29:37.963 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计']
2025-08-08 08:29:37.963 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计'
2025-08-08 08:29:37.966 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计']
2025-08-08 08:29:37.969 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计'，包含 77 个文件。
2025-08-08 08:29:37.970 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 08:29:37.976 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:29:44.523 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '915', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc","file_category":"普通文档"}'}}]
2025-08-08 08:29:44.524 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc","file_category":"普通文档"}
2025-08-08 08:29:44.608 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc', Category: '普通文档'
2025-08-08 08:29:44.608 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc (相对路径: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc)，分隔符: '	'
2025-08-08 08:29:44.608 | WARNING  | utils.file_parser:parse_file:266 - 文件 '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc' 的扩展名 '.doc' 不在已知解析类型中，也非标准纯文本类型。
2025-08-08 08:29:44.608 | ERROR    | my_mcp_tools.mcp_tools:_get_file_content:86 - MCP Tool: 解析文件 /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc (相对路径: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc) 失败或返回错误: 错误: 不支持的文件类型 .doc。
2025-08-08 08:29:44.608 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:701 - 读取文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc 失败: 错误: 不支持的文件类型 .doc。
2025-08-08 08:29:44.614 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:29:46.661 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '1016', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf","file_category":"普通文档"}'}}]
2025-08-08 08:29:46.661 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf","file_category":"普通文档"}
2025-08-08 08:29:46.705 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', Category: '普通文档'
2025-08-08 08:29:46.705 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf (相对路径: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf)，分隔符: '	'
2025-08-08 08:29:48.879 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: 382-B230168C-A-02 主要设备材料清册.pdf, 内容长度: 14465
2025-08-08 08:29:48.880 | INFO     | my_mcp_tools.mcp_tools:read_project_file:706 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf成功读取（预览100字）:文 件 编 号
382-B230168C-A-02
船闸 110 千伏变电站 2 号 3 号主变扩建工程
初步设计
要设备材料清册
智方设计股份有限公司
工程设计证书：甲级第 A132005184 号
2025-08-08 08:29:48.880 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf' (token: 62360f82030245d7992f7b0bf25ce5c1), 有效期至: Fri Aug  8 16:29:48 2025
2025-08-08 08:29:48.882 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf' 已在会话中注册, token: 62360f82030245d7992f7b0bf25ce5c1
2025-08-08 08:29:48.893 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:29:48.909 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/62360f82030245d7992f7b0bf25ce5c1/382-B230168C-A-02 主要设备材料清册.pdf
2025-08-08 08:29:49.074 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '382-B230168C-A-02 主要设备材料清册_6cf209fa.pdf' 与Token关联文件名 '382-B230168C-A-02 主要设备材料清册.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 08:29:49.074 | DEBUG    | api.route:download_file_via_token:186 - Token '62360f82030245d7992f7b0bf25ce5c1' 验证成功。准备下载文件: '382-B230168C-A-02 主要设备材料清册.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', URL文件名: '382-B230168C-A-02 主要设备材料清册_6cf209fa.pdf')
2025-08-08 08:29:49.076 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '382-B230168C-A-02 主要设备材料清册_6cf209fa.pdf' 与Token关联文件名 '382-B230168C-A-02 主要设备材料清册.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 08:29:49.076 | DEBUG    | api.route:download_file_via_token:186 - Token '62360f82030245d7992f7b0bf25ce5c1' 验证成功。准备下载文件: '382-B230168C-A-02 主要设备材料清册.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', URL文件名: '382-B230168C-A-02 主要设备材料清册_6cf209fa.pdf')
2025-08-08 08:30:30.608 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:30:30.608 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0056114f-0fb5-47e4-abfa-1191d78051b9, 对话ID: a0fccfec-c5c9-42dd-9b9f-c9eb4ec57913, 查询: 再读取评审意见，看下评审意见中的建设规模和材料清册是否一致
2025-08-08 08:30:30.609 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:30:40.355 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '1117', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf","file_category":"普通文档"}'}}]
2025-08-08 08:30:40.355 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf","file_category":"普通文档"}
2025-08-08 08:30:40.398 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', Category: '普通文档'
2025-08-08 08:30:40.398 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf (相对路径: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf)，分隔符: '	'
2025-08-08 08:30:42.082 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: 382-B230168C-A-02 主要设备材料清册.pdf, 内容长度: 14465
2025-08-08 08:30:42.083 | INFO     | my_mcp_tools.mcp_tools:read_project_file:706 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf成功读取（预览100字）:文 件 编 号
382-B230168C-A-02
船闸 110 千伏变电站 2 号 3 号主变扩建工程
初步设计
要设备材料清册
智方设计股份有限公司
工程设计证书：甲级第 A132005184 号
2025-08-08 08:30:42.083 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf' (token: 8fffbc5930d04ec39f3a1d4b70c5fdf3), 有效期至: Fri Aug  8 16:30:42 2025
2025-08-08 08:30:42.085 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf' 已在会话中注册, token: 8fffbc5930d04ec39f3a1d4b70c5fdf3
2025-08-08 08:30:42.095 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:31:23.652 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '1218', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf","file_category":"普通文档"}'}}]
2025-08-08 08:31:23.652 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf","file_category":"普通文档"}
2025-08-08 08:31:23.700 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', Category: '普通文档'
2025-08-08 08:31:23.700 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf (相对路径: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf)，分隔符: '	'
2025-08-08 08:31:25.626 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: 382-B230168C-A-02 主要设备材料清册.pdf, 内容长度: 14465
2025-08-08 08:31:25.626 | INFO     | my_mcp_tools.mcp_tools:read_project_file:706 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf成功读取（预览100字）:文 件 编 号
382-B230168C-A-02
船闸 110 千伏变电站 2 号 3 号主变扩建工程
初步设计
要设备材料清册
智方设计股份有限公司
工程设计证书：甲级第 A132005184 号
2025-08-08 08:31:25.626 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf' (token: 4c0b9821cfe54b9c9ac66bb638d64d4b), 有效期至: Fri Aug  8 16:31:25 2025
2025-08-08 08:31:25.627 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf' 已在会话中注册, token: 4c0b9821cfe54b9c9ac66bb638d64d4b
2025-08-08 08:31:25.635 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:32:25.200 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:32:25.201 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0056114f-0fb5-47e4-abfa-1191d78051b9, 对话ID: a0fccfec-c5c9-42dd-9b9f-c9eb4ec57913, 查询: 去找下评审意见，读取，然后再看是否一致
2025-08-08 08:32:25.201 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:32:45.661 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '1335', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/船闸110千伏变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx","file_category":"普通文档"}'}}]
2025-08-08 08:32:45.662 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/船闸110千伏变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx","file_category":"普通文档"}
2025-08-08 08:32:45.713 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/船闸110千伏变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx', Category: '普通文档'
2025-08-08 08:32:45.713 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/船闸110千伏变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx
2025-08-08 08:32:45.719 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:33:06.475 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '1451', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）/船闸110千伏变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx","file_category":"普通文档"}'}}]
2025-08-08 08:33:06.475 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）/船闸110千伏变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx","file_category":"普通文档"}
2025-08-08 08:33:06.522 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）/船闸110千伏变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx', Category: '普通文档'
2025-08-08 08:33:06.522 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）/船闸110千伏变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx
2025-08-08 08:33:06.527 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:33:15.577 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:33:15.577 | INFO     | sse_proxy.sse2websocket1:run:265 - 会话 0056114f-0fb5-47e4-abfa-1191d78051b9 用户 admin 中止响应流任务
2025-08-08 08:33:15.578 | INFO     | sse_proxy.sse2websocket1:_start:101 - 会话 0056114f-0fb5-47e4-abfa-1191d78051b9 被取消
2025-08-08 08:33:20.592 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: cfe2b2e0-f7eb-442d-b1f5-fbff4d481a72。清空历史记录。
2025-08-08 08:33:29.712 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:33:29.712 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0056114f-0fb5-47e4-abfa-1191d78051b9, 对话ID: cfe2b2e0-f7eb-442d-b1f5-fbff4d481a72, 查询: 打开丹华的项目文件
2025-08-08 08:33:29.712 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:33:30.768 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '1466', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"丹华","year":null}'}}]
2025-08-08 08:33:30.768 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"丹华","year":null}
2025-08-08 08:33:30.818 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='丹华', 年份='None'
2025-08-08 08:33:30.819 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 08:33:30.834 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['丹华初设']
2025-08-08 08:33:30.835 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '丹华初设'
2025-08-08 08:33:30.835 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '丹华初设']
2025-08-08 08:33:30.837 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '丹华初设'，包含 153 个文件。
2025-08-08 08:33:30.839 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 08:33:30.847 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:34:57.383 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:34:57.383 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0056114f-0fb5-47e4-abfa-1191d78051b9, 对话ID: cfe2b2e0-f7eb-442d-b1f5-fbff4d481a72, 查询: 读取评审意见，以及材料清册
2025-08-08 08:34:57.384 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:35:00.632 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '1522', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx","file_category":"普通文档"}'}}]
2025-08-08 08:35:00.632 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx","file_category":"普通文档"}
2025-08-08 08:35:00.681 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx', Category: '普通文档'
2025-08-08 08:35:00.681 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx (相对路径: 2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx)，分隔符: '	'
2025-08-08 08:35:00.925 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: (01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx, 内容长度: 30148
2025-08-08 08:35:00.925 | INFO     | my_mcp_tools.mcp_tools:read_project_file:706 - 从文件 2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx成功读取（预览100字）:

江苏泰州丹华110kV输变电工程初步设计评审意见

根据国网江苏省电力有限公司建设部初步设计评审计划安排及委托，国网江苏电力设计咨询有限公司于4月24日下午14:00开始，会期半天；开展了江苏泰州
2025-08-08 08:35:00.925 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx' (token: 2c6eabe52efb4302b002092cba4868d7), 有效期至: Fri Aug  8 16:35:00 2025
2025-08-08 08:35:00.926 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx' 已在会话中注册, token: 2c6eabe52efb4302b002092cba4868d7
2025-08-08 08:35:00.939 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:35:00.963 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/2c6eabe52efb4302b002092cba4868d7/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx
2025-08-08 08:35:00.970 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）_41ec068f.docx' 与Token关联文件名 '(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx' 不匹配。将使用Token关联文件名。
2025-08-08 08:35:00.970 | DEBUG    | api.route:download_file_via_token:186 - Token '2c6eabe52efb4302b002092cba4868d7' 验证成功。准备下载文件: '(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx', URL文件名: '(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）_41ec068f.docx')
2025-08-08 08:35:41.410 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:35:41.410 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0056114f-0fb5-47e4-abfa-1191d78051b9, 对话ID: cfe2b2e0-f7eb-442d-b1f5-fbff4d481a72, 查询: 再读取材料清册
2025-08-08 08:35:41.410 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:36:00.215 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '1560', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)(02)材料清册.xlsx","file_category":"概算书文档"}'}}]
2025-08-08 08:36:00.215 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)(02)材料清册.xlsx","file_category":"概算书文档"}
2025-08-08 08:36:00.290 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2025/丹华初设/收口/(01)(02)材料清册.xlsx', Category: '概算书文档'
2025-08-08 08:36:00.290 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/丹华初设/收口/(01)(02)材料清册.xlsx
2025-08-08 08:36:00.295 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:36:18.881 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '1575', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"丹华","year":null}'}}]
2025-08-08 08:36:18.881 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"丹华","year":null}
2025-08-08 08:36:18.925 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='丹华', 年份='None'
2025-08-08 08:36:18.925 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 08:36:18.940 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['丹华初设']
2025-08-08 08:36:18.940 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '丹华初设'
2025-08-08 08:36:18.941 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '丹华初设']
2025-08-08 08:36:18.943 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '丹华初设'，包含 153 个文件。
2025-08-08 08:36:18.944 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 08:36:18.952 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:38:37.721 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:38:37.721 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 0056114f-0fb5-47e4-abfa-1191d78051b9, 对话ID: cfe2b2e0-f7eb-442d-b1f5-fbff4d481a72, 查询: 读取下概算吧
2025-08-08 08:38:37.721 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:38:57.954 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '1613', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)(02)材料清册.xlsx","file_category":"概算书文档"}'}}]
2025-08-08 08:38:57.954 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)(02)材料清册.xlsx","file_category":"概算书文档"}
2025-08-08 08:38:58.003 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2025/丹华初设/收口/(01)(02)材料清册.xlsx', Category: '概算书文档'
2025-08-08 08:38:58.003 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/丹华初设/收口/(01)(02)材料清册.xlsx
2025-08-08 08:38:58.008 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:39:17.102 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '1651', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)(02)概算表.xlsx","file_category":"概算书文档"}'}}]
2025-08-08 08:39:17.102 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)(02)概算表.xlsx","file_category":"概算书文档"}
2025-08-08 08:39:17.147 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2025/丹华初设/收口/(01)(02)概算表.xlsx', Category: '概算书文档'
2025-08-08 08:39:17.147 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/丹华初设/收口/(01)(02)概算表.xlsx
2025-08-08 08:39:17.152 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 08:39:26.367 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 08:39:26.367 | INFO     | sse_proxy.sse2websocket1:run:265 - 会话 0056114f-0fb5-47e4-abfa-1191d78051b9 用户 admin 中止响应流任务
2025-08-08 08:39:26.367 | INFO     | sse_proxy.sse2websocket1:_start:101 - 会话 0056114f-0fb5-47e4-abfa-1191d78051b9 被取消
2025-08-08 09:35:38.714 | INFO     | core.session:process_inactive_sessions:487 - 检测到 1 个不活动会话，将执行登出: admin
2025-08-08 09:35:38.714 | INFO     | core.session:process_inactive_sessions:493 - APScheduler: 用户 'admin' (会话 0056114f-0fb5-47e4-abfa-1191d78051b9) 因不活动被自动登出。
2025-08-08 09:35:38.714 | INFO     | core.session:process_inactive_sessions:495 - APScheduler: 尝试关闭用户 'admin' 的不活动WebSocket连接。
2025-08-08 09:35:38.732 | DEBUG    | sse_proxy.sse2websocket1:run:304 - WebSocket 会话 0056114f-0fb5-47e4-abfa-1191d78051b9 用户 admin 断开连接
2025-08-08 09:35:38.732 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 16:33:01.138 | INFO     | __main__:<module>:35 - Loguru 日志系统已初始化。
2025-08-08 16:33:01.139 | INFO     | __main__:<module>:36 - 项目根目录配置为: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 16:33:01.139 | INFO     | __main__:<module>:37 - 数据库路径配置为: data/document_service.db
2025-08-08 16:33:01.139 | INFO     | __main__:<module>:38 - 表格列读取配置已加载: {'变电站安装工程概算表': (2, 6), '变电站建筑工程概算表': (2, 6), '电缆输电线路安装工程概算表': (2, 6), '电缆输电线路建筑工程概算表': (2, 6)}
2025-08-08 16:33:01.139 | INFO     | __main__:<module>:39 - kkFileView 服务地址配置为: http://127.0.0.1:8012/kkfileview
2025-08-08 16:33:01.139 | INFO     | __main__:<module>:42 - Dify Agent API Key: ********kGHe
2025-08-08 16:33:01.139 | INFO     | __main__:<module>:43 - Session Secret Key: ********c563
2025-08-08 16:33:01.139 | INFO     | __main__:<module>:44 - 服务器ipv6地址为: http://[240e:479:668:3c1c:b5dc:e5a6:a573:f7a9]:8888
2025-08-08 16:33:01.140 | INFO     | __main__:<module>:151 - FastAPI 应用已实例化并注册到 app_state。
2025-08-08 16:33:01.140 | INFO     | __main__:<module>:154 - CORS中间件已添加，允许所有来源。
2025-08-08 16:33:01.155 | INFO     | __main__:<module>:174 - MCP 服务器 '项目文件检索服务器' 已挂载到 FastAPI 应用的 '/mcp/' 路径。
2025-08-08 16:33:01.185 | INFO     | __main__:combined_lifespan:64 - COMBINED LIFESPAN START - PID: 80115 - 服务器启动中...
2025-08-08 16:33:01.240 | INFO     | __main__:combined_lifespan:69 - HTTPX 客户端已创建并注册到 app_state。
2025-08-08 16:33:01.240 | INFO     | utils.utils:check_embedding_service_health:28 - 正在检查嵌入模型服务，目标URL: http://127.0.0.1:8001/v1/models
2025-08-08 16:33:01.254 | INFO     | utils.utils:check_embedding_service_health:37 - 嵌入模型服务可用，模型列表: ['/home/zhouxiang/models/BAAI_bge-m3']
2025-08-08 16:33:01.255 | INFO     | core.session:__init__:79 - SessionStateManager已初始化。整体HTTP不活动超时: 3600秒
2025-08-08 16:33:01.255 | INFO     | __main__:combined_lifespan:77 - SessionStateManager 已实例化并注册到 app_state。
2025-08-08 16:33:01.255 | INFO     | database.document_service:__init__:164 - 有效文档根目录: {'项目文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/Projects1'), '规范文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/规程规范'), '管理文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/管理文件')}
2025-08-08 16:33:01.256 | DEBUG    | database.document_service:_init_db:180 - 初始化数据库
2025-08-08 16:33:01.256 | DEBUG    | database.document_service:_init_db:201 - 数据库初始化完成
2025-08-08 16:33:01.256 | INFO     | database.document_service:__init__:177 - DocumentQueryService 初始化完成
2025-08-08 16:33:01.256 | INFO     | database.document_service:full_scan:324 - 开始全量扫描...
2025-08-08 16:33:01.256 | INFO     | database.document_service:full_scan:327 - 正在扫描 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 16:33:15.425 | INFO     | database.document_service:full_scan:327 - 正在扫描 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-08 16:33:16.295 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_12_479_254_639_268_0.jpg
2025-08-08 16:33:16.295 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_19_1142_1062_132_174_0.jpg
2025-08-08 16:33:16.296 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_67_179_250_1020_1864_0.jpg
2025-08-08 16:33:16.296 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_68_163_248_1019_1887_0.jpg
2025-08-08 16:33:16.296 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_235_1053_1153_960_0.jpg
2025-08-08 16:33:16.296 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_257_392_1118_414_0.jpg
2025-08-08 16:33:16.297 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_227_383_1163_510_0.jpg
2025-08-08 16:33:16.297 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_234_1152_1146_503_0.jpg
2025-08-08 16:33:16.297 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_71_416_1374_824_646_0.jpg
2025-08-08 16:33:16.297 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_73_362_1146_917_618_0.jpg
2025-08-08 16:33:16.297 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_74_573_1274_462_123_0.jpg
2025-08-08 16:33:16.297 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_76_248_1224_1104_782_0.jpg
2025-08-08 16:33:16.297 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_78_242_276_1113_842_0.jpg
2025-08-08 16:33:16.298 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_80_347_280_898_515_0.jpg
2025-08-08 16:33:16.298 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_86_210_747_1187_915_0.jpg
2025-08-08 16:33:16.298 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_87_238_256_1180_936_0.jpg
2025-08-08 16:33:16.298 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_91_256_269_1156_955_0.jpg
2025-08-08 16:33:16.298 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_232_301_1140_940_0.jpg
2025-08-08 16:33:16.299 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_233_1466_1147_602_0.jpg
2025-08-08 16:33:16.299 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_93_324_268_737_1834_0.jpg
2025-08-08 16:33:16.321 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_361_435_977_304_0.jpg
2025-08-08 16:33:16.322 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_616_930_468_258_0.jpg
2025-08-08 16:33:16.322 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_287_1114_1128_645_0.jpg
2025-08-08 16:33:16.322 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_304_320_1113_638_0.jpg
2025-08-08 16:33:16.322 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_214_315_1133_645_0.jpg
2025-08-08 16:33:16.322 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_220_1122_1142_645_0.jpg
2025-08-08 16:33:16.323 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_287_1119_1136_651_0.jpg
2025-08-08 16:33:16.323 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_299_324_1134_642_0.jpg
2025-08-08 16:33:16.323 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_203_320_1145_655_0.jpg
2025-08-08 16:33:16.323 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_227_1129_1130_645_0.jpg
2025-08-08 16:33:16.323 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_290_1126_1125_656_0.jpg
2025-08-08 16:33:16.323 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_306_322_1119_646_0.jpg
2025-08-08 16:33:16.324 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_212_221_1133_659_0.jpg
2025-08-08 16:33:16.324 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_225_1049_1127_636_0.jpg
2025-08-08 16:33:16.324 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_0_1237_154_289_162_0.jpg
2025-08-08 16:33:16.324 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_253_704_552_467_0.jpg
2025-08-08 16:33:16.324 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_884_684_459_455_0.jpg
2025-08-08 16:33:16.324 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_143_500_318_578_556_0.jpg
2025-08-08 16:33:16.325 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_146_315_228_1095_400_0.jpg
2025-08-08 16:33:16.325 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_150_286_250_1129_814_0.jpg
2025-08-08 16:33:16.325 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_248_725_1164_564_0.jpg
2025-08-08 16:33:16.325 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_388_215_897_435_0.jpg
2025-08-08 16:33:16.325 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_287_1311_1133_384_0.jpg
2025-08-08 16:33:16.325 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_70_393_948_902_341_0.jpg
2025-08-08 16:33:16.326 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_72_258_681_1160_1355_0.jpg
2025-08-08 16:33:16.326 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_75_240_362_1177_1656_0.jpg
2025-08-08 16:33:16.326 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_78_240_318_1168_1731_0.jpg
2025-08-08 16:33:16.326 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_81_248_343_1165_1687_0.jpg
2025-08-08 16:33:16.326 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_84_238_386_1162_1624_0.jpg
2025-08-08 16:33:16.326 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_86_239_653_1166_1338_0.jpg
2025-08-08 16:33:16.327 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_88_623_450_653_646_0.jpg
2025-08-08 16:33:16.327 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_90_238_296_1174_1720_0.jpg
2025-08-08 16:33:16.327 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_91_225_299_1187_1707_0.jpg
2025-08-08 16:33:16.327 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_94_257_289_1171_1697_0.jpg
2025-08-08 16:33:16.327 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_97_227_303_1170_1731_0.jpg
2025-08-08 16:33:16.327 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_101_225_672_1178_1353_0.jpg
2025-08-08 16:33:16.328 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_102_240_291_1203_1722_0.jpg
2025-08-08 16:33:16.328 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_103_240_297_1178_1734_0.jpg
2025-08-08 16:33:16.328 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_119_475_1184_667_691_0.jpg
2025-08-08 16:33:16.328 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_121_593_1023_425_178_0.jpg
2025-08-08 16:33:16.328 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_122_444_294_775_206_0.jpg
2025-08-08 16:33:16.329 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_413_902_778_279_0.jpg
2025-08-08 16:33:16.329 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_419_1314_768_347_0.jpg
2025-08-08 16:33:16.329 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_126_387_330_904_455_0.jpg
2025-08-08 16:33:16.329 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_129_362_691_912_684_0.jpg
2025-08-08 16:33:16.329 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_137_501_1634_612_391_0.jpg
2025-08-08 16:33:16.330 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_138_536_226_623_387_0.jpg
2025-08-08 16:33:16.330 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_177_316_1559_1037_507_0.jpg
2025-08-08 16:33:16.330 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_187_373_890_922_309_0.jpg
2025-08-08 16:33:16.330 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_389_874_879_339_0.jpg
2025-08-08 16:33:16.330 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_509_232_635_564_0.jpg
2025-08-08 16:33:16.331 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_514_1307_644_653_0.jpg
2025-08-08 16:33:16.331 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_318_1309_1020_458_0.jpg
2025-08-08 16:33:16.331 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_397_458_892_388_0.jpg
2025-08-08 16:33:16.331 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_539_1403_583_424_0.jpg
2025-08-08 16:33:16.332 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_194_438_645_754_434_0.jpg
2025-08-08 16:33:16.332 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_365_222_908_608_0.jpg
2025-08-08 16:33:16.332 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_385_1267_869_447_0.jpg
2025-08-08 16:33:16.332 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_206_501_795_660_1153_0.jpg
2025-08-08 16:33:16.333 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_208_581_1522_499_443_0.jpg
2025-08-08 16:33:16.333 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_209_536_235_551_971_0.jpg
2025-08-08 16:33:16.333 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_210_246_516_270_300_0.jpg
2025-08-08 16:33:16.333 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_128_411_445_833_494_0.jpg
2025-08-08 16:33:16.333 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_428_384_769_490_0.jpg
2025-08-08 16:33:16.334 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_49_529_271_627_470_0.jpg
2025-08-08 16:33:16.334 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_66_257_325_1140_552_0.jpg
2025-08-08 16:33:16.334 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_1090_878_289_229_0.jpg
2025-08-08 16:33:16.334 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_432_894_219_206_0.jpg
2025-08-08 16:33:16.334 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_728_895_247_200_0.jpg
2025-08-08 16:33:16.335 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1095_623_266_169_0.jpg
2025-08-08 16:33:16.335 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1141_832_201_101_0.jpg
2025-08-08 16:33:16.335 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_444_641_235_139_0.jpg
2025-08-08 16:33:16.335 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_459_831_166_104_0.jpg
2025-08-08 16:33:16.335 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_724_603_276_178_0.jpg
2025-08-08 16:33:16.336 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_747_821_223_122_0.jpg
2025-08-08 16:33:16.356 | INFO     | database.document_service:full_scan:327 - 正在扫描 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-08 16:33:16.356 | INFO     | database.document_service:full_scan:332 - 全量扫描完成，共处理文件数: 1581
2025-08-08 16:33:16.356 | DEBUG    | database.document_service:_start_watchdog:335 - 启动文件监控 Watchdog
2025-08-08 16:33:16.357 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 16:33:16.357 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-08 16:33:16.357 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-08 16:33:16.377 | INFO     | database.document_service:_start_watchdog:423 - Watchdog 已启动
2025-08-08 16:33:16.377 | INFO     | database.document_service:start:465 - DocumentQueryService 已启动
2025-08-08 16:33:16.377 | INFO     | __main__:combined_lifespan:83 - 统一文档查询服务 (DocumentQueryService) 已启动。
2025-08-08 16:33:16.377 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/Projects1', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-08 16:33:16.377 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/规程规范', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-08 16:33:16.377 | INFO     | __main__:combined_lifespan:88 - 项目和规程的文件服务已初始化。
2025-08-08 16:33:16.378 | INFO     | __main__:combined_lifespan:93 - AsyncIOScheduler 已实例化并注册到 app_state。
2025-08-08 16:33:16.379 | INFO     | __main__:combined_lifespan:97 - FastMCP lifespan context entered.
2025-08-08 16:33:16.379 | INFO     | __main__:combined_lifespan:117 - 处理不活动用户会话任务已添加到APScheduler (每 60s)。
2025-08-08 16:33:16.379 | INFO     | __main__:combined_lifespan:120 - 清理用户会话中已打开文件token任务已添加到APScheduler (每 120s)。
2025-08-08 16:33:16.380 | INFO     | __main__:combined_lifespan:123 - APScheduler 调度器已启动。
2025-08-08 16:33:16.380 | INFO     | __main__:combined_lifespan:124 - 所有初始化完成... yield
2025-08-08 16:33:16.380 | DEBUG    | database.document_service:_debounced_update_loop:426 - 启动去抖更新循环
2025-08-08 16:34:41.894 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: b0bd1b98-4898-4f30-8699-7e39df62cd23, IP: 127.0.0.1) 登录/状态更新成功。
2025-08-08 16:34:41.894 | INFO     | api.route:login:69 - 用户 'admin' (IP: 127.0.0.1, Session: b0bd1b98-4898-4f30-8699-7e39df62cd23) 登录成功。
2025-08-08 16:34:42.004 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: b0bd1b98-4898-4f30-8699-7e39df62cd23) 的 WebSocket 已连接并关联。
2025-08-08 16:34:42.102 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-08 16:34:58.358 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 16:35:05.782 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 16:35:05.783 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: http://[240e:3a1:7d0:ab80::e7]:1234/v1
2025-08-08 16:35:05.784 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: openai/gpt-oss-20b
2025-08-08 16:35:05.787 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 16:35:09.202 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 9664b8f5-ef9c-4106-8a6c-e7a9f02ade31。清空历史记录。
2025-08-08 16:35:24.865 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 16:35:24.865 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 b0bd1b98-4898-4f30-8699-7e39df62cd23, 对话ID: 9664b8f5-ef9c-4106-8a6c-e7a9f02ade31, 查询: 看下二次有哪些规范
2025-08-08 16:35:24.865 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:35:27.523 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '27', 'type': 'function', 'function': {'name': 'open_specification_files', 'arguments': '{"user":"admin","query_spec_filename":"/ALL","category":"二次","read_file":false,"top_n":10}'}}]
2025-08-08 16:35:27.523 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: open_specification_files with args: {"user":"admin","query_spec_filename":"/ALL","category":"二次","read_file":false,"top_n":10}
2025-08-08 16:35:27.573 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:834 - 工具调用: open_specification_files, 查询: '/ALL', 类别: '二次', 读取文件: False, Top N: 10
2025-08-08 16:35:27.574 | DEBUG    | database.document_service:_db_query:550 - 查询规范文件分类 (适配器): 二次
2025-08-08 16:35:27.574 | INFO     | database.document_service:_db_query:571 - 查询到 '二次' 分类的规范共 16 条
2025-08-08 16:35:27.574 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:856 - 用户请求 '二次' 类别下的所有规范。
2025-08-08 16:35:27.581 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:36:20.855 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 16:36:20.856 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 b0bd1b98-4898-4f30-8699-7e39df62cd23, 对话ID: 9664b8f5-ef9c-4106-8a6c-e7a9f02ade31, 查询: 打开规范12
2025-08-08 16:36:20.856 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:36:23.335 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '109', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"二次/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf","file_category":"普通文档"}'}}]
2025-08-08 16:36:23.335 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"二次/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf","file_category":"普通文档"}
2025-08-08 16:36:23.383 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '二次/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf', Category: '普通文档'
2025-08-08 16:36:23.383 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/二次/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf
2025-08-08 16:36:23.389 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:36:26.116 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '160', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"二次/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf","file_category":"普通文档"}'}}]
2025-08-08 16:36:26.116 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"二次/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf","file_category":"普通文档"}
2025-08-08 16:36:26.160 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '二次/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf', Category: '普通文档'
2025-08-08 16:36:26.160 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/二次/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf
2025-08-08 16:36:26.165 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:36:28.749 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '211', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"二次/QGDW 10766-2024 10kV～110(66)kV 线路保护及辅助装置标准化设计规范.pdf","file_category":"普通文档"}'}}]
2025-08-08 16:36:28.750 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"二次/QGDW 10766-2024 10kV～110(66)kV 线路保护及辅助装置标准化设计规范.pdf","file_category":"普通文档"}
2025-08-08 16:36:28.794 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '二次/QGDW 10766-2024 10kV～110(66)kV 线路保护及辅助装置标准化设计规范.pdf', Category: '普通文档'
2025-08-08 16:36:28.794 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/二次/QGDW 10766-2024 10kV～110(66)kV 线路保护及辅助装置标准化设计规范.pdf
2025-08-08 16:36:28.798 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:41:51.658 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 16:41:51.658 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 b0bd1b98-4898-4f30-8699-7e39df62cd23, 对话ID: 9664b8f5-ef9c-4106-8a6c-e7a9f02ade31, 查询: 使用打开规范那个工具
2025-08-08 16:41:51.658 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:41:54.522 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '268', 'type': 'function', 'function': {'name': 'open_specification_files', 'arguments': '{"user":"admin","query_spec_filename":"QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf","category":"二次","read_file":true,"top_n":1}'}}]
2025-08-08 16:41:54.522 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: open_specification_files with args: {"user":"admin","query_spec_filename":"QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf","category":"二次","read_file":true,"top_n":1}
2025-08-08 16:41:54.571 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:834 - 工具调用: open_specification_files, 查询: 'QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf', 类别: '二次', 读取文件: True, Top N: 1
2025-08-08 16:41:54.571 | DEBUG    | database.document_service:_db_query:550 - 查询规范文件分类 (适配器): 二次
2025-08-08 16:41:54.572 | INFO     | database.document_service:_db_query:571 - 查询到 '二次' 分类的规范共 16 条
2025-08-08 16:41:54.572 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 16:41:55.025 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-1 结果: [('QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范', 0.9761782044072653)]
2025-08-08 16:41:55.026 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:881 - 最匹配文件 '二次/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf' 相似度(0.9762) > 0.7，准备读取内容。
2025-08-08 16:41:55.026 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf (相对路径: 二次/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf)，分隔符: '
'
2025-08-08 16:42:28.006 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf, 内容长度: 1165719
2025-08-08 16:42:28.006 | WARNING  | my_mcp_tools.mcp_tools:open_specification_files:900 - 文件 '二次/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf' 内容过长，可能超过模型上下文窗口。
2025-08-08 16:42:28.006 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '二次/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf' (token: b474e56f0ab54366bce1223c48749ff6), 有效期至: Sat Aug  9 00:42:28 2025
2025-08-08 16:42:28.014 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/b474e56f0ab54366bce1223c48749ff6/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范.pdf
2025-08-08 16:42:28.015 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:42:28.019 | ERROR    | api.kkfileview:kkfileview_preview_encoder_proxy:70 - 代理 kkFileView 预览请求失败 (用户 'admin', 原始目标 URL: http://host.docker.internal:8888/download/b474e56f0ab54366bce1223c48749ff6/QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范_6a529d33.pdf): All connection attempts failed
2025-08-08 16:44:20.757 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 16:44:20.757 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 b0bd1b98-4898-4f30-8699-7e39df62cd23, 对话ID: 9664b8f5-ef9c-4106-8a6c-e7a9f02ade31, 查询: 打开规范16
2025-08-08 16:44:20.758 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:44:22.727 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '313', 'type': 'function', 'function': {'name': 'open_specification_files', 'arguments': '{"user":"admin","query_spec_filename":"QGDW 10688-2024 变电站辅助监控系统设计规范.pdf","category":"二次","read_file":true,"top_n":1}'}}]
2025-08-08 16:44:22.727 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: open_specification_files with args: {"user":"admin","query_spec_filename":"QGDW 10688-2024 变电站辅助监控系统设计规范.pdf","category":"二次","read_file":true,"top_n":1}
2025-08-08 16:44:22.775 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:834 - 工具调用: open_specification_files, 查询: 'QGDW 10688-2024 变电站辅助监控系统设计规范.pdf', 类别: '二次', 读取文件: True, Top N: 1
2025-08-08 16:44:22.775 | DEBUG    | database.document_service:_db_query:550 - 查询规范文件分类 (适配器): 二次
2025-08-08 16:44:22.776 | INFO     | database.document_service:_db_query:571 - 查询到 '二次' 分类的规范共 16 条
2025-08-08 16:44:22.776 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 16:44:22.981 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-1 结果: [('变电站辅助设备监控系统设计规范', 0.8566247354161967)]
2025-08-08 16:44:22.981 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:881 - 最匹配文件 '二次/变电站辅助设备监控系统设计规范/QGDW 10688-2024 变电站辅助监控系统设计规范.pdf' 相似度(0.8566) > 0.7，准备读取内容。
2025-08-08 16:44:22.981 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/变电站辅助设备监控系统设计规范/QGDW 10688-2024 变电站辅助监控系统设计规范.pdf (相对路径: 二次/变电站辅助设备监控系统设计规范/QGDW 10688-2024 变电站辅助监控系统设计规范.pdf)，分隔符: '
'
2025-08-08 16:44:30.991 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: QGDW 10688-2024 变电站辅助监控系统设计规范.pdf, 内容长度: 25215
2025-08-08 16:44:30.992 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '二次/变电站辅助设备监控系统设计规范/QGDW 10688-2024 变电站辅助监控系统设计规范.pdf' (token: 795ea2ac884f4b329b7866222801c092), 有效期至: Sat Aug  9 00:44:30 2025
2025-08-08 16:44:30.999 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/795ea2ac884f4b329b7866222801c092/QGDW 10688-2024 变电站辅助监控系统设计规范.pdf
2025-08-08 16:44:31.007 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:44:31.638 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'QGDW 10688-2024 变电站辅助监控系统设计规范_724de190.pdf' 与Token关联文件名 'QGDW 10688-2024 变电站辅助监控系统设计规范.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 16:44:31.638 | DEBUG    | api.route:download_file_via_token:186 - Token '795ea2ac884f4b329b7866222801c092' 验证成功。准备下载文件: 'QGDW 10688-2024 变电站辅助监控系统设计规范.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/规程规范/二次/变电站辅助设备监控系统设计规范/QGDW 10688-2024 变电站辅助监控系统设计规范.pdf', URL文件名: 'QGDW 10688-2024 变电站辅助监控系统设计规范_724de190.pdf')
2025-08-08 16:44:31.641 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'QGDW 10688-2024 变电站辅助监控系统设计规范_724de190.pdf' 与Token关联文件名 'QGDW 10688-2024 变电站辅助监控系统设计规范.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 16:44:31.642 | DEBUG    | api.route:download_file_via_token:186 - Token '795ea2ac884f4b329b7866222801c092' 验证成功。准备下载文件: 'QGDW 10688-2024 变电站辅助监控系统设计规范.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/规程规范/二次/变电站辅助设备监控系统设计规范/QGDW 10688-2024 变电站辅助监控系统设计规范.pdf', URL文件名: 'QGDW 10688-2024 变电站辅助监控系统设计规范_724de190.pdf')
2025-08-08 16:45:13.899 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 16:45:13.900 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 b0bd1b98-4898-4f30-8699-7e39df62cd23, 对话ID: 9664b8f5-ef9c-4106-8a6c-e7a9f02ade31, 查询: 告诉我二次系统在线监测的 监测内容
2025-08-08 16:45:13.900 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:46:06.381 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 5eddb5d1-930f-4d31-9609-8f21a5915ac5。清空历史记录。
2025-08-08 16:46:15.364 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 16:46:15.364 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 b0bd1b98-4898-4f30-8699-7e39df62cd23, 对话ID: 5eddb5d1-930f-4d31-9609-8f21a5915ac5, 查询: 帮我打开丹华项目
2025-08-08 16:46:15.364 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:46:16.314 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '328', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"丹华","year":null}'}}]
2025-08-08 16:46:16.314 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"丹华","year":null}
2025-08-08 16:46:16.363 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='丹华', 年份='None'
2025-08-08 16:46:16.363 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 16:46:16.377 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['丹华初设']
2025-08-08 16:46:16.377 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '丹华初设'
2025-08-08 16:46:16.377 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '丹华初设']
2025-08-08 16:46:16.380 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '丹华初设'，包含 153 个文件。
2025-08-08 16:46:16.382 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 16:46:16.393 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:46:34.806 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 16:46:34.806 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 b0bd1b98-4898-4f30-8699-7e39df62cd23, 对话ID: 5eddb5d1-930f-4d31-9609-8f21a5915ac5, 查询: 读取评审意见
2025-08-08 16:46:34.806 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:46:37.562 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '384', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx","file_category":"普通文档"}'}}]
2025-08-08 16:46:37.562 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx","file_category":"普通文档"}
2025-08-08 16:46:37.614 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx', Category: '普通文档'
2025-08-08 16:46:37.614 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx (相对路径: 2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx)，分隔符: '	'
2025-08-08 16:46:37.867 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: (01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx, 内容长度: 30148
2025-08-08 16:46:37.867 | INFO     | my_mcp_tools.mcp_tools:read_project_file:706 - 从文件 2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx成功读取（预览100字）:

江苏泰州丹华110kV输变电工程初步设计评审意见

根据国网江苏省电力有限公司建设部初步设计评审计划安排及委托，国网江苏电力设计咨询有限公司于4月24日下午14:00开始，会期半天；开展了江苏泰州
2025-08-08 16:46:37.867 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx' (token: 8720d0f5f80d4be6a73ce3ea9856f226), 有效期至: Sat Aug  9 00:46:37 2025
2025-08-08 16:46:37.868 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx' 已在会话中注册, token: 8720d0f5f80d4be6a73ce3ea9856f226
2025-08-08 16:46:37.876 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/8720d0f5f80d4be6a73ce3ea9856f226/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx
2025-08-08 16:46:37.888 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:46:37.895 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）_b8789acc.docx' 与Token关联文件名 '(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx' 不匹配。将使用Token关联文件名。
2025-08-08 16:46:37.895 | DEBUG    | api.route:download_file_via_token:186 - Token '8720d0f5f80d4be6a73ce3ea9856f226' 验证成功。准备下载文件: '(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx', URL文件名: '(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）_b8789acc.docx')
2025-08-08 16:47:27.661 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 16:47:27.661 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 b0bd1b98-4898-4f30-8699-7e39df62cd23, 对话ID: 5eddb5d1-930f-4d31-9609-8f21a5915ac5, 查询: 看下六助的材料清册,跟评审意见对下是否一直
2025-08-08 16:47:27.661 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:47:46.017 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '399', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"六助","year":null}'}}]
2025-08-08 16:47:46.017 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"六助","year":null}
2025-08-08 16:47:46.086 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='六助', 年份='None'
2025-08-08 16:47:46.086 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 16:47:46.098 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 0 个项目: []
2025-08-08 16:47:46.098 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:785 - 使用向量检索辅助判断，候选项目数: 18
2025-08-08 16:47:46.098 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 16:47:46.292 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-3 结果: [('示例项目', 0.2921536555990365), ('扬州品祚扩主变', 0.28254024172558717), ('东余变主变扩建工程', 0.27619136957150575)]
2025-08-08 16:47:46.292 | INFO     | my_mcp_tools.mcp_tools:query_project_files:790 - 向量检索匹配top1项目: '示例项目'
2025-08-08 16:47:46.293 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '示例项目']
2025-08-08 16:47:46.293 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '示例项目'，包含 1 个文件。
2025-08-08 16:47:46.294 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 16:47:46.301 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:48:04.785 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '430', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2025/六助初设/材料清册.xlsx","file_category":"概算书文档"}'}}]
2025-08-08 16:48:04.786 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2025/六助初设/材料清册.xlsx","file_category":"概算书文档"}
2025-08-08 16:48:04.835 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2025/六助初设/材料清册.xlsx', Category: '概算书文档'
2025-08-08 16:48:04.836 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/六助初设/材料清册.xlsx
2025-08-08 16:48:04.841 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:48:22.793 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '446', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"六助","year":"2025"}'}}]
2025-08-08 16:48:22.793 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"六助","year":"2025"}
2025-08-08 16:48:22.835 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='六助', 年份='2025'
2025-08-08 16:48:22.835 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.year') = ? with params: ['项目文件', '2025']
2025-08-08 16:48:22.841 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 0 个项目: []
2025-08-08 16:48:22.841 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:785 - 使用向量检索辅助判断，候选项目数: 7
2025-08-08 16:48:22.841 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 16:48:22.964 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-3 结果: [('东余变主变扩建工程', 0.2762461153348603), ('江苏扬州仪征500千伏变电站第三台主变扩建工程 初设文件(1)', 0.26086863843485936), ('S30211C-江苏南通东洲～新丰500千伏线路工程', 0.23753986211463488)]
2025-08-08 16:48:22.964 | INFO     | my_mcp_tools.mcp_tools:query_project_files:790 - 向量检索匹配top1项目: '东余变主变扩建工程'
2025-08-08 16:48:22.964 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '东余变主变扩建工程']
2025-08-08 16:48:22.965 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '东余变主变扩建工程'，包含 27 个文件。
2025-08-08 16:48:22.966 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 16:48:22.973 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:48:41.163 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '462', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"六助","year":"2025"}'}}]
2025-08-08 16:48:41.163 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"六助","year":"2025"}
2025-08-08 16:48:41.210 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='六助', 年份='2025'
2025-08-08 16:48:41.210 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.year') = ? with params: ['项目文件', '2025']
2025-08-08 16:48:41.216 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 0 个项目: []
2025-08-08 16:48:41.216 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:785 - 使用向量检索辅助判断，候选项目数: 7
2025-08-08 16:48:41.216 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 16:48:41.333 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-3 结果: [('东余变主变扩建工程', 0.2762461153348603), ('江苏扬州仪征500千伏变电站第三台主变扩建工程 初设文件(1)', 0.26086863843485936), ('S30211C-江苏南通东洲～新丰500千伏线路工程', 0.23753986211463488)]
2025-08-08 16:48:41.333 | INFO     | my_mcp_tools.mcp_tools:query_project_files:790 - 向量检索匹配top1项目: '东余变主变扩建工程'
2025-08-08 16:48:41.334 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '东余变主变扩建工程']
2025-08-08 16:48:41.335 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '东余变主变扩建工程'，包含 27 个文件。
2025-08-08 16:48:41.336 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 16:48:41.343 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:48:49.200 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 16:48:49.200 | INFO     | sse_proxy.sse2websocket1:run:265 - 会话 b0bd1b98-4898-4f30-8699-7e39df62cd23 用户 admin 中止响应流任务
2025-08-08 16:48:49.200 | INFO     | sse_proxy.sse2websocket1:_start:101 - 会话 b0bd1b98-4898-4f30-8699-7e39df62cd23 被取消
2025-08-08 16:56:41.001 | DEBUG    | sse_proxy.sse2websocket1:run:304 - WebSocket 会话 b0bd1b98-4898-4f30-8699-7e39df62cd23 用户 admin 断开连接
2025-08-08 16:56:41.001 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 16:56:41.001 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 16:56:41.101 | INFO     | __main__:combined_lifespan:130 - COMBINED LIFESPAN END - PID: 80115 - 服务器关闭中...
2025-08-08 16:56:41.101 | INFO     | database.document_service:shutdown:469 - 正在关闭 DocumentQueryService...
2025-08-08 16:56:41.114 | INFO     | database.document_service:shutdown:474 - Watchdog 监控已停止。
2025-08-08 16:56:41.114 | INFO     | database.document_service:shutdown:482 - 后台更新任务已取消。
2025-08-08 16:56:41.114 | INFO     | database.document_service:shutdown:487 - 数据库连接已关闭。
2025-08-08 16:56:41.114 | INFO     | database.document_service:shutdown:489 - DocumentQueryService 已成功关闭。
2025-08-08 16:56:41.114 | INFO     | __main__:combined_lifespan:134 - 统一文档查询服务已关闭。
2025-08-08 16:56:41.114 | INFO     | __main__:combined_lifespan:139 - APScheduler 调度器已关闭。
2025-08-08 16:56:41.115 | INFO     | __main__:combined_lifespan:140 - Custom application resources cleaned up.
2025-08-08 16:56:47.873 | INFO     | __main__:<module>:35 - Loguru 日志系统已初始化。
2025-08-08 16:56:47.873 | INFO     | __main__:<module>:36 - 项目根目录配置为: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 16:56:47.873 | INFO     | __main__:<module>:37 - 数据库路径配置为: data/document_service.db
2025-08-08 16:56:47.873 | INFO     | __main__:<module>:38 - 表格列读取配置已加载: {'变电站安装工程概算表': (2, 6), '变电站建筑工程概算表': (2, 6), '电缆输电线路安装工程概算表': (2, 6), '电缆输电线路建筑工程概算表': (2, 6)}
2025-08-08 16:56:47.873 | INFO     | __main__:<module>:39 - kkFileView 服务地址配置为: http://127.0.0.1:8012/kkfileview
2025-08-08 16:56:47.873 | INFO     | __main__:<module>:42 - Dify Agent API Key: ********kGHe
2025-08-08 16:56:47.873 | INFO     | __main__:<module>:43 - Session Secret Key: ********6235
2025-08-08 16:56:47.874 | INFO     | __main__:<module>:44 - 服务器ipv6地址为: http://[240e:479:668:3c1c:b5dc:e5a6:a573:f7a9]:8888
2025-08-08 16:56:47.874 | INFO     | __main__:<module>:151 - FastAPI 应用已实例化并注册到 app_state。
2025-08-08 16:56:47.874 | INFO     | __main__:<module>:154 - CORS中间件已添加，允许所有来源。
2025-08-08 16:56:47.885 | INFO     | __main__:<module>:174 - MCP 服务器 '项目文件检索服务器' 已挂载到 FastAPI 应用的 '/mcp/' 路径。
2025-08-08 16:56:47.906 | INFO     | __main__:combined_lifespan:64 - COMBINED LIFESPAN START - PID: 114748 - 服务器启动中...
2025-08-08 16:56:47.946 | INFO     | __main__:combined_lifespan:69 - HTTPX 客户端已创建并注册到 app_state。
2025-08-08 16:56:47.946 | INFO     | utils.utils:check_embedding_service_health:28 - 正在检查嵌入模型服务，目标URL: http://127.0.0.1:8001/v1/models
2025-08-08 16:56:47.954 | INFO     | utils.utils:check_embedding_service_health:37 - 嵌入模型服务可用，模型列表: ['/home/zhouxiang/models/BAAI_bge-m3']
2025-08-08 16:56:47.954 | INFO     | core.session:__init__:79 - SessionStateManager已初始化。整体HTTP不活动超时: 3600秒
2025-08-08 16:56:47.954 | INFO     | __main__:combined_lifespan:77 - SessionStateManager 已实例化并注册到 app_state。
2025-08-08 16:56:47.954 | INFO     | database.document_service:__init__:164 - 有效文档根目录: {'项目文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/Projects1'), '规范文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/规程规范'), '管理文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/管理文件')}
2025-08-08 16:56:47.955 | DEBUG    | database.document_service:_init_db:180 - 初始化数据库
2025-08-08 16:56:47.955 | DEBUG    | database.document_service:_init_db:201 - 数据库初始化完成
2025-08-08 16:56:47.955 | INFO     | database.document_service:__init__:177 - DocumentQueryService 初始化完成
2025-08-08 16:56:47.955 | INFO     | database.document_service:full_scan:324 - 开始全量扫描...
2025-08-08 16:56:47.955 | INFO     | database.document_service:full_scan:327 - 正在扫描 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 16:56:54.831 | INFO     | database.document_service:full_scan:327 - 正在扫描 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-08 16:56:55.052 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_12_479_254_639_268_0.jpg
2025-08-08 16:56:55.052 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_19_1142_1062_132_174_0.jpg
2025-08-08 16:56:55.052 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_67_179_250_1020_1864_0.jpg
2025-08-08 16:56:55.052 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_68_163_248_1019_1887_0.jpg
2025-08-08 16:56:55.052 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_235_1053_1153_960_0.jpg
2025-08-08 16:56:55.053 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_257_392_1118_414_0.jpg
2025-08-08 16:56:55.053 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_227_383_1163_510_0.jpg
2025-08-08 16:56:55.053 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_234_1152_1146_503_0.jpg
2025-08-08 16:56:55.053 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_71_416_1374_824_646_0.jpg
2025-08-08 16:56:55.053 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_73_362_1146_917_618_0.jpg
2025-08-08 16:56:55.053 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_74_573_1274_462_123_0.jpg
2025-08-08 16:56:55.054 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_76_248_1224_1104_782_0.jpg
2025-08-08 16:56:55.054 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_78_242_276_1113_842_0.jpg
2025-08-08 16:56:55.054 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_80_347_280_898_515_0.jpg
2025-08-08 16:56:55.054 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_86_210_747_1187_915_0.jpg
2025-08-08 16:56:55.054 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_87_238_256_1180_936_0.jpg
2025-08-08 16:56:55.054 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_91_256_269_1156_955_0.jpg
2025-08-08 16:56:55.055 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_232_301_1140_940_0.jpg
2025-08-08 16:56:55.055 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_233_1466_1147_602_0.jpg
2025-08-08 16:56:55.055 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_93_324_268_737_1834_0.jpg
2025-08-08 16:56:55.059 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_361_435_977_304_0.jpg
2025-08-08 16:56:55.060 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_616_930_468_258_0.jpg
2025-08-08 16:56:55.060 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_287_1114_1128_645_0.jpg
2025-08-08 16:56:55.060 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_304_320_1113_638_0.jpg
2025-08-08 16:56:55.060 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_214_315_1133_645_0.jpg
2025-08-08 16:56:55.060 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_220_1122_1142_645_0.jpg
2025-08-08 16:56:55.061 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_287_1119_1136_651_0.jpg
2025-08-08 16:56:55.061 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_299_324_1134_642_0.jpg
2025-08-08 16:56:55.061 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_203_320_1145_655_0.jpg
2025-08-08 16:56:55.061 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_227_1129_1130_645_0.jpg
2025-08-08 16:56:55.062 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_290_1126_1125_656_0.jpg
2025-08-08 16:56:55.062 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_306_322_1119_646_0.jpg
2025-08-08 16:56:55.062 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_212_221_1133_659_0.jpg
2025-08-08 16:56:55.062 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_225_1049_1127_636_0.jpg
2025-08-08 16:56:55.062 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_0_1237_154_289_162_0.jpg
2025-08-08 16:56:55.063 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_253_704_552_467_0.jpg
2025-08-08 16:56:55.063 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_884_684_459_455_0.jpg
2025-08-08 16:56:55.063 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_143_500_318_578_556_0.jpg
2025-08-08 16:56:55.063 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_146_315_228_1095_400_0.jpg
2025-08-08 16:56:55.063 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_150_286_250_1129_814_0.jpg
2025-08-08 16:56:55.064 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_248_725_1164_564_0.jpg
2025-08-08 16:56:55.064 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_388_215_897_435_0.jpg
2025-08-08 16:56:55.064 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_287_1311_1133_384_0.jpg
2025-08-08 16:56:55.064 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_70_393_948_902_341_0.jpg
2025-08-08 16:56:55.064 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_72_258_681_1160_1355_0.jpg
2025-08-08 16:56:55.065 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_75_240_362_1177_1656_0.jpg
2025-08-08 16:56:55.065 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_78_240_318_1168_1731_0.jpg
2025-08-08 16:56:55.065 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_81_248_343_1165_1687_0.jpg
2025-08-08 16:56:55.066 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_84_238_386_1162_1624_0.jpg
2025-08-08 16:56:55.066 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_86_239_653_1166_1338_0.jpg
2025-08-08 16:56:55.067 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_88_623_450_653_646_0.jpg
2025-08-08 16:56:55.067 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_90_238_296_1174_1720_0.jpg
2025-08-08 16:56:55.067 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_91_225_299_1187_1707_0.jpg
2025-08-08 16:56:55.068 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_94_257_289_1171_1697_0.jpg
2025-08-08 16:56:55.068 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_97_227_303_1170_1731_0.jpg
2025-08-08 16:56:55.068 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_101_225_672_1178_1353_0.jpg
2025-08-08 16:56:55.069 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_102_240_291_1203_1722_0.jpg
2025-08-08 16:56:55.069 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_103_240_297_1178_1734_0.jpg
2025-08-08 16:56:55.069 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_119_475_1184_667_691_0.jpg
2025-08-08 16:56:55.069 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_121_593_1023_425_178_0.jpg
2025-08-08 16:56:55.070 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_122_444_294_775_206_0.jpg
2025-08-08 16:56:55.070 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_413_902_778_279_0.jpg
2025-08-08 16:56:55.071 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_419_1314_768_347_0.jpg
2025-08-08 16:56:55.071 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_126_387_330_904_455_0.jpg
2025-08-08 16:56:55.072 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_129_362_691_912_684_0.jpg
2025-08-08 16:56:55.072 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_137_501_1634_612_391_0.jpg
2025-08-08 16:56:55.073 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_138_536_226_623_387_0.jpg
2025-08-08 16:56:55.073 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_177_316_1559_1037_507_0.jpg
2025-08-08 16:56:55.073 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_187_373_890_922_309_0.jpg
2025-08-08 16:56:55.073 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_389_874_879_339_0.jpg
2025-08-08 16:56:55.073 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_509_232_635_564_0.jpg
2025-08-08 16:56:55.074 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_514_1307_644_653_0.jpg
2025-08-08 16:56:55.074 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_318_1309_1020_458_0.jpg
2025-08-08 16:56:55.074 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_397_458_892_388_0.jpg
2025-08-08 16:56:55.074 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_539_1403_583_424_0.jpg
2025-08-08 16:56:55.075 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_194_438_645_754_434_0.jpg
2025-08-08 16:56:55.075 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_365_222_908_608_0.jpg
2025-08-08 16:56:55.075 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_385_1267_869_447_0.jpg
2025-08-08 16:56:55.075 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_206_501_795_660_1153_0.jpg
2025-08-08 16:56:55.075 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_208_581_1522_499_443_0.jpg
2025-08-08 16:56:55.076 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_209_536_235_551_971_0.jpg
2025-08-08 16:56:55.076 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_210_246_516_270_300_0.jpg
2025-08-08 16:56:55.076 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_128_411_445_833_494_0.jpg
2025-08-08 16:56:55.076 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_428_384_769_490_0.jpg
2025-08-08 16:56:55.076 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_49_529_271_627_470_0.jpg
2025-08-08 16:56:55.076 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_66_257_325_1140_552_0.jpg
2025-08-08 16:56:55.077 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_1090_878_289_229_0.jpg
2025-08-08 16:56:55.077 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_432_894_219_206_0.jpg
2025-08-08 16:56:55.077 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_728_895_247_200_0.jpg
2025-08-08 16:56:55.077 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1095_623_266_169_0.jpg
2025-08-08 16:56:55.077 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1141_832_201_101_0.jpg
2025-08-08 16:56:55.078 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_444_641_235_139_0.jpg
2025-08-08 16:56:55.078 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_459_831_166_104_0.jpg
2025-08-08 16:56:55.078 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_724_603_276_178_0.jpg
2025-08-08 16:56:55.078 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_747_821_223_122_0.jpg
2025-08-08 16:56:55.087 | INFO     | database.document_service:full_scan:327 - 正在扫描 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-08 16:56:55.087 | INFO     | database.document_service:full_scan:332 - 全量扫描完成，共处理文件数: 1581
2025-08-08 16:56:55.087 | DEBUG    | database.document_service:_start_watchdog:335 - 启动文件监控 Watchdog
2025-08-08 16:56:55.088 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 16:56:55.088 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-08 16:56:55.088 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-08 16:56:55.107 | INFO     | database.document_service:_start_watchdog:423 - Watchdog 已启动
2025-08-08 16:56:55.107 | INFO     | database.document_service:start:465 - DocumentQueryService 已启动
2025-08-08 16:56:55.107 | INFO     | __main__:combined_lifespan:83 - 统一文档查询服务 (DocumentQueryService) 已启动。
2025-08-08 16:56:55.107 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/Projects1', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-08 16:56:55.108 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/规程规范', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-08 16:56:55.108 | INFO     | __main__:combined_lifespan:88 - 项目和规程的文件服务已初始化。
2025-08-08 16:56:55.109 | INFO     | __main__:combined_lifespan:93 - AsyncIOScheduler 已实例化并注册到 app_state。
2025-08-08 16:56:55.109 | INFO     | __main__:combined_lifespan:97 - FastMCP lifespan context entered.
2025-08-08 16:56:55.110 | INFO     | __main__:combined_lifespan:117 - 处理不活动用户会话任务已添加到APScheduler (每 60s)。
2025-08-08 16:56:55.110 | INFO     | __main__:combined_lifespan:120 - 清理用户会话中已打开文件token任务已添加到APScheduler (每 120s)。
2025-08-08 16:56:55.110 | INFO     | __main__:combined_lifespan:123 - APScheduler 调度器已启动。
2025-08-08 16:56:55.110 | INFO     | __main__:combined_lifespan:124 - 所有初始化完成... yield
2025-08-08 16:56:55.110 | DEBUG    | database.document_service:_debounced_update_loop:426 - 启动去抖更新循环
2025-08-08 16:57:49.681 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: 6c10fa02-6889-4f21-82ce-478ef8f80df5, IP: 127.0.0.1) 登录/状态更新成功。
2025-08-08 16:57:49.682 | INFO     | api.route:login:69 - 用户 'admin' (IP: 127.0.0.1, Session: 6c10fa02-6889-4f21-82ce-478ef8f80df5) 登录成功。
2025-08-08 16:57:49.744 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 6c10fa02-6889-4f21-82ce-478ef8f80df5) 的 WebSocket 已连接并关联。
2025-08-08 16:57:49.824 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-08 16:57:51.624 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 16:57:54.090 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 16:57:58.535 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 16:57:59.177 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 16:58:05.397 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 16:58:05.398 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: http://[240e:3a1:7d0:ab80::e7]:1234/v1
2025-08-08 16:58:05.398 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: openai/gpt-oss-20b
2025-08-08 16:58:05.401 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 16:58:07.726 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: c7a4c302-31f0-4db2-966c-8b372fa0d4b7。清空历史记录。
2025-08-08 16:58:19.179 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 16:58:19.179 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 6c10fa02-6889-4f21-82ce-478ef8f80df5, 对话ID: c7a4c302-31f0-4db2-966c-8b372fa0d4b7, 查询: 打开丹华的项目
2025-08-08 16:58:19.180 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:58:21.334 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '15', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"丹华","year":null}'}}]
2025-08-08 16:58:21.334 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"丹华","year":null}
2025-08-08 16:58:21.379 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='丹华', 年份='None'
2025-08-08 16:58:21.379 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 16:58:21.392 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['丹华初设']
2025-08-08 16:58:21.392 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '丹华初设'
2025-08-08 16:58:21.393 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '丹华初设']
2025-08-08 16:58:21.395 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '丹华初设'，包含 153 个文件。
2025-08-08 16:58:21.396 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 16:58:21.405 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:58:57.923 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 16:58:57.923 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 6c10fa02-6889-4f21-82ce-478ef8f80df5, 对话ID: c7a4c302-31f0-4db2-966c-8b372fa0d4b7, 查询: 帮我打开评审意见和六助扩建工程 的材料清册
2025-08-08 16:58:57.923 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:59:04.282 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '71', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx","file_category":"普通文档"}'}}]
2025-08-08 16:59:04.283 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx","file_category":"普通文档"}
2025-08-08 16:59:04.329 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx', Category: '普通文档'
2025-08-08 16:59:04.329 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx (相对路径: 2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx)，分隔符: '	'
2025-08-08 16:59:04.579 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: (01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx, 内容长度: 30148
2025-08-08 16:59:04.580 | INFO     | my_mcp_tools.mcp_tools:read_project_file:706 - 从文件 2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx成功读取（预览100字）:

江苏泰州丹华110kV输变电工程初步设计评审意见

根据国网江苏省电力有限公司建设部初步设计评审计划安排及委托，国网江苏电力设计咨询有限公司于4月24日下午14:00开始，会期半天；开展了江苏泰州
2025-08-08 16:59:04.580 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx' (token: dc8e9642676241178d27432044b8fd1e), 有效期至: Sat Aug  9 00:59:04 2025
2025-08-08 16:59:04.580 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx' 已在会话中注册, token: dc8e9642676241178d27432044b8fd1e
2025-08-08 16:59:04.587 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/dc8e9642676241178d27432044b8fd1e/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx
2025-08-08 16:59:04.596 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:59:04.600 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）_fad56a22.docx' 与Token关联文件名 '(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx' 不匹配。将使用Token关联文件名。
2025-08-08 16:59:04.601 | DEBUG    | api.route:download_file_via_token:186 - Token 'dc8e9642676241178d27432044b8fd1e' 验证成功。准备下载文件: '(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/丹华初设/收口/(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）.docx', URL文件名: '(01)(01)工程评审意见_江苏泰州丹华110kV输变电工程（汇总）_fad56a22.docx')
2025-08-08 16:59:40.925 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 16:59:40.925 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 6c10fa02-6889-4f21-82ce-478ef8f80df5, 对话ID: c7a4c302-31f0-4db2-966c-8b372fa0d4b7, 查询: 再打开六助的清册
2025-08-08 16:59:40.925 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 16:59:59.105 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '86', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"六助","year":null}'}}]
2025-08-08 16:59:59.105 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"六助","year":null}
2025-08-08 16:59:59.153 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='六助', 年份='None'
2025-08-08 16:59:59.153 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 16:59:59.163 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 0 个项目: []
2025-08-08 16:59:59.164 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:785 - 使用向量检索辅助判断，候选项目数: 18
2025-08-08 16:59:59.164 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 16:59:59.374 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-3 结果: [('示例项目', 0.2921536555990365), ('扬州品祚扩主变', 0.28254024172558717), ('东余变主变扩建工程', 0.27619136957150575)]
2025-08-08 16:59:59.380 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 17:00:17.578 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '107', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"六助220kV变电站","year":null}'}}]
2025-08-08 17:00:17.578 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"六助220kV变电站","year":null}
2025-08-08 17:00:17.619 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='六助220kV变电站', 年份='None'
2025-08-08 17:00:17.620 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 17:00:17.630 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 0 个项目: []
2025-08-08 17:00:17.630 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:785 - 使用向量检索辅助判断，候选项目数: 18
2025-08-08 17:00:17.630 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 17:00:17.829 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-3 结果: [('1-无锡石园220千伏变电站第二台主变扩建工程', 0.6060948230474517), ('江苏扬州秀清220千伏变电站110千伏送出工程', 0.5825883904168423), ('南京姚庄110千伏变电站改造工程', 0.5587758279072408)]
2025-08-08 17:00:17.829 | INFO     | my_mcp_tools.mcp_tools:query_project_files:791 - 向量检索匹配top1项目: '1-无锡石园220千伏变电站第二台主变扩建工程'
2025-08-08 17:00:17.830 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '1-无锡石园220千伏变电站第二台主变扩建工程']
2025-08-08 17:00:17.831 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '1-无锡石园220千伏变电站第二台主变扩建工程'，包含 55 个文件。
2025-08-08 17:00:17.832 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 17:00:17.839 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 17:02:39.027 | DEBUG    | sse_proxy.sse2websocket1:run:304 - WebSocket 会话 6c10fa02-6889-4f21-82ce-478ef8f80df5 用户 admin 断开连接
2025-08-08 17:02:39.027 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 17:02:39.027 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 17:02:39.128 | INFO     | __main__:combined_lifespan:130 - COMBINED LIFESPAN END - PID: 114748 - 服务器关闭中...
2025-08-08 17:02:39.128 | INFO     | database.document_service:shutdown:469 - 正在关闭 DocumentQueryService...
2025-08-08 17:02:39.136 | INFO     | database.document_service:shutdown:474 - Watchdog 监控已停止。
2025-08-08 17:02:39.136 | INFO     | database.document_service:shutdown:482 - 后台更新任务已取消。
2025-08-08 17:02:39.136 | INFO     | database.document_service:shutdown:487 - 数据库连接已关闭。
2025-08-08 17:02:39.136 | INFO     | database.document_service:shutdown:489 - DocumentQueryService 已成功关闭。
2025-08-08 17:02:39.136 | INFO     | __main__:combined_lifespan:134 - 统一文档查询服务已关闭。
2025-08-08 17:02:39.136 | INFO     | __main__:combined_lifespan:139 - APScheduler 调度器已关闭。
2025-08-08 17:02:39.137 | INFO     | __main__:combined_lifespan:140 - Custom application resources cleaned up.
2025-08-08 17:02:43.202 | INFO     | __main__:<module>:35 - Loguru 日志系统已初始化。
2025-08-08 17:02:43.202 | INFO     | __main__:<module>:36 - 项目根目录配置为: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 17:02:43.202 | INFO     | __main__:<module>:37 - 数据库路径配置为: data/document_service.db
2025-08-08 17:02:43.202 | INFO     | __main__:<module>:38 - 表格列读取配置已加载: {'变电站安装工程概算表': (2, 6), '变电站建筑工程概算表': (2, 6), '电缆输电线路安装工程概算表': (2, 6), '电缆输电线路建筑工程概算表': (2, 6)}
2025-08-08 17:02:43.202 | INFO     | __main__:<module>:39 - kkFileView 服务地址配置为: http://127.0.0.1:8012/kkfileview
2025-08-08 17:02:43.202 | INFO     | __main__:<module>:42 - Dify Agent API Key: ********kGHe
2025-08-08 17:02:43.202 | INFO     | __main__:<module>:43 - Session Secret Key: ********7929
2025-08-08 17:02:43.202 | INFO     | __main__:<module>:44 - 服务器ipv6地址为: http://[240e:479:668:3c1c:b5dc:e5a6:a573:f7a9]:8888
2025-08-08 17:02:43.203 | INFO     | __main__:<module>:151 - FastAPI 应用已实例化并注册到 app_state。
2025-08-08 17:02:43.203 | INFO     | __main__:<module>:154 - CORS中间件已添加，允许所有来源。
2025-08-08 17:02:43.214 | INFO     | __main__:<module>:174 - MCP 服务器 '项目文件检索服务器' 已挂载到 FastAPI 应用的 '/mcp/' 路径。
2025-08-08 17:02:43.230 | INFO     | __main__:combined_lifespan:64 - COMBINED LIFESPAN START - PID: 123922 - 服务器启动中...
2025-08-08 17:02:43.266 | INFO     | __main__:combined_lifespan:69 - HTTPX 客户端已创建并注册到 app_state。
2025-08-08 17:02:43.266 | INFO     | utils.utils:check_embedding_service_health:28 - 正在检查嵌入模型服务，目标URL: http://127.0.0.1:8001/v1/models
2025-08-08 17:02:43.273 | INFO     | utils.utils:check_embedding_service_health:37 - 嵌入模型服务可用，模型列表: ['/home/zhouxiang/models/BAAI_bge-m3']
2025-08-08 17:02:43.273 | INFO     | core.session:__init__:79 - SessionStateManager已初始化。整体HTTP不活动超时: 3600秒
2025-08-08 17:02:43.273 | INFO     | __main__:combined_lifespan:77 - SessionStateManager 已实例化并注册到 app_state。
2025-08-08 17:02:43.273 | INFO     | database.document_service:__init__:164 - 有效文档根目录: {'项目文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/Projects1'), '规范文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/规程规范'), '管理文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/管理文件')}
2025-08-08 17:02:43.273 | DEBUG    | database.document_service:_init_db:180 - 初始化数据库
2025-08-08 17:02:43.273 | DEBUG    | database.document_service:_init_db:201 - 数据库初始化完成
2025-08-08 17:02:43.273 | INFO     | database.document_service:__init__:177 - DocumentQueryService 初始化完成
2025-08-08 17:02:43.274 | INFO     | database.document_service:full_scan:324 - 开始全量扫描...
2025-08-08 17:02:43.274 | INFO     | database.document_service:full_scan:327 - 正在扫描 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 17:02:48.667 | INFO     | database.document_service:full_scan:327 - 正在扫描 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-08 17:02:48.885 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_12_479_254_639_268_0.jpg
2025-08-08 17:02:48.885 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_19_1142_1062_132_174_0.jpg
2025-08-08 17:02:48.885 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_67_179_250_1020_1864_0.jpg
2025-08-08 17:02:48.886 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_68_163_248_1019_1887_0.jpg
2025-08-08 17:02:48.886 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_235_1053_1153_960_0.jpg
2025-08-08 17:02:48.886 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_257_392_1118_414_0.jpg
2025-08-08 17:02:48.886 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_227_383_1163_510_0.jpg
2025-08-08 17:02:48.886 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_234_1152_1146_503_0.jpg
2025-08-08 17:02:48.887 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_71_416_1374_824_646_0.jpg
2025-08-08 17:02:48.887 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_73_362_1146_917_618_0.jpg
2025-08-08 17:02:48.887 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_74_573_1274_462_123_0.jpg
2025-08-08 17:02:48.887 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_76_248_1224_1104_782_0.jpg
2025-08-08 17:02:48.887 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_78_242_276_1113_842_0.jpg
2025-08-08 17:02:48.888 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_80_347_280_898_515_0.jpg
2025-08-08 17:02:48.888 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_86_210_747_1187_915_0.jpg
2025-08-08 17:02:48.888 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_87_238_256_1180_936_0.jpg
2025-08-08 17:02:48.888 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_91_256_269_1156_955_0.jpg
2025-08-08 17:02:48.888 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_232_301_1140_940_0.jpg
2025-08-08 17:02:48.888 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_233_1466_1147_602_0.jpg
2025-08-08 17:02:48.889 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_93_324_268_737_1834_0.jpg
2025-08-08 17:02:48.892 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_361_435_977_304_0.jpg
2025-08-08 17:02:48.893 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_616_930_468_258_0.jpg
2025-08-08 17:02:48.893 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_287_1114_1128_645_0.jpg
2025-08-08 17:02:48.893 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_304_320_1113_638_0.jpg
2025-08-08 17:02:48.893 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_214_315_1133_645_0.jpg
2025-08-08 17:02:48.893 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_220_1122_1142_645_0.jpg
2025-08-08 17:02:48.893 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_287_1119_1136_651_0.jpg
2025-08-08 17:02:48.894 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_299_324_1134_642_0.jpg
2025-08-08 17:02:48.894 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_203_320_1145_655_0.jpg
2025-08-08 17:02:48.894 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_227_1129_1130_645_0.jpg
2025-08-08 17:02:48.894 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_290_1126_1125_656_0.jpg
2025-08-08 17:02:48.894 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_306_322_1119_646_0.jpg
2025-08-08 17:02:48.894 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_212_221_1133_659_0.jpg
2025-08-08 17:02:48.895 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_225_1049_1127_636_0.jpg
2025-08-08 17:02:48.895 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_0_1237_154_289_162_0.jpg
2025-08-08 17:02:48.895 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_253_704_552_467_0.jpg
2025-08-08 17:02:48.895 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_884_684_459_455_0.jpg
2025-08-08 17:02:48.895 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_143_500_318_578_556_0.jpg
2025-08-08 17:02:48.895 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_146_315_228_1095_400_0.jpg
2025-08-08 17:02:48.896 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_150_286_250_1129_814_0.jpg
2025-08-08 17:02:48.896 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_248_725_1164_564_0.jpg
2025-08-08 17:02:48.896 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_388_215_897_435_0.jpg
2025-08-08 17:02:48.896 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_287_1311_1133_384_0.jpg
2025-08-08 17:02:48.896 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_70_393_948_902_341_0.jpg
2025-08-08 17:02:48.896 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_72_258_681_1160_1355_0.jpg
2025-08-08 17:02:48.896 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_75_240_362_1177_1656_0.jpg
2025-08-08 17:02:48.897 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_78_240_318_1168_1731_0.jpg
2025-08-08 17:02:48.897 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_81_248_343_1165_1687_0.jpg
2025-08-08 17:02:48.897 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_84_238_386_1162_1624_0.jpg
2025-08-08 17:02:48.897 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_86_239_653_1166_1338_0.jpg
2025-08-08 17:02:48.897 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_88_623_450_653_646_0.jpg
2025-08-08 17:02:48.897 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_90_238_296_1174_1720_0.jpg
2025-08-08 17:02:48.898 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_91_225_299_1187_1707_0.jpg
2025-08-08 17:02:48.898 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_94_257_289_1171_1697_0.jpg
2025-08-08 17:02:48.898 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_97_227_303_1170_1731_0.jpg
2025-08-08 17:02:48.898 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_101_225_672_1178_1353_0.jpg
2025-08-08 17:02:48.898 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_102_240_291_1203_1722_0.jpg
2025-08-08 17:02:48.898 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_103_240_297_1178_1734_0.jpg
2025-08-08 17:02:48.898 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_119_475_1184_667_691_0.jpg
2025-08-08 17:02:48.899 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_121_593_1023_425_178_0.jpg
2025-08-08 17:02:48.899 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_122_444_294_775_206_0.jpg
2025-08-08 17:02:48.899 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_413_902_778_279_0.jpg
2025-08-08 17:02:48.899 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_419_1314_768_347_0.jpg
2025-08-08 17:02:48.899 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_126_387_330_904_455_0.jpg
2025-08-08 17:02:48.899 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_129_362_691_912_684_0.jpg
2025-08-08 17:02:48.900 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_137_501_1634_612_391_0.jpg
2025-08-08 17:02:48.900 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_138_536_226_623_387_0.jpg
2025-08-08 17:02:48.900 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_177_316_1559_1037_507_0.jpg
2025-08-08 17:02:48.900 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_187_373_890_922_309_0.jpg
2025-08-08 17:02:48.900 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_389_874_879_339_0.jpg
2025-08-08 17:02:48.900 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_509_232_635_564_0.jpg
2025-08-08 17:02:48.901 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_514_1307_644_653_0.jpg
2025-08-08 17:02:48.901 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_318_1309_1020_458_0.jpg
2025-08-08 17:02:48.901 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_397_458_892_388_0.jpg
2025-08-08 17:02:48.901 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_539_1403_583_424_0.jpg
2025-08-08 17:02:48.901 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_194_438_645_754_434_0.jpg
2025-08-08 17:02:48.901 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_365_222_908_608_0.jpg
2025-08-08 17:02:48.901 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_385_1267_869_447_0.jpg
2025-08-08 17:02:48.902 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_206_501_795_660_1153_0.jpg
2025-08-08 17:02:48.902 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_208_581_1522_499_443_0.jpg
2025-08-08 17:02:48.902 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_209_536_235_551_971_0.jpg
2025-08-08 17:02:48.902 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_210_246_516_270_300_0.jpg
2025-08-08 17:02:48.902 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_128_411_445_833_494_0.jpg
2025-08-08 17:02:48.902 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_428_384_769_490_0.jpg
2025-08-08 17:02:48.903 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_49_529_271_627_470_0.jpg
2025-08-08 17:02:48.903 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_66_257_325_1140_552_0.jpg
2025-08-08 17:02:48.903 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_1090_878_289_229_0.jpg
2025-08-08 17:02:48.903 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_432_894_219_206_0.jpg
2025-08-08 17:02:48.903 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_728_895_247_200_0.jpg
2025-08-08 17:02:48.904 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1095_623_266_169_0.jpg
2025-08-08 17:02:48.904 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1141_832_201_101_0.jpg
2025-08-08 17:02:48.904 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_444_641_235_139_0.jpg
2025-08-08 17:02:48.904 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_459_831_166_104_0.jpg
2025-08-08 17:02:48.904 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_724_603_276_178_0.jpg
2025-08-08 17:02:48.904 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_747_821_223_122_0.jpg
2025-08-08 17:02:48.912 | INFO     | database.document_service:full_scan:327 - 正在扫描 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-08 17:02:48.912 | INFO     | database.document_service:full_scan:332 - 全量扫描完成，共处理文件数: 1581
2025-08-08 17:02:48.913 | DEBUG    | database.document_service:_start_watchdog:335 - 启动文件监控 Watchdog
2025-08-08 17:02:48.913 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 17:02:48.913 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-08 17:02:48.913 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-08 17:02:48.931 | INFO     | database.document_service:_start_watchdog:423 - Watchdog 已启动
2025-08-08 17:02:48.931 | INFO     | database.document_service:start:465 - DocumentQueryService 已启动
2025-08-08 17:02:48.931 | INFO     | __main__:combined_lifespan:83 - 统一文档查询服务 (DocumentQueryService) 已启动。
2025-08-08 17:02:48.931 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/Projects1', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-08 17:02:48.932 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/规程规范', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-08 17:02:48.932 | INFO     | __main__:combined_lifespan:88 - 项目和规程的文件服务已初始化。
2025-08-08 17:02:48.933 | INFO     | __main__:combined_lifespan:93 - AsyncIOScheduler 已实例化并注册到 app_state。
2025-08-08 17:02:48.933 | INFO     | __main__:combined_lifespan:97 - FastMCP lifespan context entered.
2025-08-08 17:02:48.933 | INFO     | __main__:combined_lifespan:117 - 处理不活动用户会话任务已添加到APScheduler (每 60s)。
2025-08-08 17:02:48.934 | INFO     | __main__:combined_lifespan:120 - 清理用户会话中已打开文件token任务已添加到APScheduler (每 120s)。
2025-08-08 17:02:48.934 | INFO     | __main__:combined_lifespan:123 - APScheduler 调度器已启动。
2025-08-08 17:02:48.934 | INFO     | __main__:combined_lifespan:124 - 所有初始化完成... yield
2025-08-08 17:02:48.934 | DEBUG    | database.document_service:_debounced_update_loop:426 - 启动去抖更新循环
2025-08-08 17:02:52.590 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: 2646f2e9-9da8-47c0-9c11-67863be42aad, IP: 127.0.0.1) 登录/状态更新成功。
2025-08-08 17:02:52.591 | INFO     | api.route:login:69 - 用户 'admin' (IP: 127.0.0.1, Session: 2646f2e9-9da8-47c0-9c11-67863be42aad) 登录成功。
2025-08-08 17:02:52.683 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 2646f2e9-9da8-47c0-9c11-67863be42aad) 的 WebSocket 已连接并关联。
2025-08-08 17:02:52.770 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-08 17:02:54.461 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 17:02:54.893 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 17:02:56.215 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 17:03:01.028 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 17:03:01.029 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: http://[240e:3a1:7d0:ab80::e7]:1234/v1
2025-08-08 17:03:01.029 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: openai/gpt-oss-20b
2025-08-08 17:03:01.032 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 17:03:05.567 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 8e4520a3-cb03-41f7-bf63-b00499d46f64。清空历史记录。
2025-08-08 17:03:13.282 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 17:03:13.282 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2646f2e9-9da8-47c0-9c11-67863be42aad, 对话ID: 8e4520a3-cb03-41f7-bf63-b00499d46f64, 查询: 打开六助项目
2025-08-08 17:03:13.282 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 17:03:15.216 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '15', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"六助","year":null}'}}]
2025-08-08 17:03:15.216 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"六助","year":null}
2025-08-08 17:03:15.261 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='六助', 年份='None'
2025-08-08 17:03:15.262 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 17:03:15.274 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 0 个项目: []
2025-08-08 17:03:15.274 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:785 - 使用向量检索辅助判断，候选项目数: 18
2025-08-08 17:03:15.274 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 17:03:15.467 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-3 结果: [('示例项目', 0.2921536555990365), ('扬州品祚扩主变', 0.28254024172558717), ('东余变主变扩建工程', 0.27619136957150575)]
2025-08-08 17:03:15.473 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 17:03:34.153 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 17:03:34.153 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2646f2e9-9da8-47c0-9c11-67863be42aad, 对话ID: 8e4520a3-cb03-41f7-bf63-b00499d46f64, 查询: 打开丹华项目
2025-08-08 17:03:34.153 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 17:03:34.993 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '30', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"丹华","year":null}'}}]
2025-08-08 17:03:34.994 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"丹华","year":null}
2025-08-08 17:03:35.039 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='丹华', 年份='None'
2025-08-08 17:03:35.039 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 17:03:35.049 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['丹华初设']
2025-08-08 17:03:35.050 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '丹华初设'
2025-08-08 17:03:35.050 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '丹华初设']
2025-08-08 17:03:35.052 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '丹华初设'，包含 153 个文件。
2025-08-08 17:03:35.054 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 17:03:35.062 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 17:03:56.433 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 17:03:56.433 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2646f2e9-9da8-47c0-9c11-67863be42aad, 对话ID: 8e4520a3-cb03-41f7-bf63-b00499d46f64, 查询: 读取六助的材料清册
2025-08-08 17:03:56.433 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 17:03:57.800 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '45', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"六助","year":null}'}}]
2025-08-08 17:03:57.800 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"六助","year":null}
2025-08-08 17:03:57.844 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='六助', 年份='None'
2025-08-08 17:03:57.845 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 17:03:57.857 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 0 个项目: []
2025-08-08 17:03:57.857 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:785 - 使用向量检索辅助判断，候选项目数: 18
2025-08-08 17:03:57.857 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 17:03:58.053 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-3 结果: [('示例项目', 0.2921536555990365), ('扬州品祚扩主变', 0.28254024172558717), ('东余变主变扩建工程', 0.27619136957150575)]
2025-08-08 17:03:58.059 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 17:04:33.757 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 17:04:33.757 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2646f2e9-9da8-47c0-9c11-67863be42aad, 对话ID: 8e4520a3-cb03-41f7-bf63-b00499d46f64, 查询: 告诉我你的上下文里 有丹华的文件吗
2025-08-08 17:04:33.757 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 17:05:10.994 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 17:05:10.994 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2646f2e9-9da8-47c0-9c11-67863be42aad, 对话ID: 8e4520a3-cb03-41f7-bf63-b00499d46f64, 查询: 找里面的六助改造工程里的材料清册
2025-08-08 17:05:10.994 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 17:05:14.182 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '118', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)泰州丹华110千伏变电站110千伏间隔改造工程收口版/六助220千伏变电站110千伏间隔改造主要设备材料清册.pdf","file_category":"普通文档"}'}}]
2025-08-08 17:05:14.183 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)泰州丹华110千伏变电站110千伏间隔改造工程收口版/六助220千伏变电站110千伏间隔改造主要设备材料清册.pdf","file_category":"普通文档"}
2025-08-08 17:05:14.227 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2025/丹华初设/收口/(01)泰州丹华110千伏变电站110千伏间隔改造工程收口版/六助220千伏变电站110千伏间隔改造主要设备材料清册.pdf', Category: '普通文档'
2025-08-08 17:05:14.227 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/2025/丹华初设/收口/(01)泰州丹华110千伏变电站110千伏间隔改造工程收口版/六助220千伏变电站110千伏间隔改造主要设备材料清册.pdf
2025-08-08 17:05:14.232 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 17:05:28.309 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 17:05:28.309 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2646f2e9-9da8-47c0-9c11-67863be42aad, 对话ID: 8e4520a3-cb03-41f7-bf63-b00499d46f64, 查询: 检查你的 路径
2025-08-08 17:05:28.310 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:openai/gpt-oss-20b
2025-08-08 17:06:03.322 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 17:06:03.322 | INFO     | api.admin:update_admin_config:164 - 从服务商 'gemini' 的预设中加载了 API Key。
2025-08-08 17:06:03.322 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: https://generativelanguage.googleapis.com/v1beta/openai/
2025-08-08 17:06:03.322 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: gemini-2.5-flash
2025-08-08 17:06:03.322 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******WIKw
2025-08-08 17:06:03.326 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 17:06:08.598 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: dc5231b6-3d66-4afe-8d16-9e9223ce876b。清空历史记录。
2025-08-08 17:06:23.229 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 17:06:23.230 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2646f2e9-9da8-47c0-9c11-67863be42aad, 对话ID: dc5231b6-3d66-4afe-8d16-9e9223ce876b, 查询: 帮我打开丹华项目
2025-08-08 17:06:23.230 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:gemini-2.5-flash
2025-08-08 17:06:39.677 | ERROR    | sse_proxy.sse2websocket1:_handle_stream:137 - 调用OpenAI API失败: Request timed out.
2025-08-08 17:07:06.113 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 17:07:06.114 | INFO     | api.admin:update_admin_config:164 - 从服务商 'tencent' 的预设中加载了 API Key。
2025-08-08 17:07:06.114 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: https://api.hunyuan.cloud.tencent.com/v1
2025-08-08 17:07:06.114 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: hunyuan-t1-20250711
2025-08-08 17:07:06.114 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******zI0G
2025-08-08 17:07:06.125 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 17:07:13.547 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 25ff5945-7cb2-41e2-b6c1-efe56015092e。清空历史记录。
2025-08-08 17:07:15.023 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 17:07:15.023 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2646f2e9-9da8-47c0-9c11-67863be42aad, 对话ID: 25ff5945-7cb2-41e2-b6c1-efe56015092e, 查询: 帮我打开丹华项目
2025-08-08 17:07:15.023 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:hunyuan-t1-20250711
2025-08-08 17:07:26.116 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_d2arsjc2c3mba98tq6t0', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"project_name":"丹华项目","user":"admin","year":"2024"}'}}]
2025-08-08 17:07:26.116 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"project_name":"丹华项目","user":"admin","year":"2024"}
2025-08-08 17:07:26.176 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='丹华项目', 年份='2024'
2025-08-08 17:07:26.176 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.year') = ? with params: ['项目文件', '2024']
2025-08-08 17:07:26.182 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 0 个项目: []
2025-08-08 17:07:26.182 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:785 - 使用向量检索辅助判断，候选项目数: 9
2025-08-08 17:07:26.182 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 17:07:26.320 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-3 结果: [('示例项目', 0.4810217624623308), ('盐城滨海润电200兆瓦渔林光互补光伏发电项目110千伏送出工程', 0.4284191055966332), ('白衣河输变电工程初设收口版', 0.39156543334664684)]
2025-08-08 17:07:26.326 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:hunyuan-t1-20250711
2025-08-08 17:08:35.104 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 17:08:35.104 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2646f2e9-9da8-47c0-9c11-67863be42aad, 对话ID: 25ff5945-7cb2-41e2-b6c1-efe56015092e, 查询: 使用丹华搜索
2025-08-08 17:08:35.104 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:hunyuan-t1-20250711
2025-08-08 17:08:47.396 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_d2art7s2c3m3pfvg36og', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"project_name":"丹华","user":"admin","year":"2024"}'}}]
2025-08-08 17:08:47.396 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"project_name":"丹华","user":"admin","year":"2024"}
2025-08-08 17:08:47.444 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='丹华', 年份='2024'
2025-08-08 17:08:47.444 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.year') = ? with params: ['项目文件', '2024']
2025-08-08 17:08:47.451 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 0 个项目: []
2025-08-08 17:08:47.452 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:785 - 使用向量检索辅助判断，候选项目数: 9
2025-08-08 17:08:47.452 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 17:08:47.591 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-3 结果: [('盐城滨海润电200兆瓦渔林光互补光伏发电项目110千伏送出工程', 0.29341091712818057), ('示例项目', 0.24679097141562215), ('白衣河输变电工程初设收口版', 0.24251025502251283)]
2025-08-08 17:08:47.598 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:hunyuan-t1-20250711
2025-08-08 17:09:07.818 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 17:09:07.819 | INFO     | api.admin:update_admin_config:164 - 从服务商 'deepseek' 的预设中加载了 API Key。
2025-08-08 17:09:07.819 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: https://api.deepseek.com
2025-08-08 17:09:07.819 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: deepseek-chat
2025-08-08 17:09:07.819 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******065f
2025-08-08 17:09:07.823 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '127.0.0.1'.
2025-08-08 17:09:14.201 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 268b3cf3-a15a-456d-9784-5a6c978a4181。清空历史记录。
2025-08-08 17:09:23.011 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 17:09:23.011 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2646f2e9-9da8-47c0-9c11-67863be42aad, 对话ID: 268b3cf3-a15a-456d-9784-5a6c978a4181, 查询: 帮我打开丹华项目
2025-08-08 17:09:23.011 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:deepseek-chat
2025-08-08 17:09:28.706 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '129', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user":"admin","project_name":"丹华"}'}}]
2025-08-08 17:09:28.706 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user":"admin","project_name":"丹华"}
2025-08-08 17:09:28.755 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='丹华', 年份='None'
2025-08-08 17:09:28.755 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 17:09:28.767 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['丹华初设']
2025-08-08 17:09:28.767 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '丹华初设'
2025-08-08 17:09:28.767 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '丹华初设']
2025-08-08 17:09:28.770 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '丹华初设'，包含 153 个文件。
2025-08-08 17:09:28.771 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 17:09:28.783 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:deepseek-chat
2025-08-08 17:10:21.028 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 17:10:21.028 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2646f2e9-9da8-47c0-9c11-67863be42aad, 对话ID: 268b3cf3-a15a-456d-9784-5a6c978a4181, 查询: 打开本体工程的给排水图
2025-08-08 17:10:21.028 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:deepseek-chat
2025-08-08 17:10:32.620 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': '220', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)泰州丹华110千伏输变电工程初步设计收口版/泰州丹华110千伏输变电工程初步设计收口版/丹华110千伏变电站新建工程收口版/[2023033-B3781C-A-49]室外给水总平面图.pdf","file_category":"图纸图形文档"}'}}]
2025-08-08 17:10:32.621 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user":"admin","relative_file_path":"2025/丹华初设/收口/(01)泰州丹华110千伏输变电工程初步设计收口版/泰州丹华110千伏输变电工程初步设计收口版/丹华110千伏变电站新建工程收口版/[2023033-B3781C-A-49]室外给水总平面图.pdf","file_category":"图纸图形文档"}
2025-08-08 17:10:32.670 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2025/丹华初设/收口/(01)泰州丹华110千伏输变电工程初步设计收口版/泰州丹华110千伏输变电工程初步设计收口版/丹华110千伏变电站新建工程收口版/[2023033-B3781C-A-49]室外给水总平面图.pdf', Category: '图纸图形文档'
2025-08-08 17:10:32.670 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:692 - 2025/丹华初设/收口/(01)泰州丹华110千伏输变电工程初步设计收口版/泰州丹华110千伏输变电工程初步设计收口版/丹华110千伏变电站新建工程收口版/[2023033-B3781C-A-49]室外给水总平面图.pdf 为llm暂不支持的文件类型。
2025-08-08 17:10:32.670 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2025/丹华初设/收口/(01)泰州丹华110千伏输变电工程初步设计收口版/泰州丹华110千伏输变电工程初步设计收口版/丹华110千伏变电站新建工程收口版/[2023033-B3781C-A-49]室外给水总平面图.pdf' (token: e540e6bb4f2e4138b937790a23633fd7), 有效期至: Sat Aug  9 01:10:32 2025
2025-08-08 17:10:32.670 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2025/丹华初设/收口/(01)泰州丹华110千伏输变电工程初步设计收口版/泰州丹华110千伏输变电工程初步设计收口版/丹华110千伏变电站新建工程收口版/[2023033-B3781C-A-49]室外给水总平面图.pdf' 已在会话中注册, token: e540e6bb4f2e4138b937790a23633fd7
2025-08-08 17:10:32.676 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:deepseek-chat
2025-08-08 17:10:32.680 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/e540e6bb4f2e4138b937790a23633fd7/[2023033-B3781C-A-49]室外给水总平面图.pdf
2025-08-08 17:10:32.913 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '[2023033-B3781C-A-49]室外给水总平面图_c8e9ea1d.pdf' 与Token关联文件名 '[2023033-B3781C-A-49]室外给水总平面图.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 17:10:32.914 | DEBUG    | api.route:download_file_via_token:186 - Token 'e540e6bb4f2e4138b937790a23633fd7' 验证成功。准备下载文件: '[2023033-B3781C-A-49]室外给水总平面图.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/丹华初设/收口/(01)泰州丹华110千伏输变电工程初步设计收口版/泰州丹华110千伏输变电工程初步设计收口版/丹华110千伏变电站新建工程收口版/[2023033-B3781C-A-49]室外给水总平面图.pdf', URL文件名: '[2023033-B3781C-A-49]室外给水总平面图_c8e9ea1d.pdf')
2025-08-08 17:10:32.916 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '[2023033-B3781C-A-49]室外给水总平面图_c8e9ea1d.pdf' 与Token关联文件名 '[2023033-B3781C-A-49]室外给水总平面图.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 17:10:32.916 | DEBUG    | api.route:download_file_via_token:186 - Token 'e540e6bb4f2e4138b937790a23633fd7' 验证成功。准备下载文件: '[2023033-B3781C-A-49]室外给水总平面图.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2025/丹华初设/收口/(01)泰州丹华110千伏输变电工程初步设计收口版/泰州丹华110千伏输变电工程初步设计收口版/丹华110千伏变电站新建工程收口版/[2023033-B3781C-A-49]室外给水总平面图.pdf', URL文件名: '[2023033-B3781C-A-49]室外给水总平面图_c8e9ea1d.pdf')
2025-08-08 17:10:56.494 | DEBUG    | core.session:logout_user:152 - 用户 'admin' (会话: 2646f2e9-9da8-47c0-9c11-67863be42aad) 已从状态管理器登出。
2025-08-08 17:10:56.494 | DEBUG    | core.session:logout_user:154 - 用户 'admin' 登出时，其WebSocket连接处于活动状态，将尝试关闭。
2025-08-08 17:10:56.495 | INFO     | api.route:logout:80 - HTTP会话已清除 (用户: admin)。
2025-08-08 17:10:56.495 | DEBUG    | sse_proxy.sse2websocket1:run:304 - WebSocket 会话 2646f2e9-9da8-47c0-9c11-67863be42aad 用户 admin 断开连接
2025-08-08 17:10:56.495 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 19:40:19.731 | INFO     | api.route:logout:80 - HTTP会话已清除 (用户: 未知)。
2025-08-08 19:40:21.338 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: 2198bd3c-11cd-4395-be40-61fd63b7ebcf, IP: 240e:3a1:7d0:ab80::e7) 登录/状态更新成功。
2025-08-08 19:40:21.338 | INFO     | api.route:login:69 - 用户 'admin' (IP: 240e:3a1:7d0:ab80::e7, Session: 2198bd3c-11cd-4395-be40-61fd63b7ebcf) 登录成功。
2025-08-08 19:40:21.510 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 2198bd3c-11cd-4395-be40-61fd63b7ebcf) 的 WebSocket 已连接并关联。
2025-08-08 19:40:21.588 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-08 20:13:41.773 | DEBUG    | sse_proxy.sse2websocket1:run:304 - WebSocket 会话 2198bd3c-11cd-4395-be40-61fd63b7ebcf 用户 admin 断开连接
2025-08-08 20:13:41.773 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 20:13:41.774 | INFO     | core.session:disconnect_websocket:108 - 用户 'admin' 的 WebSocket 已断开。
2025-08-08 20:13:41.875 | INFO     | __main__:combined_lifespan:130 - COMBINED LIFESPAN END - PID: 123922 - 服务器关闭中...
2025-08-08 20:13:41.875 | INFO     | database.document_service:shutdown:469 - 正在关闭 DocumentQueryService...
2025-08-08 20:13:41.882 | INFO     | database.document_service:shutdown:474 - Watchdog 监控已停止。
2025-08-08 20:13:41.882 | INFO     | database.document_service:shutdown:482 - 后台更新任务已取消。
2025-08-08 20:13:41.883 | INFO     | database.document_service:shutdown:487 - 数据库连接已关闭。
2025-08-08 20:13:41.884 | INFO     | database.document_service:shutdown:489 - DocumentQueryService 已成功关闭。
2025-08-08 20:13:41.884 | INFO     | __main__:combined_lifespan:134 - 统一文档查询服务已关闭。
2025-08-08 20:13:41.884 | INFO     | __main__:combined_lifespan:139 - APScheduler 调度器已关闭。
2025-08-08 20:13:41.884 | INFO     | __main__:combined_lifespan:140 - Custom application resources cleaned up.
2025-08-08 20:14:09.076 | INFO     | __main__:<module>:35 - Loguru 日志系统已初始化。
2025-08-08 20:14:09.077 | INFO     | __main__:<module>:36 - 项目根目录配置为: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 20:14:09.077 | INFO     | __main__:<module>:37 - 数据库路径配置为: data/document_service.db
2025-08-08 20:14:09.077 | INFO     | __main__:<module>:38 - 表格列读取配置已加载: {'变电站安装工程概算表': (2, 6), '变电站建筑工程概算表': (2, 6), '电缆输电线路安装工程概算表': (2, 6), '电缆输电线路建筑工程概算表': (2, 6)}
2025-08-08 20:14:09.077 | INFO     | __main__:<module>:39 - kkFileView 服务地址配置为: http://127.0.0.1:8012/kkfileview
2025-08-08 20:14:09.077 | INFO     | __main__:<module>:42 - Dify Agent API Key: ********kGHe
2025-08-08 20:14:09.077 | INFO     | __main__:<module>:43 - Session Secret Key: ********bdbe
2025-08-08 20:14:09.077 | INFO     | __main__:<module>:44 - 服务器ipv6地址为: http://[240e:479:668:3c1c:b5dc:e5a6:a573:f7a9]:8888
2025-08-08 20:14:09.078 | INFO     | __main__:<module>:151 - FastAPI 应用已实例化并注册到 app_state。
2025-08-08 20:14:09.078 | INFO     | __main__:<module>:154 - CORS中间件已添加，允许所有来源。
2025-08-08 20:14:09.088 | INFO     | __main__:<module>:174 - MCP 服务器 '项目文件检索服务器' 已挂载到 FastAPI 应用的 '/mcp/' 路径。
2025-08-08 20:14:09.105 | INFO     | __main__:combined_lifespan:64 - COMBINED LIFESPAN START - PID: 409925 - 服务器启动中...
2025-08-08 20:14:09.140 | INFO     | __main__:combined_lifespan:69 - HTTPX 客户端已创建并注册到 app_state。
2025-08-08 20:14:09.140 | INFO     | utils.utils:check_embedding_service_health:28 - 正在检查嵌入模型服务，目标URL: http://127.0.0.1:8001/v1/models
2025-08-08 20:14:09.146 | INFO     | utils.utils:check_embedding_service_health:37 - 嵌入模型服务可用，模型列表: ['/home/zhouxiang/models/BAAI_bge-m3']
2025-08-08 20:14:09.146 | INFO     | core.session:__init__:79 - SessionStateManager已初始化。整体HTTP不活动超时: 3600秒
2025-08-08 20:14:09.146 | INFO     | __main__:combined_lifespan:77 - SessionStateManager 已实例化并注册到 app_state。
2025-08-08 20:14:09.147 | INFO     | database.document_service:__init__:164 - 有效文档根目录: {'项目文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/Projects1'), '规范文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/规程规范'), '管理文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/管理文件')}
2025-08-08 20:14:09.147 | DEBUG    | database.document_service:_init_db:180 - 初始化数据库
2025-08-08 20:14:09.147 | DEBUG    | database.document_service:_init_db:201 - 数据库初始化完成
2025-08-08 20:14:09.147 | INFO     | database.document_service:__init__:177 - DocumentQueryService 初始化完成
2025-08-08 20:14:09.147 | INFO     | database.document_service:full_scan:324 - 开始全量扫描...
2025-08-08 20:14:09.147 | INFO     | database.document_service:full_scan:327 - 正在扫描 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 20:14:14.401 | INFO     | database.document_service:full_scan:327 - 正在扫描 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-08 20:14:14.615 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_12_479_254_639_268_0.jpg
2025-08-08 20:14:14.616 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_19_1142_1062_132_174_0.jpg
2025-08-08 20:14:14.616 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_67_179_250_1020_1864_0.jpg
2025-08-08 20:14:14.616 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_68_163_248_1019_1887_0.jpg
2025-08-08 20:14:14.616 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_235_1053_1153_960_0.jpg
2025-08-08 20:14:14.616 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_257_392_1118_414_0.jpg
2025-08-08 20:14:14.616 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_227_383_1163_510_0.jpg
2025-08-08 20:14:14.617 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_234_1152_1146_503_0.jpg
2025-08-08 20:14:14.617 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_71_416_1374_824_646_0.jpg
2025-08-08 20:14:14.617 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_73_362_1146_917_618_0.jpg
2025-08-08 20:14:14.617 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_74_573_1274_462_123_0.jpg
2025-08-08 20:14:14.617 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_76_248_1224_1104_782_0.jpg
2025-08-08 20:14:14.617 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_78_242_276_1113_842_0.jpg
2025-08-08 20:14:14.618 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_80_347_280_898_515_0.jpg
2025-08-08 20:14:14.618 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_86_210_747_1187_915_0.jpg
2025-08-08 20:14:14.618 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_87_238_256_1180_936_0.jpg
2025-08-08 20:14:14.618 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_91_256_269_1156_955_0.jpg
2025-08-08 20:14:14.618 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_232_301_1140_940_0.jpg
2025-08-08 20:14:14.618 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_233_1466_1147_602_0.jpg
2025-08-08 20:14:14.619 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_93_324_268_737_1834_0.jpg
2025-08-08 20:14:14.622 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_361_435_977_304_0.jpg
2025-08-08 20:14:14.623 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_616_930_468_258_0.jpg
2025-08-08 20:14:14.623 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_287_1114_1128_645_0.jpg
2025-08-08 20:14:14.623 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_304_320_1113_638_0.jpg
2025-08-08 20:14:14.623 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_214_315_1133_645_0.jpg
2025-08-08 20:14:14.623 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_220_1122_1142_645_0.jpg
2025-08-08 20:14:14.624 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_287_1119_1136_651_0.jpg
2025-08-08 20:14:14.624 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_299_324_1134_642_0.jpg
2025-08-08 20:14:14.624 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_203_320_1145_655_0.jpg
2025-08-08 20:14:14.624 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_227_1129_1130_645_0.jpg
2025-08-08 20:14:14.624 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_290_1126_1125_656_0.jpg
2025-08-08 20:14:14.625 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_306_322_1119_646_0.jpg
2025-08-08 20:14:14.625 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_212_221_1133_659_0.jpg
2025-08-08 20:14:14.625 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_225_1049_1127_636_0.jpg
2025-08-08 20:14:14.625 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_0_1237_154_289_162_0.jpg
2025-08-08 20:14:14.625 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_253_704_552_467_0.jpg
2025-08-08 20:14:14.625 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_884_684_459_455_0.jpg
2025-08-08 20:14:14.626 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_143_500_318_578_556_0.jpg
2025-08-08 20:14:14.626 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_146_315_228_1095_400_0.jpg
2025-08-08 20:14:14.626 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_150_286_250_1129_814_0.jpg
2025-08-08 20:14:14.626 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_248_725_1164_564_0.jpg
2025-08-08 20:14:14.626 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_388_215_897_435_0.jpg
2025-08-08 20:14:14.627 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_287_1311_1133_384_0.jpg
2025-08-08 20:14:14.627 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_70_393_948_902_341_0.jpg
2025-08-08 20:14:14.627 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_72_258_681_1160_1355_0.jpg
2025-08-08 20:14:14.627 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_75_240_362_1177_1656_0.jpg
2025-08-08 20:14:14.627 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_78_240_318_1168_1731_0.jpg
2025-08-08 20:14:14.627 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_81_248_343_1165_1687_0.jpg
2025-08-08 20:14:14.628 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_84_238_386_1162_1624_0.jpg
2025-08-08 20:14:14.628 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_86_239_653_1166_1338_0.jpg
2025-08-08 20:14:14.628 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_88_623_450_653_646_0.jpg
2025-08-08 20:14:14.628 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_90_238_296_1174_1720_0.jpg
2025-08-08 20:14:14.628 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_91_225_299_1187_1707_0.jpg
2025-08-08 20:14:14.628 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_94_257_289_1171_1697_0.jpg
2025-08-08 20:14:14.629 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_97_227_303_1170_1731_0.jpg
2025-08-08 20:14:14.629 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_101_225_672_1178_1353_0.jpg
2025-08-08 20:14:14.629 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_102_240_291_1203_1722_0.jpg
2025-08-08 20:14:14.629 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_103_240_297_1178_1734_0.jpg
2025-08-08 20:14:14.629 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_119_475_1184_667_691_0.jpg
2025-08-08 20:14:14.630 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_121_593_1023_425_178_0.jpg
2025-08-08 20:14:14.630 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_122_444_294_775_206_0.jpg
2025-08-08 20:14:14.630 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_413_902_778_279_0.jpg
2025-08-08 20:14:14.630 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_419_1314_768_347_0.jpg
2025-08-08 20:14:14.630 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_126_387_330_904_455_0.jpg
2025-08-08 20:14:14.630 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_129_362_691_912_684_0.jpg
2025-08-08 20:14:14.631 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_137_501_1634_612_391_0.jpg
2025-08-08 20:14:14.631 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_138_536_226_623_387_0.jpg
2025-08-08 20:14:14.631 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_177_316_1559_1037_507_0.jpg
2025-08-08 20:14:14.631 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_187_373_890_922_309_0.jpg
2025-08-08 20:14:14.631 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_389_874_879_339_0.jpg
2025-08-08 20:14:14.631 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_509_232_635_564_0.jpg
2025-08-08 20:14:14.632 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_514_1307_644_653_0.jpg
2025-08-08 20:14:14.632 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_318_1309_1020_458_0.jpg
2025-08-08 20:14:14.632 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_397_458_892_388_0.jpg
2025-08-08 20:14:14.632 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_539_1403_583_424_0.jpg
2025-08-08 20:14:14.632 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_194_438_645_754_434_0.jpg
2025-08-08 20:14:14.632 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_365_222_908_608_0.jpg
2025-08-08 20:14:14.633 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_385_1267_869_447_0.jpg
2025-08-08 20:14:14.633 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_206_501_795_660_1153_0.jpg
2025-08-08 20:14:14.633 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_208_581_1522_499_443_0.jpg
2025-08-08 20:14:14.633 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_209_536_235_551_971_0.jpg
2025-08-08 20:14:14.633 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_210_246_516_270_300_0.jpg
2025-08-08 20:14:14.634 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_128_411_445_833_494_0.jpg
2025-08-08 20:14:14.634 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_428_384_769_490_0.jpg
2025-08-08 20:14:14.634 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_49_529_271_627_470_0.jpg
2025-08-08 20:14:14.634 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_66_257_325_1140_552_0.jpg
2025-08-08 20:14:14.634 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_1090_878_289_229_0.jpg
2025-08-08 20:14:14.634 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_432_894_219_206_0.jpg
2025-08-08 20:14:14.635 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_728_895_247_200_0.jpg
2025-08-08 20:14:14.635 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1095_623_266_169_0.jpg
2025-08-08 20:14:14.635 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1141_832_201_101_0.jpg
2025-08-08 20:14:14.635 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_444_641_235_139_0.jpg
2025-08-08 20:14:14.635 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_459_831_166_104_0.jpg
2025-08-08 20:14:14.635 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_724_603_276_178_0.jpg
2025-08-08 20:14:14.635 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_747_821_223_122_0.jpg
2025-08-08 20:14:14.642 | INFO     | database.document_service:full_scan:327 - 正在扫描 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-08 20:14:14.643 | INFO     | database.document_service:full_scan:332 - 全量扫描完成，共处理文件数: 1581
2025-08-08 20:14:14.643 | DEBUG    | database.document_service:_start_watchdog:335 - 启动文件监控 Watchdog
2025-08-08 20:14:14.643 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-08 20:14:14.643 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-08 20:14:14.643 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-08 20:14:14.659 | INFO     | database.document_service:_start_watchdog:423 - Watchdog 已启动
2025-08-08 20:14:14.659 | INFO     | database.document_service:start:465 - DocumentQueryService 已启动
2025-08-08 20:14:14.659 | INFO     | __main__:combined_lifespan:83 - 统一文档查询服务 (DocumentQueryService) 已启动。
2025-08-08 20:14:14.659 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/Projects1', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-08 20:14:14.660 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/规程规范', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-08 20:14:14.660 | INFO     | __main__:combined_lifespan:88 - 项目和规程的文件服务已初始化。
2025-08-08 20:14:14.661 | INFO     | __main__:combined_lifespan:93 - AsyncIOScheduler 已实例化并注册到 app_state。
2025-08-08 20:14:14.661 | INFO     | __main__:combined_lifespan:97 - FastMCP lifespan context entered.
2025-08-08 20:14:14.661 | INFO     | __main__:combined_lifespan:117 - 处理不活动用户会话任务已添加到APScheduler (每 60s)。
2025-08-08 20:14:14.661 | INFO     | __main__:combined_lifespan:120 - 清理用户会话中已打开文件token任务已添加到APScheduler (每 120s)。
2025-08-08 20:14:14.662 | INFO     | __main__:combined_lifespan:123 - APScheduler 调度器已启动。
2025-08-08 20:14:14.662 | INFO     | __main__:combined_lifespan:124 - 所有初始化完成... yield
2025-08-08 20:14:14.662 | DEBUG    | database.document_service:_debounced_update_loop:426 - 启动去抖更新循环
2025-08-08 20:14:20.506 | DEBUG    | core.auth:verify_active_session:24 - verify_active_session: HTTP session中缺少用户名或session_id。
2025-08-08 20:14:24.696 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: c07fe7b0-cac7-4726-b88d-6f8b3388c708, IP: 240e:3a1:7d0:ab80::e7) 登录/状态更新成功。
2025-08-08 20:14:24.696 | INFO     | api.route:login:69 - 用户 'admin' (IP: 240e:3a1:7d0:ab80::e7, Session: c07fe7b0-cac7-4726-b88d-6f8b3388c708) 登录成功。
2025-08-08 20:14:24.866 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: c07fe7b0-cac7-4726-b88d-6f8b3388c708) 的 WebSocket 已连接并关联。
2025-08-08 20:14:24.938 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-08 20:14:26.471 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 20:14:36.095 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 20:14:36.097 | INFO     | api.admin:update_admin_config:164 - 从服务商 'zhipu' 的预设中加载了 API Key。
2025-08-08 20:14:36.097 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: https://open.bigmodel.cn/api/paas/v4/
2025-08-08 20:14:36.097 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: GLM-4.5-Flash
2025-08-08 20:14:36.097 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******Yj8a
2025-08-08 20:14:36.122 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 20:14:42.529 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 29b6a1db-35a4-45c0-9fab-caa703b970b7。清空历史记录。
2025-08-08 20:14:53.147 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 20:14:53.147 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 29b6a1db-35a4-45c0-9fab-caa703b970b7, 查询: 帮我打开船闸项目
2025-08-08 20:14:53.147 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:14:56.919 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_DHlE1rfdR-SFr58U_X1oFw', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user": "admin", "project_name": "船闸"}'}}]
2025-08-08 20:14:56.919 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user": "admin", "project_name": "船闸"}
2025-08-08 20:14:56.961 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='船闸', 年份='None'
2025-08-08 20:14:56.961 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 20:14:56.972 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计']
2025-08-08 20:14:56.972 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计'
2025-08-08 20:14:56.973 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计']
2025-08-08 20:14:56.975 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计'，包含 77 个文件。
2025-08-08 20:14:56.976 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 20:14:56.982 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:15:51.903 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 20:15:51.903 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 29b6a1db-35a4-45c0-9fab-caa703b970b7, 查询: 打开主变扩建的评审意见和材料清册，看看内容匹配吗
2025-08-08 20:15:51.903 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:15:56.919 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_d0e2b47ea4f74f88966213a3', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx", "file_category": "普通文档"}'}}]
2025-08-08 20:15:56.920 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx", "file_category": "普通文档"}
2025-08-08 20:15:56.962 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx', Category: '普通文档'
2025-08-08 20:15:56.962 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx (相对路径: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx)，分隔符: '	'
2025-08-08 20:15:57.120 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: 苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx, 内容长度: 10375
2025-08-08 20:15:57.120 | INFO     | my_mcp_tools.mcp_tools:read_project_file:706 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx成功读取（预览100字）:

苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见

根据国网江苏省电力有限公司建设部初步设计评审计划安排，国网江苏电力设计咨询有限公司于2024年7月11日，开展了苏州船闸110kV变
2025-08-08 20:15:57.120 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx' (token: 494dbc93158143c7908fafc080817185), 有效期至: Sat Aug  9 04:15:57 2025
2025-08-08 20:15:57.121 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx' 已在会话中注册, token: 494dbc93158143c7908fafc080817185
2025-08-08 20:15:57.129 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:15:57.161 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/494dbc93158143c7908fafc080817185/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx
2025-08-08 20:15:57.169 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23_11b6f43c.docx' 与Token关联文件名 '苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx' 不匹配。将使用Token关联文件名。
2025-08-08 20:15:57.169 | DEBUG    | api.route:download_file_via_token:186 - Token '494dbc93158143c7908fafc080817185' 验证成功。准备下载文件: '苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23.docx', URL文件名: '苏州船闸110kV变电站2号3号主变扩建工程初步设计评审意见2024.7.23_11b6f43c.docx')
2025-08-08 20:16:07.260 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_fTy7z1mVQNiC4sQwHvrwUg', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf", "file_category": "普通文档"}'}}]
2025-08-08 20:16:07.260 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf", "file_category": "普通文档"}
2025-08-08 20:16:07.301 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', Category: '普通文档'
2025-08-08 20:16:07.302 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf (相对路径: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf)，分隔符: '	'
2025-08-08 20:16:08.896 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: 382-B230168C-A-02 主要设备材料清册.pdf, 内容长度: 14465
2025-08-08 20:16:08.896 | INFO     | my_mcp_tools.mcp_tools:read_project_file:706 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf成功读取（预览100字）:文 件 编 号
382-B230168C-A-02
船闸 110 千伏变电站 2 号 3 号主变扩建工程
初步设计
要设备材料清册
智方设计股份有限公司
工程设计证书：甲级第 A132005184 号
2025-08-08 20:16:08.896 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf' (token: 6fa696c780d34ad69ba3ffb417c619de), 有效期至: Sat Aug  9 04:16:08 2025
2025-08-08 20:16:08.897 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf' 已在会话中注册, token: 6fa696c780d34ad69ba3ffb417c619de
2025-08-08 20:16:08.905 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:16:08.937 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/6fa696c780d34ad69ba3ffb417c619de/382-B230168C-A-02 主要设备材料清册.pdf
2025-08-08 20:16:09.121 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '382-B230168C-A-02 主要设备材料清册_4048ba8f.pdf' 与Token关联文件名 '382-B230168C-A-02 主要设备材料清册.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 20:16:09.122 | DEBUG    | api.route:download_file_via_token:186 - Token '6fa696c780d34ad69ba3ffb417c619de' 验证成功。准备下载文件: '382-B230168C-A-02 主要设备材料清册.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', URL文件名: '382-B230168C-A-02 主要设备材料清册_4048ba8f.pdf')
2025-08-08 20:16:09.124 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '382-B230168C-A-02 主要设备材料清册_4048ba8f.pdf' 与Token关联文件名 '382-B230168C-A-02 主要设备材料清册.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 20:16:09.124 | DEBUG    | api.route:download_file_via_token:186 - Token '6fa696c780d34ad69ba3ffb417c619de' 验证成功。准备下载文件: '382-B230168C-A-02 主要设备材料清册.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', URL文件名: '382-B230168C-A-02 主要设备材料清册_4048ba8f.pdf')
2025-08-08 20:18:58.571 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 20:18:58.571 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 29b6a1db-35a4-45c0-9fab-caa703b970b7, 查询: 对比送审版和收口版材料清册
2025-08-08 20:18:58.571 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:19:19.680 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_jFOfkJ8-SF6mgHih_eAFLQ', 'type': 'function', 'function': {'name': 'diff_project_file', 'arguments': '{"user": "admin", "relative_file1_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.docx", "relative_file2_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf", "document_type": "材料清册"}'}}]
2025-08-08 20:19:19.680 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: diff_project_file with args: {"user": "admin", "relative_file1_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.docx", "relative_file2_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf", "document_type": "材料清册"}
2025-08-08 20:19:19.724 | INFO     | my_mcp_tools.mcp_tools:diff_project_file:370 - 工具调用: compare_project_file. 用户:admin, 文件1: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.docx', 文件2: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', 文件类型: '材料清册', Sheet名: 'None', All Sheets: False
2025-08-08 20:19:19.724 | ERROR    | my_mcp_tools.mcp_tools:diff_project_file:381 - 错误: 文件未找到: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.docx:False, 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf:True
2025-08-08 20:19:19.729 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:19:26.030 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_vRdjLR5BR1eaZeVEmlR6EA', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user": "admin", "project_name": "船闸"}'}}]
2025-08-08 20:19:26.030 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user": "admin", "project_name": "船闸"}
2025-08-08 20:19:26.078 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='船闸', 年份='None'
2025-08-08 20:19:26.078 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 20:19:26.097 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 1 个项目: ['江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计']
2025-08-08 20:19:26.097 | INFO     | my_mcp_tools.mcp_tools:query_project_files:771 - 模糊匹配到唯一项目: '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计'
2025-08-08 20:19:26.098 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计']
2025-08-08 20:19:26.100 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计'，包含 77 个文件。
2025-08-08 20:19:26.101 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 20:19:26.109 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:19:40.515 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_-ifM-9UTQJiPeurDBJLTRg', 'type': 'function', 'function': {'name': 'diff_project_file', 'arguments': '{"user": "admin", "relative_file1_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc", "relative_file2_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf", "document_type": "材料清册"}'}}]
2025-08-08 20:19:40.515 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: diff_project_file with args: {"user": "admin", "relative_file1_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc", "relative_file2_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf", "document_type": "材料清册"}
2025-08-08 20:19:40.558 | INFO     | my_mcp_tools.mcp_tools:diff_project_file:370 - 工具调用: compare_project_file. 用户:admin, 文件1: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc', 文件2: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', 文件类型: '材料清册', Sheet名: 'None', All Sheets: False
2025-08-08 20:19:40.558 | ERROR    | my_mcp_tools.mcp_tools:diff_project_file:389 - 错误: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc与2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf 文件无效，有效的文件名为:'.xlsx', '.pdf', '.docx'
2025-08-08 20:19:40.562 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:19:46.119 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_7l75IHbSSnefJwzod5WI2Q', 'type': 'function', 'function': {'name': 'diff_project_file', 'arguments': '{"user": "admin", "relative_file1_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc", "relative_file2_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf", "document_type": "材料清册"}'}}]
2025-08-08 20:19:46.119 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: diff_project_file with args: {"user": "admin", "relative_file1_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc", "relative_file2_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf", "document_type": "材料清册"}
2025-08-08 20:19:46.164 | INFO     | my_mcp_tools.mcp_tools:diff_project_file:370 - 工具调用: compare_project_file. 用户:admin, 文件1: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc', 文件2: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', 文件类型: '材料清册', Sheet名: 'None', All Sheets: False
2025-08-08 20:19:46.164 | ERROR    | my_mcp_tools.mcp_tools:diff_project_file:389 - 错误: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc与2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/★初步设计（20240723--经研院审查后收口版）PDF/382-B230168C-A-02 主要设备材料清册.pdf 文件无效，有效的文件名为:'.xlsx', '.pdf', '.docx'
2025-08-08 20:19:46.169 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:19:49.694 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_oy22T9u2RhWPVO7Y_cU3xA', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc", "file_category": "普通文档"}'}}]
2025-08-08 20:19:49.694 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc", "file_category": "普通文档"}
2025-08-08 20:19:49.735 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc', Category: '普通文档'
2025-08-08 20:19:49.735 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc (相对路径: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc)，分隔符: '	'
2025-08-08 20:19:49.736 | WARNING  | utils.file_parser:parse_file:266 - 文件 '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc' 的扩展名 '.doc' 不在已知解析类型中，也非标准纯文本类型。
2025-08-08 20:19:49.736 | ERROR    | my_mcp_tools.mcp_tools:_get_file_content:86 - MCP Tool: 解析文件 /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc (相对路径: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc) 失败或返回错误: 错误: 不支持的文件类型 .doc。
2025-08-08 20:19:49.736 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:701 - 读取文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/382-B230168C-A-02 主要设备材料清册.doc 失败: 错误: 不支持的文件类型 .doc。
2025-08-08 20:19:49.740 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:19:58.336 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_P7KYLtZiQtOdmETfdZnwhg', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-A-02 主要设备材料清册.pdf", "file_category": "普通文档"}'}}]
2025-08-08 20:19:58.336 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-A-02 主要设备材料清册.pdf", "file_category": "普通文档"}
2025-08-08 20:19:58.379 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', Category: '普通文档'
2025-08-08 20:19:58.379 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-A-02 主要设备材料清册.pdf (相对路径: 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-A-02 主要设备材料清册.pdf)，分隔符: '	'
2025-08-08 20:20:00.024 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: 382-B230168C-A-02 主要设备材料清册.pdf, 内容长度: 14581
2025-08-08 20:20:00.024 | INFO     | my_mcp_tools.mcp_tools:read_project_file:706 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-A-02 主要设备材料清册.pdf成功读取（预览100字）:文 件 编 号
382-B230168C-A-02
船闸 110 千伏变电站 2 号 3 号主变扩建工程
初步设计
要设备材料清册
智方设计股份有限公司
工程设计证书：甲级第 A132005184 号
2025-08-08 20:20:00.024 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-A-02 主要设备材料清册.pdf' (token: b11d2230f9ad4424bb402b159c73d969), 有效期至: Sat Aug  9 04:20:00 2025
2025-08-08 20:20:00.025 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-A-02 主要设备材料清册.pdf' 已在会话中注册, token: b11d2230f9ad4424bb402b159c73d969
2025-08-08 20:20:00.033 | WARNING  | sse_proxy.sse2websocket1:_handle_stream:115 - 递归深度超过最大限制(5)，终止工具调用
2025-08-08 20:20:00.077 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/b11d2230f9ad4424bb402b159c73d969/382-B230168C-A-02 主要设备材料清册.pdf
2025-08-08 20:20:00.239 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '382-B230168C-A-02 主要设备材料清册_adaf7655.pdf' 与Token关联文件名 '382-B230168C-A-02 主要设备材料清册.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 20:20:00.239 | DEBUG    | api.route:download_file_via_token:186 - Token 'b11d2230f9ad4424bb402b159c73d969' 验证成功。准备下载文件: '382-B230168C-A-02 主要设备材料清册.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', URL文件名: '382-B230168C-A-02 主要设备材料清册_adaf7655.pdf')
2025-08-08 20:20:00.241 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '382-B230168C-A-02 主要设备材料清册_adaf7655.pdf' 与Token关联文件名 '382-B230168C-A-02 主要设备材料清册.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 20:20:00.241 | DEBUG    | api.route:download_file_via_token:186 - Token 'b11d2230f9ad4424bb402b159c73d969' 验证成功。准备下载文件: '382-B230168C-A-02 主要设备材料清册.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/★初步设计（20240531--内审后修改版）PDF/382-B230168C-A-02 主要设备材料清册.pdf', URL文件名: '382-B230168C-A-02 主要设备材料清册_adaf7655.pdf')
2025-08-08 20:24:19.899 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 20:24:19.900 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 29b6a1db-35a4-45c0-9fab-caa703b970b7, 查询: 再比较下送审和收口版材料清册，注意文件格式要一致
2025-08-08 20:24:19.900 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:25:27.723 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 20:25:27.723 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 29b6a1db-35a4-45c0-9fab-caa703b970b7, 查询: 在比较下送审和收口概算的差异
2025-08-08 20:25:27.723 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:25:43.496 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_4e86c25295f6468aae5a5569', 'type': 'function', 'function': {'name': 'diff_project_file', 'arguments': '{"user": "admin", "relative_file1_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "relative_file2_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "document_type": "概算表"}'}}]
2025-08-08 20:25:43.497 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: diff_project_file with args: {"user": "admin", "relative_file1_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "relative_file2_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "document_type": "概算表"}
2025-08-08 20:25:43.549 | INFO     | my_mcp_tools.mcp_tools:diff_project_file:370 - 工具调用: compare_project_file. 用户:admin, 文件1: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', 文件2: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', 文件类型: '概算表', Sheet名: 'None', All Sheets: False
2025-08-08 20:25:43.549 | WARNING  | my_mcp_tools.mcp_tools:diff_project_file:490 - 错误: 文件类型 '概算表' (Excel) 且 all_sheet=False 时，需要提供 sheet_name 进行比较，请检查调用参数。
2025-08-08 20:25:43.556 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:25:52.712 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_I6aoobSXSzmFrvbB4uX7Gg', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "概算表"}'}}]
2025-08-08 20:25:52.712 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "概算表"}
2025-08-08 20:25:52.753 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', Category: '概算书文档'
2025-08-08 20:25:52.798 | WARNING  | my_mcp_tools.mcp_tools:read_project_file:673 - Sheet '概算表' 在文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx 中未找到。可用Sheets: 封面
签字审批
编制说明
目录
变电站工程总概算表
变电站建筑工程专业汇总概算表
变电站安装工程汇总概算表
建筑部分汇总表（取费）
安装部分汇总表（取费）
变电站建筑工程概算表
变电站安装工程概算表
变电站安装工程概算表（拆除表三）
变电站建筑工程概算表（余物清理表三）
建筑工程取费表
安装工程取费表
变电站工程其他费用概算表
施工图预算管理工程数据收集表
变电站工程建设场地征用及清理费用概算表
建筑主材汇总表
安装主材汇总表
建筑设备汇总表
安装设备汇总表
建设期贷款利息明细表
建筑基准期价差明细表
安装基准期价差明细表
设计费明细表
2025-08-08 20:25:52.804 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:26:00.527 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_lYyjdFyoSHSeifxpNsVg-w', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站工程总概算表"}'}}]
2025-08-08 20:26:00.527 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站工程总概算表"}
2025-08-08 20:26:00.569 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', Category: '概算书文档'
2025-08-08 20:26:00.659 | INFO     | my_mcp_tools.mcp_tools:read_project_file:685 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx成功读取 sheet:变电站工程总概算表（预览100字）:表N.2 变电站工程总概算表								
表一   建设规模：12.6万kVA								金额单位:万元
序号	工程或费用名称	建筑工程费	设备购置费	安装工程费	其他费用	合计	各项占静态投
2025-08-08 20:26:00.660 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (token: 290ad9ce0c074e47b4ebcb6df5c369e1), 有效期至: Sat Aug  9 04:26:00 2025
2025-08-08 20:26:00.660 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 已在会话中注册, token: 290ad9ce0c074e47b4ebcb6df5c369e1
2025-08-08 20:26:00.666 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:26:00.712 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/290ad9ce0c074e47b4ebcb6df5c369e1/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx
2025-08-08 20:26:00.718 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书_21b378ea.xlsx' 与Token关联文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 不匹配。将使用Token关联文件名。
2025-08-08 20:26:00.719 | DEBUG    | api.route:download_file_via_token:186 - Token '290ad9ce0c074e47b4ebcb6df5c369e1' 验证成功。准备下载文件: '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', URL文件名: '船闸110千伏变电站2号3号主变扩建工程-概算书_21b378ea.xlsx')
2025-08-08 20:26:12.120 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_fb5e3eb38cec48238ef15312', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站工程总概算表"}'}}]
2025-08-08 20:26:12.120 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站工程总概算表"}
2025-08-08 20:26:12.169 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', Category: '概算书文档'
2025-08-08 20:26:12.271 | INFO     | my_mcp_tools.mcp_tools:read_project_file:685 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx成功读取 sheet:变电站工程总概算表（预览100字）:表N.2 变电站工程总概算表								
表一   建设规模：12.6万kVA								金额单位:万元
序号	工程或费用名称	建筑工程费	设备购置费	安装工程费	其他费用	合计	各项占静态投
2025-08-08 20:26:12.272 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (token: 3b5ac24bdd204ca492a5ad23a4ad7618), 有效期至: Sat Aug  9 04:26:12 2025
2025-08-08 20:26:12.272 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 已在会话中注册, token: 3b5ac24bdd204ca492a5ad23a4ad7618
2025-08-08 20:26:12.278 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:26:12.305 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/3b5ac24bdd204ca492a5ad23a4ad7618/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx
2025-08-08 20:26:12.310 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书_932751a7.xlsx' 与Token关联文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 不匹配。将使用Token关联文件名。
2025-08-08 20:26:12.310 | DEBUG    | api.route:download_file_via_token:186 - Token '3b5ac24bdd204ca492a5ad23a4ad7618' 验证成功。准备下载文件: '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', URL文件名: '船闸110千伏变电站2号3号主变扩建工程-概算书_932751a7.xlsx')
2025-08-08 20:26:25.561 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_bBE6_z3FR5iUyvE2ZE0LTg', 'type': 'function', 'function': {'name': 'diff_project_file', 'arguments': '{"user": "admin", "relative_file1_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "relative_file2_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "document_type": "概算表", "sheet_name": "变电站工程总概算表"}'}}]
2025-08-08 20:26:25.561 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: diff_project_file with args: {"user": "admin", "relative_file1_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "relative_file2_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "document_type": "概算表", "sheet_name": "变电站工程总概算表"}
2025-08-08 20:26:25.612 | INFO     | my_mcp_tools.mcp_tools:diff_project_file:370 - 工具调用: compare_project_file. 用户:admin, 文件1: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', 文件2: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', 文件类型: '概算表', Sheet名: '变电站工程总概算表', All Sheets: False
2025-08-08 20:26:25.612 | INFO     | my_mcp_tools.mcp_tools:diff_project_file:497 - 对文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 和 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (类型: 概算表) 比较变电站工程总概算表。
2025-08-08 20:26:25.716 | DEBUG    | my_mcp_tools.mcp_tools:diff_project_file:512 - 已从Excel文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 和 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 的Sheet '变电站工程总概算表' (列配置: None) 读取内容进行比较。
2025-08-08 20:26:25.716 | INFO     | my_mcp_tools.mcp_tools:diff_project_file:526 - '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 和 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 的Sheet '变电站工程总概算表' 存在差异。
2025-08-08 20:26:25.717 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (token: bd20db8ccb91447390a3b1b9c9ec2a1d), 有效期至: Sat Aug  9 04:26:25 2025
2025-08-08 20:26:25.717 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (token: 141fee151f7748e895f2f6eb663abbfb), 有效期至: Sat Aug  9 04:26:25 2025
2025-08-08 20:26:25.723 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:26:25.765 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/bd20db8ccb91447390a3b1b9c9ec2a1d/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx
2025-08-08 20:26:25.770 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书_3ce98f15.xlsx' 与Token关联文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 不匹配。将使用Token关联文件名。
2025-08-08 20:26:25.770 | DEBUG    | api.route:download_file_via_token:186 - Token 'bd20db8ccb91447390a3b1b9c9ec2a1d' 验证成功。准备下载文件: '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', URL文件名: '船闸110千伏变电站2号3号主变扩建工程-概算书_3ce98f15.xlsx')
2025-08-08 20:26:25.776 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/141fee151f7748e895f2f6eb663abbfb/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx
2025-08-08 20:26:25.783 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书_f7c9353c.xlsx' 与Token关联文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 不匹配。将使用Token关联文件名。
2025-08-08 20:26:25.783 | DEBUG    | api.route:download_file_via_token:186 - Token '141fee151f7748e895f2f6eb663abbfb' 验证成功。准备下载文件: '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', URL文件名: '船闸110千伏变电站2号3号主变扩建工程-概算书_f7c9353c.xlsx')
2025-08-08 20:26:40.201 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_uWCUSYhaSkyNa7qiFOKxwQ', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站安装工程汇总概算表"}'}}]
2025-08-08 20:26:40.201 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站安装工程汇总概算表"}
2025-08-08 20:26:40.246 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', Category: '概算书文档'
2025-08-08 20:26:40.336 | INFO     | my_mcp_tools.mcp_tools:read_project_file:685 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx成功读取 sheet:变电站安装工程汇总概算表（预览100字）:表N.3 变电站安装工程汇总概算表									
表二甲									金额单位:元
序号	工程或费用名称	设备购置费	安装工程费			合计	技术经济指标		
			装置性材料	安装	小计		单
2025-08-08 20:26:40.336 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (token: 7c55e3b42c664fab84944d6749f68a5a), 有效期至: Sat Aug  9 04:26:40 2025
2025-08-08 20:26:40.337 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 已在会话中注册, token: 7c55e3b42c664fab84944d6749f68a5a
2025-08-08 20:26:40.343 | WARNING  | sse_proxy.sse2websocket1:_handle_stream:115 - 递归深度超过最大限制(5)，终止工具调用
2025-08-08 20:27:01.427 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 20:27:01.427 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 29b6a1db-35a4-45c0-9fab-caa703b970b7, 查询: 继续
2025-08-08 20:27:01.427 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:27:10.339 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_uGxCyuEJRPe9I4vTdKNumQ', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站安装工程汇总概算表"}'}}]
2025-08-08 20:27:10.339 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站安装工程汇总概算表"}
2025-08-08 20:27:10.383 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', Category: '概算书文档'
2025-08-08 20:27:10.654 | INFO     | my_mcp_tools.mcp_tools:read_project_file:685 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx成功读取 sheet:变电站安装工程汇总概算表（预览100字）:表N.3 变电站安装工程汇总概算表									
表二甲									金额单位:元
序号	工程或费用名称	设备购置费	安装工程费			合计	技术经济指标		
			装置性材料	安装	小计		单
2025-08-08 20:27:10.654 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (token: dee2e99e062e4dd69f8883fc5bc74635), 有效期至: Sat Aug  9 04:27:10 2025
2025-08-08 20:27:10.655 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 已在会话中注册, token: dee2e99e062e4dd69f8883fc5bc74635
2025-08-08 20:27:10.662 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:27:27.110 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_QTbmU-R2QqycTh585wXypw', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站建筑工程专业汇总概算表"}'}}]
2025-08-08 20:27:27.110 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站建筑工程专业汇总概算表"}
2025-08-08 20:27:27.161 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', Category: '概算书文档'
2025-08-08 20:27:27.255 | INFO     | my_mcp_tools.mcp_tools:read_project_file:685 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx成功读取 sheet:变电站建筑工程专业汇总概算表（预览100字）:表N.4 变电站建筑工程专业汇总概算表							
表二乙							金额单位:元
序号	工程或费用名称	建筑费	设备费	建筑工程费合计	技术经济指标		
					单位	数量	指标
	建筑工程	
2025-08-08 20:27:27.255 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (token: 18f1ba1bffb141cc9d4057717db13514), 有效期至: Sat Aug  9 04:27:27 2025
2025-08-08 20:27:27.256 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 已在会话中注册, token: 18f1ba1bffb141cc9d4057717db13514
2025-08-08 20:27:27.261 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:27:41.371 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_b3d4b683a7904449b8d6feba', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站建筑工程专业汇总概算表"}'}}]
2025-08-08 20:27:41.371 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站建筑工程专业汇总概算表"}
2025-08-08 20:27:41.417 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', Category: '概算书文档'
2025-08-08 20:27:41.527 | INFO     | my_mcp_tools.mcp_tools:read_project_file:685 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx成功读取 sheet:变电站建筑工程专业汇总概算表（预览100字）:表N.4 变电站建筑工程专业汇总概算表							
表二乙							金额单位:元
序号	工程或费用名称	建筑费	设备费	建筑工程费合计	技术经济指标		
					单位	数量	指标
	建筑工程	
2025-08-08 20:27:41.527 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (token: 01cb004ecd5343b49b622da80597abc7), 有效期至: Sat Aug  9 04:27:41 2025
2025-08-08 20:27:41.527 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 已在会话中注册, token: 01cb004ecd5343b49b622da80597abc7
2025-08-08 20:27:41.534 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:27:48.028 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_ClVGYHYnRTSw_Zq4unnXIw', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站工程其他费用概算表"}'}}]
2025-08-08 20:27:48.029 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站工程其他费用概算表"}
2025-08-08 20:27:48.076 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', Category: '概算书文档'
2025-08-08 20:27:48.172 | INFO     | my_mcp_tools.mcp_tools:read_project_file:685 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx成功读取 sheet:变电站工程其他费用概算表（预览100字）:表N.7 变电站工程其他费用概算表			
表四			金额单位:元
序号	工程或费用名称	编制依据及计算说明	合价
	合计		1592140
1	建设场地征用及清理费	(建设场地征用及清理费)	7683
2025-08-08 20:27:48.172 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (token: 1167d81df84247b998ef70a43a2e973d), 有效期至: Sat Aug  9 04:27:48 2025
2025-08-08 20:27:48.173 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 已在会话中注册, token: 1167d81df84247b998ef70a43a2e973d
2025-08-08 20:27:48.179 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:27:48.225 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/1167d81df84247b998ef70a43a2e973d/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx
2025-08-08 20:27:48.230 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书_c6c92e0e.xlsx' 与Token关联文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 不匹配。将使用Token关联文件名。
2025-08-08 20:27:48.230 | DEBUG    | api.route:download_file_via_token:186 - Token '1167d81df84247b998ef70a43a2e973d' 验证成功。准备下载文件: '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', URL文件名: '船闸110千伏变电站2号3号主变扩建工程-概算书_c6c92e0e.xlsx')
2025-08-08 20:27:52.330 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_kg2SCK2eQr6o0kSEvRn3MA', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站工程其他费用概算表"}'}}]
2025-08-08 20:27:52.330 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "file_category": "概算书文档", "sheet_name": "变电站工程其他费用概算表"}
2025-08-08 20:27:52.372 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', Category: '概算书文档'
2025-08-08 20:27:52.478 | INFO     | my_mcp_tools.mcp_tools:read_project_file:685 - 从文件 2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx成功读取 sheet:变电站工程其他费用概算表（预览100字）:表N.7 变电站工程其他费用概算表			
表四			金额单位:元
序号	工程或费用名称	编制依据及计算说明	合价
	合计		1213754
1	建设场地征用及清理费	(建设场地征用及清理费)	4695
2025-08-08 20:27:52.478 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (token: 3e46c36e153447b8b1a899626f3f584b), 有效期至: Sat Aug  9 04:27:52 2025
2025-08-08 20:27:52.478 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 已在会话中注册, token: 3e46c36e153447b8b1a899626f3f584b
2025-08-08 20:27:52.484 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Flash
2025-08-08 20:27:52.501 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/3e46c36e153447b8b1a899626f3f584b/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx
2025-08-08 20:27:52.505 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书_a8d76477.xlsx' 与Token关联文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 不匹配。将使用Token关联文件名。
2025-08-08 20:27:52.505 | DEBUG    | api.route:download_file_via_token:186 - Token '3e46c36e153447b8b1a899626f3f584b' 验证成功。准备下载文件: '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', URL文件名: '船闸110千伏变电站2号3号主变扩建工程-概算书_a8d76477.xlsx')
2025-08-08 20:29:17.463 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 20:29:17.463 | INFO     | api.admin:update_admin_config:164 - 从服务商 'zhipu' 的预设中加载了 API Key。
2025-08-08 20:29:17.463 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: https://open.bigmodel.cn/api/paas/v4/
2025-08-08 20:29:17.463 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: GLM-4.5-Air
2025-08-08 20:29:17.463 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******Yj8a
2025-08-08 20:29:17.504 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 20:29:26.075 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 02ebff4e-3529-45b4-83f6-659878e2e640。清空历史记录。
2025-08-08 20:29:50.306 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 20:29:50.306 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 02ebff4e-3529-45b4-83f6-659878e2e640, 查询: 比较下船闸主变扩建项目的送审版概算和收口版概算
2025-08-08 20:29:50.306 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Air
2025-08-08 20:29:53.075 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_67065a2ede2f45618a7ce8fa', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user": "admin", "project_name": "船闸主变扩建"}'}}]
2025-08-08 20:29:53.075 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user": "admin", "project_name": "船闸主变扩建"}
2025-08-08 20:29:53.124 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='船闸主变扩建', 年份='None'
2025-08-08 20:29:53.125 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 20:29:53.136 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 0 个项目: []
2025-08-08 20:29:53.136 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:785 - 使用向量检索辅助判断，候选项目数: 18
2025-08-08 20:29:53.136 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 20:29:53.349 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-3 结果: [('江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计', 0.7645461339787809), ('东余变主变扩建工程', 0.6856731920950241), ('1-无锡石园220千伏变电站第二台主变扩建工程', 0.5964718119325845)]
2025-08-08 20:29:53.357 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Air
2025-08-08 20:30:03.512 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 20:30:03.513 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 02ebff4e-3529-45b4-83f6-659878e2e640, 查询: 1
2025-08-08 20:30:03.513 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Air
2025-08-08 20:30:05.068 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_0ca38ffc1e5047daa9d73cd2', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user": "admin", "project_name": "江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计"}'}}]
2025-08-08 20:30:05.068 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user": "admin", "project_name": "江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计"}
2025-08-08 20:30:05.118 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计', 年份='None'
2025-08-08 20:30:05.118 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 20:30:05.129 | INFO     | my_mcp_tools.mcp_tools:query_project_files:756 - 精确匹配到项目: '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计'
2025-08-08 20:30:05.129 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计']
2025-08-08 20:30:05.131 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计'，包含 77 个文件。
2025-08-08 20:30:05.132 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 20:30:05.138 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Air
2025-08-08 20:30:10.220 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_dabf9faef5af4b19a867538a', 'type': 'function', 'function': {'name': 'diff_project_file', 'arguments': '{"user": "admin", "relative_file1_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "relative_file2_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "document_type": "概算表", "all_sheet": true}'}}]
2025-08-08 20:30:10.220 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: diff_project_file with args: {"user": "admin", "relative_file1_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "relative_file2_path": "2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx", "document_type": "概算表", "all_sheet": true}
2025-08-08 20:30:10.264 | INFO     | my_mcp_tools.mcp_tools:diff_project_file:370 - 工具调用: compare_project_file. 用户:admin, 文件1: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', 文件2: '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', 文件类型: '概算表', Sheet名: 'None', All Sheets: True
2025-08-08 20:30:10.265 | INFO     | my_mcp_tools.mcp_tools:diff_project_file:425 - 对文件 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 和 '2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (类型: 概算表) 进行所有Sheet的比较。
2025-08-08 20:30:13.335 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (token: 6b5413caf2c1484aa53a7389088c2e8d), 有效期至: Sat Aug  9 04:30:13 2025
2025-08-08 20:30:13.336 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (token: bed620a55be74e439c15e54bf4d425ee), 有效期至: Sat Aug  9 04:30:13 2025
2025-08-08 20:30:13.348 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Air
2025-08-08 20:30:13.399 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/6b5413caf2c1484aa53a7389088c2e8d/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx
2025-08-08 20:30:13.428 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/bed620a55be74e439c15e54bf4d425ee/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx
2025-08-08 20:30:13.429 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书_f3812abb.xlsx' 与Token关联文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 不匹配。将使用Token关联文件名。
2025-08-08 20:30:13.429 | DEBUG    | api.route:download_file_via_token:186 - Token '6b5413caf2c1484aa53a7389088c2e8d' 验证成功。准备下载文件: '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/送审/★初步设计（20240531--内审后修改版）/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', URL文件名: '船闸110千伏变电站2号3号主变扩建工程-概算书_f3812abb.xlsx')
2025-08-08 20:30:13.437 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书_69958517.xlsx' 与Token关联文件名 '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' 不匹配。将使用Token关联文件名。
2025-08-08 20:30:13.437 | DEBUG    | api.route:download_file_via_token:186 - Token 'bed620a55be74e439c15e54bf4d425ee' 验证成功。准备下载文件: '船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/江苏苏州船闸110千伏变电站2号3号主变扩建工程初步设计/收口/船闸110千伏变电站2号3号主变扩建工程/船闸变电概算/船闸110千伏变电站2号3号主变扩建工程-概算书.xlsx', URL文件名: '船闸110千伏变电站2号3号主变扩建工程-概算书_69958517.xlsx')
2025-08-08 21:21:02.808 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 21:21:09.399 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 21:21:09.399 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: https://open.bigmodel.cn/api/paas/v4/
2025-08-08 21:21:09.399 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: glm-z1-flash
2025-08-08 21:21:09.424 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 21:21:14.564 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: dafe0c68-28d2-4564-adb6-05c04f18d43b。清空历史记录。
2025-08-08 21:21:26.354 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:21:26.354 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: dafe0c68-28d2-4564-adb6-05c04f18d43b, 查询: 查下二次有哪些规范
2025-08-08 21:21:26.354 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:glm-z1-flash
2025-08-08 21:21:30.559 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: []
2025-08-08 21:21:30.559 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:glm-z1-flash
2025-08-08 21:22:10.790 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:22:10.790 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: dafe0c68-28d2-4564-adb6-05c04f18d43b, 查询: 继续
2025-08-08 21:22:10.790 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:glm-z1-flash
2025-08-08 21:22:23.235 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:22:23.235 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: dafe0c68-28d2-4564-adb6-05c04f18d43b, 查询: 使用工具调用
2025-08-08 21:22:23.236 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:glm-z1-flash
2025-08-08 21:25:46.990 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 21:25:46.990 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: https://open.bigmodel.cn/api/paas/v4/
2025-08-08 21:25:46.990 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: GLM-4.5-Air
2025-08-08 21:25:47.014 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 21:30:00.002 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 21:30:00.002 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: https://open.bigmodel.cn/api/paas/v4/
2025-08-08 21:30:00.002 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: GLM-4.5-AirX
2025-08-08 21:30:00.033 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 21:30:04.986 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 437c8d30-1e60-4c96-80c9-8daa4b7dbc6f。清空历史记录。
2025-08-08 21:30:14.664 | INFO     | core.session:process_inactive_sessions:487 - 检测到 1 个不活动会话，将执行登出: admin
2025-08-08 21:30:14.664 | INFO     | core.session:process_inactive_sessions:493 - APScheduler: 用户 'admin' (会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708) 因不活动被自动登出。
2025-08-08 21:30:14.664 | INFO     | core.session:process_inactive_sessions:495 - APScheduler: 尝试关闭用户 'admin' 的不活动WebSocket连接。
2025-08-08 21:30:14.694 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:30:14.695 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 437c8d30-1e60-4c96-80c9-8daa4b7dbc6f, 查询: 打开品柞项目
2025-08-08 21:30:14.695 | ERROR    | sse_proxy.sse2websocket1:run:307 - WebSocket 错误 (会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708): WebSocket is not connected. Need to call "accept" first.
2025-08-08 21:30:14.695 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:30:14.695 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:30:15.213 | INFO     | sse_proxy.sse2websocket1:_handle_stream:146 - 停止信号收到，中止流处理
2025-08-08 21:30:15.213 | ERROR    | sse_proxy.sse2websocket1:_send_event_to_websocket:48 - WebSocket 发送失败: Cannot call "send" once a close message has been sent.
2025-08-08 21:30:15.213 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:30:35.136 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: c07fe7b0-cac7-4726-b88d-6f8b3388c708, IP: 240e:3a1:7d0:ab80::e7) 登录/状态更新成功。
2025-08-08 21:30:35.137 | INFO     | api.route:login:69 - 用户 'admin' (IP: 240e:3a1:7d0:ab80::e7, Session: c07fe7b0-cac7-4726-b88d-6f8b3388c708) 登录成功。
2025-08-08 21:30:35.287 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: c07fe7b0-cac7-4726-b88d-6f8b3388c708) 的 WebSocket 已连接并关联。
2025-08-08 21:30:35.357 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-08 21:31:08.791 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 21:31:08.791 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: https://open.bigmodel.cn/api/paas/v4/
2025-08-08 21:31:08.792 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: GLM-4.5-AirX
2025-08-08 21:31:08.820 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 21:31:12.872 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 2ebf8af3-1193-4741-acd4-391c19d7128b。清空历史记录。
2025-08-08 21:31:14.690 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:31:14.690 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 2ebf8af3-1193-4741-acd4-391c19d7128b, 查询: 打开品柞项目
2025-08-08 21:31:14.690 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:31:39.673 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:31:39.673 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 2ebf8af3-1193-4741-acd4-391c19d7128b, 查询: 继续
2025-08-08 21:31:39.674 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:31:42.012 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_17a5668727f347c9a781637e', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user": "admin", "project_name": "品柞项目"}'}}]
2025-08-08 21:31:42.012 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user": "admin", "project_name": "品柞项目"}
2025-08-08 21:31:42.059 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='品柞项目', 年份='None'
2025-08-08 21:31:42.060 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 21:31:42.071 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 0 个项目: []
2025-08-08 21:31:42.071 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:785 - 使用向量检索辅助判断，候选项目数: 18
2025-08-08 21:31:42.071 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 21:31:42.279 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-3 结果: [('示例项目', 0.6003121698686301), ('映月扩第三台主变工程可行性研究报告及附图', 0.3915498928331109), ('白衣河输变电工程初设收口版', 0.38743098869632686)]
2025-08-08 21:31:42.286 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:32:05.482 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:32:05.482 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 2ebf8af3-1193-4741-acd4-391c19d7128b, 查询: 使用品柞搜索
2025-08-08 21:32:05.482 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:32:25.340 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:32:25.340 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 2ebf8af3-1193-4741-acd4-391c19d7128b, 查询: ？
2025-08-08 21:32:25.340 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:32:27.157 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_7343f3da1a554a79b41bc58a', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user": "admin", "project_name": "品柞"}'}}]
2025-08-08 21:32:27.157 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user": "admin", "project_name": "品柞"}
2025-08-08 21:32:27.203 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='品柞', 年份='None'
2025-08-08 21:32:27.203 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 21:32:27.215 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:767 - 模糊匹配查询到 0 个项目: []
2025-08-08 21:32:27.215 | DEBUG    | my_mcp_tools.mcp_tools:query_project_files:785 - 使用向量检索辅助判断，候选项目数: 18
2025-08-08 21:32:27.215 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 21:32:27.416 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-3 结果: [('扬州品祚扩主变', 0.39976082078742314), ('示例项目', 0.35856153711401106), ('丹华初设', 0.2828840864497282)]
2025-08-08 21:32:27.423 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:32:41.723 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:32:41.723 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 2ebf8af3-1193-4741-acd4-391c19d7128b, 查询: 1
2025-08-08 21:32:41.723 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:32:42.952 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_6b7b842f8b6d4e3fa2d1adc9', 'type': 'function', 'function': {'name': 'query_project_files', 'arguments': '{"user": "admin", "project_name": "扬州品祚扩主变"}'}}]
2025-08-08 21:32:42.952 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_project_files with args: {"user": "admin", "project_name": "扬州品祚扩主变"}
2025-08-08 21:32:42.994 | INFO     | my_mcp_tools.mcp_tools:query_project_files:738 - 工具调用 (新版): query_project_files, 项目关键字='扬州品祚扩主变', 年份='None'
2025-08-08 21:32:42.994 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? with params: ['项目文件']
2025-08-08 21:32:43.009 | INFO     | my_mcp_tools.mcp_tools:query_project_files:756 - 精确匹配到项目: '扬州品祚扩主变'
2025-08-08 21:32:43.010 | DEBUG    | database.document_service:_db_query:526 - 执行数据库查询: SELECT * FROM indexed_files WHERE document_type = ? AND json_extract(metadata, '$.project_name') = ? with params: ['项目文件', '扬州品祚扩主变']
2025-08-08 21:32:43.011 | INFO     | core.session:update_opened_dir:379 - 用户 'admin' 的工作目录已更新为 '扬州品祚扩主变'，包含 20 个文件。
2025-08-08 21:32:43.011 | INFO     | core.session:update_opened_dir:399 - 已向用户 'admin' 发送工作目录更新通知。
2025-08-08 21:32:43.017 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:33:10.984 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:33:10.985 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 2ebf8af3-1193-4741-acd4-391c19d7128b, 查询: 打开电网接线图
2025-08-08 21:33:10.985 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:33:17.560 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:33:17.560 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 2ebf8af3-1193-4741-acd4-391c19d7128b, 查询: 1
2025-08-08 21:33:17.560 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:33:20.701 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_eb38b5a4d13c417392211727', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2024/扬州品祚扩主变/送审/320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）.pdf", "file_category": "图纸图形文档"}'}}]
2025-08-08 21:33:20.701 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2024/扬州品祚扩主变/送审/320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）.pdf", "file_category": "图纸图形文档"}
2025-08-08 21:33:20.748 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/扬州品祚扩主变/送审/320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）.pdf', Category: '图纸图形文档'
2025-08-08 21:33:20.748 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:692 - 2024/扬州品祚扩主变/送审/320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）.pdf 为llm暂不支持的文件类型。
2025-08-08 21:33:20.749 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/扬州品祚扩主变/送审/320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）.pdf' (token: 63dc1ed3d58446a7933744f5fa6d5489), 有效期至: Sat Aug  9 05:33:20 2025
2025-08-08 21:33:20.749 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/扬州品祚扩主变/送审/320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）.pdf' 已在会话中注册, token: 63dc1ed3d58446a7933744f5fa6d5489
2025-08-08 21:33:20.754 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:33:20.790 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/63dc1ed3d58446a7933744f5fa6d5489/320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）.pdf
2025-08-08 21:33:20.970 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）_72fc5957.pdf' 与Token关联文件名 '320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 21:33:20.970 | DEBUG    | api.route:download_file_via_token:186 - Token '63dc1ed3d58446a7933744f5fa6d5489' 验证成功。准备下载文件: '320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/扬州品祚扩主变/送审/320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）.pdf', URL文件名: '320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）_72fc5957.pdf')
2025-08-08 21:33:20.972 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 '320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）_72fc5957.pdf' 与Token关联文件名 '320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 21:33:20.972 | DEBUG    | api.route:download_file_via_token:186 - Token '63dc1ed3d58446a7933744f5fa6d5489' 验证成功。准备下载文件: '320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/扬州品祚扩主变/送审/320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）.pdf', URL文件名: '320-B6411C-A-03 2023年本工程周边220kV电网接线图（签名件）_72fc5957.pdf')
2025-08-08 21:33:37.445 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:33:37.446 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 2ebf8af3-1193-4741-acd4-391c19d7128b, 查询: 再看下材料清册
2025-08-08 21:33:37.446 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:33:40.087 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_2dae3dd1f1a24462bed5ef28', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "2024/扬州品祚扩主变/送审/B6411C-A-02 主要设备材料清册（签名件）.pdf", "file_category": "普通文档"}'}}]
2025-08-08 21:33:40.087 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "2024/扬州品祚扩主变/送审/B6411C-A-02 主要设备材料清册（签名件）.pdf", "file_category": "普通文档"}
2025-08-08 21:33:40.130 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '2024/扬州品祚扩主变/送审/B6411C-A-02 主要设备材料清册（签名件）.pdf', Category: '普通文档'
2025-08-08 21:33:40.130 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/Projects1/2024/扬州品祚扩主变/送审/B6411C-A-02 主要设备材料清册（签名件）.pdf (相对路径: 2024/扬州品祚扩主变/送审/B6411C-A-02 主要设备材料清册（签名件）.pdf)，分隔符: '	'
2025-08-08 21:33:41.722 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: B6411C-A-02 主要设备材料清册（签名件）.pdf, 内容长度: 25197
2025-08-08 21:33:41.722 | INFO     | my_mcp_tools.mcp_tools:read_project_file:706 - 从文件 2024/扬州品祚扩主变/送审/B6411C-A-02 主要设备材料清册（签名件）.pdf成功读取（预览100字）:检索号：B6411C
编 号：B6411C-A-02
江苏扬州品祚 220 千伏变电站第二台主变扩建
工程
初步设计
综合
主要设备材料清册
江苏科能电力工程咨询有限公司
工程咨询证书 甲级 1120
2025-08-08 21:33:41.722 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '2024/扬州品祚扩主变/送审/B6411C-A-02 主要设备材料清册（签名件）.pdf' (token: 6feb95d0a05a4b29bf6102ad60f28c73), 有效期至: Sat Aug  9 05:33:41 2025
2025-08-08 21:33:41.723 | DEBUG    | my_mcp_tools.mcp_tools:read_project_file:719 - 文件 '2024/扬州品祚扩主变/送审/B6411C-A-02 主要设备材料清册（签名件）.pdf' 已在会话中注册, token: 6feb95d0a05a4b29bf6102ad60f28c73
2025-08-08 21:33:41.734 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:33:41.766 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/6feb95d0a05a4b29bf6102ad60f28c73/B6411C-A-02 主要设备材料清册（签名件）.pdf
2025-08-08 21:33:41.946 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'B6411C-A-02 主要设备材料清册（签名件）_d38c5226.pdf' 与Token关联文件名 'B6411C-A-02 主要设备材料清册（签名件）.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 21:33:41.946 | DEBUG    | api.route:download_file_via_token:186 - Token '6feb95d0a05a4b29bf6102ad60f28c73' 验证成功。准备下载文件: 'B6411C-A-02 主要设备材料清册（签名件）.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/扬州品祚扩主变/送审/B6411C-A-02 主要设备材料清册（签名件）.pdf', URL文件名: 'B6411C-A-02 主要设备材料清册（签名件）_d38c5226.pdf')
2025-08-08 21:33:41.948 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'B6411C-A-02 主要设备材料清册（签名件）_d38c5226.pdf' 与Token关联文件名 'B6411C-A-02 主要设备材料清册（签名件）.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 21:33:41.948 | DEBUG    | api.route:download_file_via_token:186 - Token '6feb95d0a05a4b29bf6102ad60f28c73' 验证成功。准备下载文件: 'B6411C-A-02 主要设备材料清册（签名件）.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/Projects1/2024/扬州品祚扩主变/送审/B6411C-A-02 主要设备材料清册（签名件）.pdf', URL文件名: 'B6411C-A-02 主要设备材料清册（签名件）_d38c5226.pdf')
2025-08-08 21:34:24.983 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:34:24.983 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 2ebf8af3-1193-4741-acd4-391c19d7128b, 查询: 找下二次的规范
2025-08-08 21:34:24.983 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:34:46.614 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:34:46.614 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708, 对话ID: 2ebf8af3-1193-4741-acd4-391c19d7128b, 查询: ？
2025-08-08 21:34:46.614 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:34:51.580 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_86bda8d041e143b1b875f11f', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "二次", "knowledge_base_name": "二次", "top_k": 10}'}}]
2025-08-08 21:34:51.580 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "二次", "knowledge_base_name": "二次", "top_k": 10}
2025-08-08 21:34:51.623 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '二次...', top_k: 10
2025-08-08 21:34:51.623 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:34:51.982 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:34:51.982 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='二次...', top_k=10
2025-08-08 21:34:52.674 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 10 条结果。
2025-08-08 21:34:52.681 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:35:17.680 | DEBUG    | core.session:logout_user:152 - 用户 'admin' (会话: c07fe7b0-cac7-4726-b88d-6f8b3388c708) 已从状态管理器登出。
2025-08-08 21:35:17.680 | DEBUG    | core.session:logout_user:154 - 用户 'admin' 登出时，其WebSocket连接处于活动状态，将尝试关闭。
2025-08-08 21:35:17.746 | INFO     | api.route:logout:80 - HTTP会话已清除 (用户: admin)。
2025-08-08 21:35:17.747 | DEBUG    | sse_proxy.sse2websocket1:run:304 - WebSocket 会话 c07fe7b0-cac7-4726-b88d-6f8b3388c708 用户 admin 断开连接
2025-08-08 21:35:17.747 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:35:49.938 | WARNING  | api.admin:admin_access:29 - Admin access denied for user 'None' from IP '240e:3a1:7d0:ab80::e7'. Reason: user is not admin or IP mismatch (expected N/A).
2025-08-08 21:36:03.593 | DEBUG    | core.auth:verify_active_session:24 - verify_active_session: HTTP session中缺少用户名或session_id。
2025-08-08 21:36:06.628 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: 2329efb8-466e-4b4b-b503-81eee37c442a, IP: 240e:3a1:7d0:ab80::e7) 登录/状态更新成功。
2025-08-08 21:36:06.628 | INFO     | api.route:login:69 - 用户 'admin' (IP: 240e:3a1:7d0:ab80::e7, Session: 2329efb8-466e-4b4b-b503-81eee37c442a) 登录成功。
2025-08-08 21:36:06.724 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: 2329efb8-466e-4b4b-b503-81eee37c442a) 的 WebSocket 已连接并关联。
2025-08-08 21:36:06.793 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-08 21:36:10.972 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 21:36:20.046 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 21:36:20.046 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: https://open.bigmodel.cn/api/paas/v4/
2025-08-08 21:36:20.046 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: GLM-4.5
2025-08-08 21:36:20.071 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 21:36:31.621 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:36:31.621 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2329efb8-466e-4b4b-b503-81eee37c442a, 对话ID: 3212ed27-f8b3-4a5c-86d9-9b6468c7f668, 查询: 找一下二次的规范
2025-08-08 21:36:31.621 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-AirX
2025-08-08 21:36:53.779 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 21:36:53.779 | INFO     | api.admin:update_admin_config:164 - 从服务商 'zhipu' 的预设中加载了 API Key。
2025-08-08 21:36:53.779 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: https://open.bigmodel.cn/api/paas/v4/
2025-08-08 21:36:53.779 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: GLM-4.5
2025-08-08 21:36:53.779 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******Yj8a
2025-08-08 21:36:53.804 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-08 21:37:04.047 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: 8d7b67d1-5843-46e3-addf-9cfd3250d8df。清空历史记录。
2025-08-08 21:37:06.020 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:37:06.020 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2329efb8-466e-4b4b-b503-81eee37c442a, 对话ID: 8d7b67d1-5843-46e3-addf-9cfd3250d8df, 查询: 找一下二次的规范
2025-08-08 21:37:06.020 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:37:08.863 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_3045a6e95ca94b2ab47a7048', 'type': 'function', 'function': {'name': 'open_specification_files', 'arguments': '{"user": "admin", "query_spec_filename": "/ALL", "category": "二次", "read_file": false, "top_n": 10}'}}]
2025-08-08 21:37:08.863 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: open_specification_files with args: {"user": "admin", "query_spec_filename": "/ALL", "category": "二次", "read_file": false, "top_n": 10}
2025-08-08 21:37:08.910 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:835 - 工具调用: open_specification_files, 查询: '/ALL', 类别: '二次', 读取文件: False, Top N: 10
2025-08-08 21:37:08.911 | DEBUG    | database.document_service:_db_query:550 - 查询规范文件分类 (适配器): 二次
2025-08-08 21:37:08.911 | INFO     | database.document_service:_db_query:571 - 查询到 '二次' 分类的规范共 16 条
2025-08-08 21:37:08.911 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:857 - 用户请求 '二次' 类别下的所有规范。
2025-08-08 21:37:08.917 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:37:59.709 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:37:59.709 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2329efb8-466e-4b4b-b503-81eee37c442a, 对话ID: 8d7b67d1-5843-46e3-addf-9cfd3250d8df, 查询: 读取下15，告诉我表计的FS级一般有多少，怎么规定的
2025-08-08 21:37:59.709 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:38:01.807 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_f1ec2065771c48ffba0332cf', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "二次/QGDW10347-2023电能计量装置通用设计/QGDW10347-2023电能计量装置通用设计.pdf", "file_category": "普通文档"}'}}]
2025-08-08 21:38:01.807 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "二次/QGDW10347-2023电能计量装置通用设计/QGDW10347-2023电能计量装置通用设计.pdf", "file_category": "普通文档"}
2025-08-08 21:38:01.853 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '二次/QGDW10347-2023电能计量装置通用设计/QGDW10347-2023电能计量装置通用设计.pdf', Category: '普通文档'
2025-08-08 21:38:01.853 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/二次/QGDW10347-2023电能计量装置通用设计/QGDW10347-2023电能计量装置通用设计.pdf
2025-08-08 21:38:01.858 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:38:04.421 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_c27ad2beae114e5e9b57d304', 'type': 'function', 'function': {'name': 'open_specification_files', 'arguments': '{"user": "admin", "query_spec_filename": "QGDW10347-2023", "category": "二次", "read_file": false, "top_n": 5}'}}]
2025-08-08 21:38:04.421 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: open_specification_files with args: {"user": "admin", "query_spec_filename": "QGDW10347-2023", "category": "二次", "read_file": false, "top_n": 5}
2025-08-08 21:38:04.467 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:835 - 工具调用: open_specification_files, 查询: 'QGDW10347-2023', 类别: '二次', 读取文件: False, Top N: 5
2025-08-08 21:38:04.468 | DEBUG    | database.document_service:_db_query:550 - 查询规范文件分类 (适配器): 二次
2025-08-08 21:38:04.468 | INFO     | database.document_service:_db_query:571 - 查询到 '二次' 分类的规范共 16 条
2025-08-08 21:38:04.468 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 21:38:04.689 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-5 结果: [('QGDW10347-2023电能计量装置通用设计', 0.7368086926209388), ('QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范', 0.5869236674900942), ('QGDW 12301-2023 变电站硬压板在线监测技术规范', 0.5797171644856343), ('QGDW 10536-2021-变压器油中溶解气体在线监测装置技术规范', 0.5424756269227443), ('QGDW 11486-2022 继电保护和安全自动装置验收规范', 0.5407837680696097)]
2025-08-08 21:38:04.695 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:38:06.130 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_00fb135d94d64923ab891c9a', 'type': 'function', 'function': {'name': 'read_project_file', 'arguments': '{"user": "admin", "relative_file_path": "二次/QGDW10347-2023电能计量装置通用设计/QGDW10347-2023电能计量装置通用设计.pdf", "file_category": "普通文档"}'}}]
2025-08-08 21:38:06.131 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: read_project_file with args: {"user": "admin", "relative_file_path": "二次/QGDW10347-2023电能计量装置通用设计/QGDW10347-2023电能计量装置通用设计.pdf", "file_category": "普通文档"}
2025-08-08 21:38:06.174 | INFO     | my_mcp_tools.mcp_tools:read_project_file:647 - 工具调用 (LLM): read_project_file. User: 'admin', Path: '二次/QGDW10347-2023电能计量装置通用设计/QGDW10347-2023电能计量装置通用设计.pdf', Category: '普通文档'
2025-08-08 21:38:06.174 | ERROR    | my_mcp_tools.mcp_tools:read_project_file:651 - 请求的文件路径不存在: /media/zhouxiang/FC7C74827C743A0A/Projects1/二次/QGDW10347-2023电能计量装置通用设计/QGDW10347-2023电能计量装置通用设计.pdf
2025-08-08 21:38:06.179 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:38:07.463 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_66e42012bddc489b8456ad08', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "电能计量装置 FS级 精度等级", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:38:07.463 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "电能计量装置 FS级 精度等级", "knowledge_base_name": "二次"}
2025-08-08 21:38:07.505 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '电能计量装置 FS级 精度等级...', top_k: 5
2025-08-08 21:38:07.505 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:38:07.608 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:38:07.608 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='电能计量装置 FS级 精度等级...', top_k=5
2025-08-08 21:38:07.787 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 4 条结果。
2025-08-08 21:38:07.794 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:38:09.337 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_0405c84594c34474afac1828', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "FS级表计 电能表 精度等级", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:38:09.337 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "FS级表计 电能表 精度等级", "knowledge_base_name": "二次"}
2025-08-08 21:38:09.386 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: 'FS级表计 电能表 精度等级...', top_k: 5
2025-08-08 21:38:09.386 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:38:09.464 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:38:09.464 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='FS级表计 电能表 精度等级...', top_k=5
2025-08-08 21:38:09.622 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 3 条结果。
2025-08-08 21:38:09.629 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:38:19.989 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_4fe06963001a49e0b70939a5', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "FS 电流互感器 精度等级", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:38:19.989 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "FS 电流互感器 精度等级", "knowledge_base_name": "二次"}
2025-08-08 21:38:20.031 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: 'FS 电流互感器 精度等级...', top_k: 5
2025-08-08 21:38:20.031 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:38:20.401 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:38:20.401 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='FS 电流互感器 精度等级...', top_k=5
2025-08-08 21:38:20.564 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 3 条结果。
2025-08-08 21:38:20.571 | WARNING  | sse_proxy.sse2websocket1:_handle_stream:115 - 递归深度超过最大限制(5)，终止工具调用
2025-08-08 21:38:31.664 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:38:31.664 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2329efb8-466e-4b4b-b503-81eee37c442a, 对话ID: 8d7b67d1-5843-46e3-addf-9cfd3250d8df, 查询: 读取规范15
2025-08-08 21:38:31.665 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:38:34.330 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_0cea249bd92d4914a0b1adde', 'type': 'function', 'function': {'name': 'open_specification_files', 'arguments': '{"user": "admin", "query_spec_filename": "QGDW10347-2023电能计量装置通用设计", "category": "二次", "read_file": true, "top_n": 1}'}}]
2025-08-08 21:38:34.330 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: open_specification_files with args: {"user": "admin", "query_spec_filename": "QGDW10347-2023电能计量装置通用设计", "category": "二次", "read_file": true, "top_n": 1}
2025-08-08 21:38:34.372 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:835 - 工具调用: open_specification_files, 查询: 'QGDW10347-2023电能计量装置通用设计', 类别: '二次', 读取文件: True, Top N: 1
2025-08-08 21:38:34.373 | DEBUG    | database.document_service:_db_query:550 - 查询规范文件分类 (适配器): 二次
2025-08-08 21:38:34.373 | INFO     | database.document_service:_db_query:571 - 查询到 '二次' 分类的规范共 16 条
2025-08-08 21:38:34.373 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 21:38:34.566 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-1 结果: [('QGDW10347-2023电能计量装置通用设计', 0.9999999999999999)]
2025-08-08 21:38:34.566 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:882 - 最匹配文件 '二次/QGDW10347-2023电能计量装置通用设计/QGDW10347-2023电能计量装置通用设计.pdf' 相似度(1.0000) > 0.7，准备读取内容。
2025-08-08 21:38:34.567 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/QGDW10347-2023电能计量装置通用设计/QGDW10347-2023电能计量装置通用设计.pdf (相对路径: 二次/QGDW10347-2023电能计量装置通用设计/QGDW10347-2023电能计量装置通用设计.pdf)，分隔符: '
'
2025-08-08 21:40:54.156 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: QGDW10347-2023电能计量装置通用设计.pdf, 内容长度: 917475
2025-08-08 21:40:54.156 | WARNING  | my_mcp_tools.mcp_tools:open_specification_files:901 - 文件 '二次/QGDW10347-2023电能计量装置通用设计/QGDW10347-2023电能计量装置通用设计.pdf' 内容过长，可能超过模型上下文窗口。
2025-08-08 21:40:54.157 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '二次/QGDW10347-2023电能计量装置通用设计/QGDW10347-2023电能计量装置通用设计.pdf' (token: abd6d5a35c304ca6965c9bd5662ec81e), 有效期至: Sat Aug  9 05:40:54 2025
2025-08-08 21:40:54.160 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:40:54.160 | INFO     | sse_proxy.sse2websocket1:run:265 - 会话 2329efb8-466e-4b4b-b503-81eee37c442a 用户 admin 中止响应流任务
2025-08-08 21:40:54.167 | ERROR    | sse_proxy.sse2websocket1:_execute_tool_calls:203 - 执行工具 'open_specification_files' 时发生异常: 
2025-08-08 21:40:54.167 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:40:54.198 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/abd6d5a35c304ca6965c9bd5662ec81e/QGDW10347-2023电能计量装置通用设计.pdf
2025-08-08 21:40:54.381 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'QGDW10347-2023电能计量装置通用设计_78184f25.pdf' 与Token关联文件名 'QGDW10347-2023电能计量装置通用设计.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 21:40:54.382 | DEBUG    | api.route:download_file_via_token:186 - Token 'abd6d5a35c304ca6965c9bd5662ec81e' 验证成功。准备下载文件: 'QGDW10347-2023电能计量装置通用设计.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/规程规范/二次/QGDW10347-2023电能计量装置通用设计/QGDW10347-2023电能计量装置通用设计.pdf', URL文件名: 'QGDW10347-2023电能计量装置通用设计_78184f25.pdf')
2025-08-08 21:40:54.383 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'QGDW10347-2023电能计量装置通用设计_78184f25.pdf' 与Token关联文件名 'QGDW10347-2023电能计量装置通用设计.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 21:40:54.383 | DEBUG    | api.route:download_file_via_token:186 - Token 'abd6d5a35c304ca6965c9bd5662ec81e' 验证成功。准备下载文件: 'QGDW10347-2023电能计量装置通用设计.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/规程规范/二次/QGDW10347-2023电能计量装置通用设计/QGDW10347-2023电能计量装置通用设计.pdf', URL文件名: 'QGDW10347-2023电能计量装置通用设计_78184f25.pdf')
2025-08-08 21:40:55.101 | INFO     | sse_proxy.sse2websocket1:_handle_stream:146 - 停止信号收到，中止流处理
2025-08-08 21:42:00.995 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:42:00.996 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2329efb8-466e-4b4b-b503-81eee37c442a, 对话ID: 8d7b67d1-5843-46e3-addf-9cfd3250d8df, 查询: 打开规范2
2025-08-08 21:42:00.996 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:42:03.864 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_fccbd41535b3489989eb6049', 'type': 'function', 'function': {'name': 'open_specification_files', 'arguments': '{"user": "admin", "query_spec_filename": "DL∕T 448-2016 电能计量装置技术管理规程", "category": "二次", "read_file": true, "top_n": 1}'}}]
2025-08-08 21:42:03.864 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: open_specification_files with args: {"user": "admin", "query_spec_filename": "DL∕T 448-2016 电能计量装置技术管理规程", "category": "二次", "read_file": true, "top_n": 1}
2025-08-08 21:42:03.914 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:835 - 工具调用: open_specification_files, 查询: 'DL∕T 448-2016 电能计量装置技术管理规程', 类别: '二次', 读取文件: True, Top N: 1
2025-08-08 21:42:03.914 | DEBUG    | database.document_service:_db_query:550 - 查询规范文件分类 (适配器): 二次
2025-08-08 21:42:03.915 | INFO     | database.document_service:_db_query:571 - 查询到 '二次' 分类的规范共 16 条
2025-08-08 21:42:03.915 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 21:42:04.124 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-1 结果: [('DL∕T 448-2016 电能计量装置技术管理规程', 1.0)]
2025-08-08 21:42:04.124 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:882 - 最匹配文件 '二次/DL∕T 448-2016 电能计量装置技术管理规程/DL∕T 448-2016 电能计量装置技术管理规程.pdf' 相似度(1.0000) > 0.7，准备读取内容。
2025-08-08 21:42:04.125 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/DL∕T 448-2016 电能计量装置技术管理规程/DL∕T 448-2016 电能计量装置技术管理规程.pdf (相对路径: 二次/DL∕T 448-2016 电能计量装置技术管理规程/DL∕T 448-2016 电能计量装置技术管理规程.pdf)，分隔符: '
'
2025-08-08 21:42:04.191 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: DL∕T 448-2016 电能计量装置技术管理规程.pdf, 内容长度: 153
2025-08-08 21:42:04.191 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '二次/DL∕T 448-2016 电能计量装置技术管理规程/DL∕T 448-2016 电能计量装置技术管理规程.pdf' (token: 5ae1b35de17a48fd937d9cd2debaf285), 有效期至: Sat Aug  9 05:42:04 2025
2025-08-08 21:42:04.198 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:42:04.234 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/5ae1b35de17a48fd937d9cd2debaf285/DL∕T 448-2016 电能计量装置技术管理规程.pdf
2025-08-08 21:42:04.415 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'DL∕T 448-2016 电能计量装置技术管理规程_e9132dee.pdf' 与Token关联文件名 'DL∕T 448-2016 电能计量装置技术管理规程.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 21:42:04.415 | DEBUG    | api.route:download_file_via_token:186 - Token '5ae1b35de17a48fd937d9cd2debaf285' 验证成功。准备下载文件: 'DL∕T 448-2016 电能计量装置技术管理规程.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/规程规范/二次/DL∕T 448-2016 电能计量装置技术管理规程/DL∕T 448-2016 电能计量装置技术管理规程.pdf', URL文件名: 'DL∕T 448-2016 电能计量装置技术管理规程_e9132dee.pdf')
2025-08-08 21:42:04.417 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'DL∕T 448-2016 电能计量装置技术管理规程_e9132dee.pdf' 与Token关联文件名 'DL∕T 448-2016 电能计量装置技术管理规程.pdf' 不匹配。将使用Token关联文件名。
2025-08-08 21:42:04.417 | DEBUG    | api.route:download_file_via_token:186 - Token '5ae1b35de17a48fd937d9cd2debaf285' 验证成功。准备下载文件: 'DL∕T 448-2016 电能计量装置技术管理规程.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/规程规范/二次/DL∕T 448-2016 电能计量装置技术管理规程/DL∕T 448-2016 电能计量装置技术管理规程.pdf', URL文件名: 'DL∕T 448-2016 电能计量装置技术管理规程_e9132dee.pdf')
2025-08-08 21:42:05.556 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_fcc2ec2755b24da7b2beb7c0', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "FS级 电能表 电流互感器 精度等级规定", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:42:05.556 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "FS级 电能表 电流互感器 精度等级规定", "knowledge_base_name": "二次"}
2025-08-08 21:42:05.612 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: 'FS级 电能表 电流互感器 精度等级规定...', top_k: 5
2025-08-08 21:42:05.612 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:42:05.707 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:42:05.707 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='FS级 电能表 电流互感器 精度等级规定...', top_k=5
2025-08-08 21:42:05.874 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 3 条结果。
2025-08-08 21:42:05.886 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:42:08.276 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_36f6d9770e5a4226afb623f3', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "FS级 表计 电流互感器", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:42:08.276 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "FS级 表计 电流互感器", "knowledge_base_name": "二次"}
2025-08-08 21:42:08.320 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: 'FS级 表计 电流互感器...', top_k: 5
2025-08-08 21:42:08.320 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:42:08.422 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:42:08.422 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='FS级 表计 电流互感器...', top_k=5
2025-08-08 21:42:08.606 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 5 条结果。
2025-08-08 21:42:08.614 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:42:12.056 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_dba184f770d64a80b859bbcd', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "仪表保安系数 FS 数值 规定", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:42:12.056 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "仪表保安系数 FS 数值 规定", "knowledge_base_name": "二次"}
2025-08-08 21:42:12.100 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '仪表保安系数 FS 数值 规定...', top_k: 5
2025-08-08 21:42:12.100 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:42:12.178 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:42:12.178 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='仪表保安系数 FS 数值 规定...', top_k=5
2025-08-08 21:42:12.357 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 5 条结果。
2025-08-08 21:42:12.364 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:43:39.501 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:43:39.501 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2329efb8-466e-4b4b-b503-81eee37c442a, 对话ID: 8d7b67d1-5843-46e3-addf-9cfd3250d8df, 查询: 再帮我找下二次的规范，压变的计量电压回路是否设置空开
2025-08-08 21:43:39.502 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:43:42.416 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_04ad38e516f741629776ae29', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "电压互感器 计量电压回路 空开 空气开关 保护", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:43:42.416 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "电压互感器 计量电压回路 空开 空气开关 保护", "knowledge_base_name": "二次"}
2025-08-08 21:43:42.459 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '电压互感器 计量电压回路 空开 空气开关 保护...', top_k: 5
2025-08-08 21:43:42.459 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:43:42.552 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:43:42.552 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='电压互感器 计量电压回路 空开 空气开关 保护...', top_k=5
2025-08-08 21:43:42.749 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 4 条结果。
2025-08-08 21:43:42.756 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:44:28.139 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:44:28.140 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2329efb8-466e-4b4b-b503-81eee37c442a, 对话ID: 8d7b67d1-5843-46e3-addf-9cfd3250d8df, 查询: 读取下DL/T448 看看相关的规定
2025-08-08 21:44:28.140 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:44:31.827 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_b62b128c190a409d85398e32', 'type': 'function', 'function': {'name': 'open_specification_files', 'arguments': '{"user": "admin", "query_spec_filename": "DL∕T 448-2016 电能计量装置技术管理规程", "category": "二次", "read_file": true, "top_n": 1}'}}]
2025-08-08 21:44:31.827 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: open_specification_files with args: {"user": "admin", "query_spec_filename": "DL∕T 448-2016 电能计量装置技术管理规程", "category": "二次", "read_file": true, "top_n": 1}
2025-08-08 21:44:31.872 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:835 - 工具调用: open_specification_files, 查询: 'DL∕T 448-2016 电能计量装置技术管理规程', 类别: '二次', 读取文件: True, Top N: 1
2025-08-08 21:44:31.872 | DEBUG    | database.document_service:_db_query:550 - 查询规范文件分类 (适配器): 二次
2025-08-08 21:44:31.873 | INFO     | database.document_service:_db_query:571 - 查询到 '二次' 分类的规范共 16 条
2025-08-08 21:44:31.873 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 21:44:32.093 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-1 结果: [('DL∕T 448-2016 电能计量装置技术管理规程', 1.0)]
2025-08-08 21:44:32.093 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:882 - 最匹配文件 '二次/DL∕T 448-2016 电能计量装置技术管理规程/DL∕T 448-2016 电能计量装置技术管理规程.pdf' 相似度(1.0000) > 0.7，准备读取内容。
2025-08-08 21:44:32.093 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/DL∕T 448-2016 电能计量装置技术管理规程/DL∕T 448-2016 电能计量装置技术管理规程.pdf (相对路径: 二次/DL∕T 448-2016 电能计量装置技术管理规程/DL∕T 448-2016 电能计量装置技术管理规程.pdf)，分隔符: '
'
2025-08-08 21:44:32.143 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: DL∕T 448-2016 电能计量装置技术管理规程.pdf, 内容长度: 153
2025-08-08 21:44:32.144 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '二次/DL∕T 448-2016 电能计量装置技术管理规程/DL∕T 448-2016 电能计量装置技术管理规程.pdf' (token: 6151a6ed149545a09c0854b0df7b4cfc), 有效期至: Sat Aug  9 05:44:32 2025
2025-08-08 21:44:32.150 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:44:34.512 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_1a6d5fc1906a4288a7c64e48', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "DL/T 448-2016 电压互感器 计量电压回路 空开 自动开关", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:44:34.512 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "DL/T 448-2016 电压互感器 计量电压回路 空开 自动开关", "knowledge_base_name": "二次"}
2025-08-08 21:44:34.556 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: 'DL/T 448-2016 电压互感器 计量电压回路 空开 自动开关...', top_k: 5
2025-08-08 21:44:34.556 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:44:34.639 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:44:34.639 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='DL/T 448-2016 电压互感器 计量电压回路 空开 自动开关...', top_k=5
2025-08-08 21:44:34.825 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 5 条结果。
2025-08-08 21:44:34.831 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:44:39.420 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_307807b341244549883c510a', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "DL/T 448 电能计量装置 电压回路 保护 熔断器", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:44:39.420 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "DL/T 448 电能计量装置 电压回路 保护 熔断器", "knowledge_base_name": "二次"}
2025-08-08 21:44:39.463 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: 'DL/T 448 电能计量装置 电压回路 保护 熔断器...', top_k: 5
2025-08-08 21:44:39.463 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:44:39.540 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:44:39.540 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='DL/T 448 电能计量装置 电压回路 保护 熔断器...', top_k=5
2025-08-08 21:44:39.722 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 5 条结果。
2025-08-08 21:44:39.728 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:44:43.500 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_6efe41314fc94b52b9d82dbb', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "DL/T 448 电能计量装置 电压互感器 二次回路 保护", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:44:43.500 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "DL/T 448 电能计量装置 电压互感器 二次回路 保护", "knowledge_base_name": "二次"}
2025-08-08 21:44:43.543 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: 'DL/T 448 电能计量装置 电压互感器 二次回路 保护...', top_k: 5
2025-08-08 21:44:43.543 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:44:43.621 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:44:43.621 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='DL/T 448 电能计量装置 电压互感器 二次回路 保护...', top_k=5
2025-08-08 21:44:43.795 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 4 条结果。
2025-08-08 21:44:43.802 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:44:46.777 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_a3f08d2a87424e56aec7a964', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "电能计量装置 电压互感器 二次回路 熔断器 自动开关 空开", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:44:46.777 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "电能计量装置 电压互感器 二次回路 熔断器 自动开关 空开", "knowledge_base_name": "二次"}
2025-08-08 21:44:46.820 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '电能计量装置 电压互感器 二次回路 熔断器 自动开关 空开...', top_k: 5
2025-08-08 21:44:46.820 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:44:46.897 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:44:46.897 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='电能计量装置 电压互感器 二次回路 熔断器 自动开关 空开...', top_k=5
2025-08-08 21:44:47.079 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 5 条结果。
2025-08-08 21:44:47.086 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:44:49.951 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_0771b0c49a39402a9fb820d8', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "DL/T 448 电压互感器 二次回路 熔断器 自动开关", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:44:49.951 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "DL/T 448 电压互感器 二次回路 熔断器 自动开关", "knowledge_base_name": "二次"}
2025-08-08 21:44:50.004 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: 'DL/T 448 电压互感器 二次回路 熔断器 自动开关...', top_k: 5
2025-08-08 21:44:50.004 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:44:50.373 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:44:50.373 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='DL/T 448 电压互感器 二次回路 熔断器 自动开关...', top_k=5
2025-08-08 21:44:50.562 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 5 条结果。
2025-08-08 21:44:50.569 | WARNING  | sse_proxy.sse2websocket1:_handle_stream:115 - 递归深度超过最大限制(5)，终止工具调用
2025-08-08 21:44:59.153 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:44:59.154 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2329efb8-466e-4b4b-b503-81eee37c442a, 对话ID: 8d7b67d1-5843-46e3-addf-9cfd3250d8df, 查询: 继续
2025-08-08 21:44:59.154 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:45:24.766 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:45:24.766 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2329efb8-466e-4b4b-b503-81eee37c442a, 对话ID: 8d7b67d1-5843-46e3-addf-9cfd3250d8df, 查询: 使用打开规范工具去打开
2025-08-08 21:45:24.767 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:45:30.296 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_01cece4a70c94d61b2a88f59', 'type': 'function', 'function': {'name': 'open_specification_files', 'arguments': '{"user": "admin", "query_spec_filename": "DL/T 448-2016 电能计量装置技术管理规程", "category": "二次", "read_file": true, "top_n": 1}'}}]
2025-08-08 21:45:30.297 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: open_specification_files with args: {"user": "admin", "query_spec_filename": "DL/T 448-2016 电能计量装置技术管理规程", "category": "二次", "read_file": true, "top_n": 1}
2025-08-08 21:45:30.343 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:835 - 工具调用: open_specification_files, 查询: 'DL/T 448-2016 电能计量装置技术管理规程', 类别: '二次', 读取文件: True, Top N: 1
2025-08-08 21:45:30.343 | DEBUG    | database.document_service:_db_query:550 - 查询规范文件分类 (适配器): 二次
2025-08-08 21:45:30.344 | INFO     | database.document_service:_db_query:571 - 查询到 '二次' 分类的规范共 16 条
2025-08-08 21:45:30.344 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-08 21:45:30.558 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-1 结果: [('DL∕T 448-2016 电能计量装置技术管理规程', 0.9936337333763592)]
2025-08-08 21:45:30.558 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:882 - 最匹配文件 '二次/DL∕T 448-2016 电能计量装置技术管理规程/DL∕T 448-2016 电能计量装置技术管理规程.pdf' 相似度(0.9936) > 0.7，准备读取内容。
2025-08-08 21:45:30.558 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/DL∕T 448-2016 电能计量装置技术管理规程/DL∕T 448-2016 电能计量装置技术管理规程.pdf (相对路径: 二次/DL∕T 448-2016 电能计量装置技术管理规程/DL∕T 448-2016 电能计量装置技术管理规程.pdf)，分隔符: '
'
2025-08-08 21:45:30.606 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: DL∕T 448-2016 电能计量装置技术管理规程.pdf, 内容长度: 153
2025-08-08 21:45:30.606 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '二次/DL∕T 448-2016 电能计量装置技术管理规程/DL∕T 448-2016 电能计量装置技术管理规程.pdf' (token: ca302badd05542d3b6cf3e8b8c60bdc7), 有效期至: Sat Aug  9 05:45:30 2025
2025-08-08 21:45:30.613 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:45:33.164 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_439e291ff77342b88b989f47', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "DL/T 448 电能计量装置技术管理规程 电压互感器 二次回路 保护", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:45:33.164 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "DL/T 448 电能计量装置技术管理规程 电压互感器 二次回路 保护", "knowledge_base_name": "二次"}
2025-08-08 21:45:33.207 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: 'DL/T 448 电能计量装置技术管理规程 电压互感器 二次回路 保护...', top_k: 5
2025-08-08 21:45:33.207 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:45:33.285 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:45:33.285 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='DL/T 448 电能计量装置技术管理规程 电压互感器 二次回路 保护...', top_k=5
2025-08-08 21:45:33.464 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 4 条结果。
2025-08-08 21:45:33.471 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:49:10.869 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:49:10.869 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2329efb8-466e-4b4b-b503-81eee37c442a, 对话ID: 8d7b67d1-5843-46e3-addf-9cfd3250d8df, 查询: 搜下二次知识库， 关口考核点的计量电压互感器是否需要三相
2025-08-08 21:49:10.869 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:49:15.169 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_8b92d46e3db74559a0669ee1', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "关口考核点 计量电压互感器 三相 配置", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:49:15.169 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "关口考核点 计量电压互感器 三相 配置", "knowledge_base_name": "二次"}
2025-08-08 21:49:15.221 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '关口考核点 计量电压互感器 三相 配置...', top_k: 5
2025-08-08 21:49:15.221 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:49:15.314 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:49:15.314 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='关口考核点 计量电压互感器 三相 配置...', top_k=5
2025-08-08 21:49:15.515 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 4 条结果。
2025-08-08 21:49:15.521 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:49:39.131 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:49:39.132 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2329efb8-466e-4b4b-b503-81eee37c442a, 对话ID: 8d7b67d1-5843-46e3-addf-9cfd3250d8df, 查询: 继续
2025-08-08 21:49:39.132 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:49:43.946 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_41e7648c23cb42cbb0dc3d61', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "关口计量 考核点 电压互感器 三相配置 要求", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:49:43.946 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "关口计量 考核点 电压互感器 三相配置 要求", "knowledge_base_name": "二次"}
2025-08-08 21:49:43.993 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '关口计量 考核点 电压互感器 三相配置 要求...', top_k: 5
2025-08-08 21:49:43.993 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:49:44.073 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:49:44.073 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='关口计量 考核点 电压互感器 三相配置 要求...', top_k=5
2025-08-08 21:49:44.273 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 5 条结果。
2025-08-08 21:49:44.279 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:49:48.963 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_f3dc2f9d043f429b8174af1a', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "关口计量点 电压互感器 配置 三相 单相", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:49:48.964 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "关口计量点 电压互感器 配置 三相 单相", "knowledge_base_name": "二次"}
2025-08-08 21:49:49.006 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '关口计量点 电压互感器 配置 三相 单相...', top_k: 5
2025-08-08 21:49:49.006 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:49:49.084 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:49:49.084 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='关口计量点 电压互感器 配置 三相 单相...', top_k=5
2025-08-08 21:49:49.273 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 5 条结果。
2025-08-08 21:49:49.280 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:49:50.908 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_831c89ce879847e188749057', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "关口计量点 专用电压互感器 配置", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:49:50.909 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "关口计量点 专用电压互感器 配置", "knowledge_base_name": "二次"}
2025-08-08 21:49:50.951 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '关口计量点 专用电压互感器 配置...', top_k: 5
2025-08-08 21:49:50.951 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:49:51.035 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:49:51.035 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='关口计量点 专用电压互感器 配置...', top_k=5
2025-08-08 21:49:51.235 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 5 条结果。
2025-08-08 21:49:51.242 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:51:01.287 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-08 21:51:01.287 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 2329efb8-466e-4b4b-b503-81eee37c442a, 对话ID: 8d7b67d1-5843-46e3-addf-9cfd3250d8df, 查询: 是考核点，不是关口点
2025-08-08 21:51:01.287 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:51:08.634 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_c6f9278b5f56408fb6f9856b', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "考核点 计量电压互感器 三相配置 内部考核", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:51:08.634 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "考核点 计量电压互感器 三相配置 内部考核", "knowledge_base_name": "二次"}
2025-08-08 21:51:08.676 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '考核点 计量电压互感器 三相配置 内部考核...', top_k: 5
2025-08-08 21:51:08.676 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:51:08.766 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:51:08.766 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='考核点 计量电压互感器 三相配置 内部考核...', top_k=5
2025-08-08 21:51:08.986 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 5 条结果。
2025-08-08 21:51:08.993 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:51:14.573 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_a75970d772484d058051fb37', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "内部考核点 电能计量 电压互感器 配置原则", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:51:14.573 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "内部考核点 电能计量 电压互感器 配置原则", "knowledge_base_name": "二次"}
2025-08-08 21:51:14.614 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '内部考核点 电能计量 电压互感器 配置原则...', top_k: 5
2025-08-08 21:51:14.614 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:51:14.703 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:51:14.703 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='内部考核点 电能计量 电压互感器 配置原则...', top_k=5
2025-08-08 21:51:14.876 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 4 条结果。
2025-08-08 21:51:14.883 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:51:17.935 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_f050af3e6e7747e0acc13454', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "考核用电能计量点 电压互感器 配置 三相 单相", "knowledge_base_name": "二次"}'}}]
2025-08-08 21:51:17.935 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "考核用电能计量点 电压互感器 配置 三相 单相", "knowledge_base_name": "二次"}
2025-08-08 21:51:17.988 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '考核用电能计量点 电压互感器 配置 三相 单相...', top_k: 5
2025-08-08 21:51:17.988 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-08 21:51:18.069 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-08 21:51:18.069 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='考核用电能计量点 电压互感器 配置 三相 单相...', top_k=5
2025-08-08 21:51:18.251 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 5 条结果。
2025-08-08 21:51:18.259 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5
2025-08-08 21:51:56.910 | DEBUG    | core.session:logout_user:152 - 用户 'admin' (会话: 2329efb8-466e-4b4b-b503-81eee37c442a) 已从状态管理器登出。
2025-08-08 21:51:56.911 | DEBUG    | core.session:logout_user:154 - 用户 'admin' 登出时，其WebSocket连接处于活动状态，将尝试关闭。
2025-08-08 21:51:56.949 | INFO     | api.route:logout:80 - HTTP会话已清除 (用户: admin)。
2025-08-08 21:51:56.950 | DEBUG    | sse_proxy.sse2websocket1:run:304 - WebSocket 会话 2329efb8-466e-4b4b-b503-81eee37c442a 用户 admin 断开连接
2025-08-08 21:51:56.950 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-09 09:42:34.958 | INFO     | __main__:<module>:35 - Loguru 日志系统已初始化。
2025-08-09 09:42:34.958 | INFO     | __main__:<module>:36 - 项目根目录配置为: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-09 09:42:34.958 | INFO     | __main__:<module>:37 - 数据库路径配置为: data/document_service.db
2025-08-09 09:42:34.959 | INFO     | __main__:<module>:38 - 表格列读取配置已加载: {'变电站安装工程概算表': (2, 6), '变电站建筑工程概算表': (2, 6), '电缆输电线路安装工程概算表': (2, 6), '电缆输电线路建筑工程概算表': (2, 6)}
2025-08-09 09:42:34.959 | INFO     | __main__:<module>:39 - kkFileView 服务地址配置为: http://127.0.0.1:8012/kkfileview
2025-08-09 09:42:34.959 | INFO     | __main__:<module>:42 - Dify Agent API Key: ********kGHe
2025-08-09 09:42:34.959 | INFO     | __main__:<module>:43 - Session Secret Key: ********f0d3
2025-08-09 09:42:34.959 | INFO     | __main__:<module>:44 - 服务器ipv6地址为: http://[240e:479:668:3c1c:b5dc:e5a6:a573:f7a9]:8888
2025-08-09 09:42:34.960 | INFO     | __main__:<module>:151 - FastAPI 应用已实例化并注册到 app_state。
2025-08-09 09:42:34.960 | INFO     | __main__:<module>:154 - CORS中间件已添加，允许所有来源。
2025-08-09 09:42:34.971 | INFO     | __main__:<module>:174 - MCP 服务器 '项目文件检索服务器' 已挂载到 FastAPI 应用的 '/mcp/' 路径。
2025-08-09 09:42:34.987 | INFO     | __main__:combined_lifespan:64 - COMBINED LIFESPAN START - PID: 1612042 - 服务器启动中...
2025-08-09 09:42:35.021 | INFO     | __main__:combined_lifespan:69 - HTTPX 客户端已创建并注册到 app_state。
2025-08-09 09:42:35.021 | INFO     | utils.utils:check_embedding_service_health:28 - 正在检查嵌入模型服务，目标URL: http://127.0.0.1:8001/v1/models
2025-08-09 09:42:35.027 | INFO     | utils.utils:check_embedding_service_health:37 - 嵌入模型服务可用，模型列表: ['/home/zhouxiang/models/BAAI_bge-m3']
2025-08-09 09:42:35.027 | INFO     | core.session:__init__:79 - SessionStateManager已初始化。整体HTTP不活动超时: 3600秒
2025-08-09 09:42:35.027 | INFO     | __main__:combined_lifespan:77 - SessionStateManager 已实例化并注册到 app_state。
2025-08-09 09:42:35.027 | INFO     | database.document_service:__init__:164 - 有效文档根目录: {'项目文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/Projects1'), '规范文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/规程规范'), '管理文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/管理文件')}
2025-08-09 09:42:35.027 | DEBUG    | database.document_service:_init_db:180 - 初始化数据库
2025-08-09 09:42:35.028 | DEBUG    | database.document_service:_init_db:201 - 数据库初始化完成
2025-08-09 09:42:35.028 | INFO     | database.document_service:__init__:177 - DocumentQueryService 初始化完成
2025-08-09 09:42:35.028 | INFO     | database.document_service:full_scan:324 - 开始全量扫描...
2025-08-09 09:42:35.028 | INFO     | database.document_service:full_scan:327 - 正在扫描 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-09 09:42:42.833 | INFO     | database.document_service:full_scan:327 - 正在扫描 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-09 09:42:43.054 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_12_479_254_639_268_0.jpg
2025-08-09 09:42:43.054 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_19_1142_1062_132_174_0.jpg
2025-08-09 09:42:43.055 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_67_179_250_1020_1864_0.jpg
2025-08-09 09:42:43.055 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_68_163_248_1019_1887_0.jpg
2025-08-09 09:42:43.055 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_235_1053_1153_960_0.jpg
2025-08-09 09:42:43.055 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_257_392_1118_414_0.jpg
2025-08-09 09:42:43.055 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_227_383_1163_510_0.jpg
2025-08-09 09:42:43.056 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_234_1152_1146_503_0.jpg
2025-08-09 09:42:43.056 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_71_416_1374_824_646_0.jpg
2025-08-09 09:42:43.056 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_73_362_1146_917_618_0.jpg
2025-08-09 09:42:43.056 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_74_573_1274_462_123_0.jpg
2025-08-09 09:42:43.056 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_76_248_1224_1104_782_0.jpg
2025-08-09 09:42:43.057 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_78_242_276_1113_842_0.jpg
2025-08-09 09:42:43.057 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_80_347_280_898_515_0.jpg
2025-08-09 09:42:43.057 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_86_210_747_1187_915_0.jpg
2025-08-09 09:42:43.057 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_87_238_256_1180_936_0.jpg
2025-08-09 09:42:43.057 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_91_256_269_1156_955_0.jpg
2025-08-09 09:42:43.057 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_232_301_1140_940_0.jpg
2025-08-09 09:42:43.058 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_233_1466_1147_602_0.jpg
2025-08-09 09:42:43.058 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_93_324_268_737_1834_0.jpg
2025-08-09 09:42:43.062 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_361_435_977_304_0.jpg
2025-08-09 09:42:43.062 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_616_930_468_258_0.jpg
2025-08-09 09:42:43.062 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_287_1114_1128_645_0.jpg
2025-08-09 09:42:43.062 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_304_320_1113_638_0.jpg
2025-08-09 09:42:43.062 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_214_315_1133_645_0.jpg
2025-08-09 09:42:43.063 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_220_1122_1142_645_0.jpg
2025-08-09 09:42:43.063 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_287_1119_1136_651_0.jpg
2025-08-09 09:42:43.063 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_299_324_1134_642_0.jpg
2025-08-09 09:42:43.063 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_203_320_1145_655_0.jpg
2025-08-09 09:42:43.063 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_227_1129_1130_645_0.jpg
2025-08-09 09:42:43.064 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_290_1126_1125_656_0.jpg
2025-08-09 09:42:43.064 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_306_322_1119_646_0.jpg
2025-08-09 09:42:43.064 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_212_221_1133_659_0.jpg
2025-08-09 09:42:43.064 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_225_1049_1127_636_0.jpg
2025-08-09 09:42:43.064 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_0_1237_154_289_162_0.jpg
2025-08-09 09:42:43.064 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_253_704_552_467_0.jpg
2025-08-09 09:42:43.065 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_884_684_459_455_0.jpg
2025-08-09 09:42:43.065 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_143_500_318_578_556_0.jpg
2025-08-09 09:42:43.065 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_146_315_228_1095_400_0.jpg
2025-08-09 09:42:43.065 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_150_286_250_1129_814_0.jpg
2025-08-09 09:42:43.065 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_248_725_1164_564_0.jpg
2025-08-09 09:42:43.066 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_388_215_897_435_0.jpg
2025-08-09 09:42:43.066 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_287_1311_1133_384_0.jpg
2025-08-09 09:42:43.066 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_70_393_948_902_341_0.jpg
2025-08-09 09:42:43.066 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_72_258_681_1160_1355_0.jpg
2025-08-09 09:42:43.066 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_75_240_362_1177_1656_0.jpg
2025-08-09 09:42:43.066 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_78_240_318_1168_1731_0.jpg
2025-08-09 09:42:43.067 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_81_248_343_1165_1687_0.jpg
2025-08-09 09:42:43.067 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_84_238_386_1162_1624_0.jpg
2025-08-09 09:42:43.067 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_86_239_653_1166_1338_0.jpg
2025-08-09 09:42:43.067 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_88_623_450_653_646_0.jpg
2025-08-09 09:42:43.067 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_90_238_296_1174_1720_0.jpg
2025-08-09 09:42:43.068 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_91_225_299_1187_1707_0.jpg
2025-08-09 09:42:43.068 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_94_257_289_1171_1697_0.jpg
2025-08-09 09:42:43.068 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_97_227_303_1170_1731_0.jpg
2025-08-09 09:42:43.068 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_101_225_672_1178_1353_0.jpg
2025-08-09 09:42:43.068 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_102_240_291_1203_1722_0.jpg
2025-08-09 09:42:43.068 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_103_240_297_1178_1734_0.jpg
2025-08-09 09:42:43.069 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_119_475_1184_667_691_0.jpg
2025-08-09 09:42:43.069 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_121_593_1023_425_178_0.jpg
2025-08-09 09:42:43.069 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_122_444_294_775_206_0.jpg
2025-08-09 09:42:43.069 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_413_902_778_279_0.jpg
2025-08-09 09:42:43.069 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_419_1314_768_347_0.jpg
2025-08-09 09:42:43.070 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_126_387_330_904_455_0.jpg
2025-08-09 09:42:43.070 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_129_362_691_912_684_0.jpg
2025-08-09 09:42:43.070 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_137_501_1634_612_391_0.jpg
2025-08-09 09:42:43.070 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_138_536_226_623_387_0.jpg
2025-08-09 09:42:43.070 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_177_316_1559_1037_507_0.jpg
2025-08-09 09:42:43.070 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_187_373_890_922_309_0.jpg
2025-08-09 09:42:43.071 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_389_874_879_339_0.jpg
2025-08-09 09:42:43.071 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_509_232_635_564_0.jpg
2025-08-09 09:42:43.071 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_514_1307_644_653_0.jpg
2025-08-09 09:42:43.071 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_318_1309_1020_458_0.jpg
2025-08-09 09:42:43.071 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_397_458_892_388_0.jpg
2025-08-09 09:42:43.071 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_539_1403_583_424_0.jpg
2025-08-09 09:42:43.072 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_194_438_645_754_434_0.jpg
2025-08-09 09:42:43.072 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_365_222_908_608_0.jpg
2025-08-09 09:42:43.072 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_385_1267_869_447_0.jpg
2025-08-09 09:42:43.072 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_206_501_795_660_1153_0.jpg
2025-08-09 09:42:43.072 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_208_581_1522_499_443_0.jpg
2025-08-09 09:42:43.073 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_209_536_235_551_971_0.jpg
2025-08-09 09:42:43.073 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_210_246_516_270_300_0.jpg
2025-08-09 09:42:43.073 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_128_411_445_833_494_0.jpg
2025-08-09 09:42:43.073 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_428_384_769_490_0.jpg
2025-08-09 09:42:43.073 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_49_529_271_627_470_0.jpg
2025-08-09 09:42:43.073 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_66_257_325_1140_552_0.jpg
2025-08-09 09:42:43.074 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_1090_878_289_229_0.jpg
2025-08-09 09:42:43.074 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_432_894_219_206_0.jpg
2025-08-09 09:42:43.074 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_728_895_247_200_0.jpg
2025-08-09 09:42:43.074 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1095_623_266_169_0.jpg
2025-08-09 09:42:43.074 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1141_832_201_101_0.jpg
2025-08-09 09:42:43.074 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_444_641_235_139_0.jpg
2025-08-09 09:42:43.075 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_459_831_166_104_0.jpg
2025-08-09 09:42:43.075 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_724_603_276_178_0.jpg
2025-08-09 09:42:43.075 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_747_821_223_122_0.jpg
2025-08-09 09:42:43.083 | INFO     | database.document_service:full_scan:327 - 正在扫描 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-09 09:42:43.083 | INFO     | database.document_service:full_scan:332 - 全量扫描完成，共处理文件数: 1581
2025-08-09 09:42:43.083 | DEBUG    | database.document_service:_start_watchdog:335 - 启动文件监控 Watchdog
2025-08-09 09:42:43.084 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-09 09:42:43.084 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-09 09:42:43.084 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-09 09:42:43.100 | INFO     | database.document_service:_start_watchdog:423 - Watchdog 已启动
2025-08-09 09:42:43.100 | INFO     | database.document_service:start:465 - DocumentQueryService 已启动
2025-08-09 09:42:43.100 | INFO     | __main__:combined_lifespan:83 - 统一文档查询服务 (DocumentQueryService) 已启动。
2025-08-09 09:42:43.100 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/Projects1', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-09 09:42:43.101 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/规程规范', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-09 09:42:43.101 | INFO     | __main__:combined_lifespan:88 - 项目和规程的文件服务已初始化。
2025-08-09 09:42:43.102 | INFO     | __main__:combined_lifespan:93 - AsyncIOScheduler 已实例化并注册到 app_state。
2025-08-09 09:42:43.102 | INFO     | __main__:combined_lifespan:97 - FastMCP lifespan context entered.
2025-08-09 09:42:43.102 | INFO     | __main__:combined_lifespan:117 - 处理不活动用户会话任务已添加到APScheduler (每 60s)。
2025-08-09 09:42:43.102 | INFO     | __main__:combined_lifespan:120 - 清理用户会话中已打开文件token任务已添加到APScheduler (每 120s)。
2025-08-09 09:42:43.103 | INFO     | __main__:combined_lifespan:123 - APScheduler 调度器已启动。
2025-08-09 09:42:43.103 | INFO     | __main__:combined_lifespan:124 - 所有初始化完成... yield
2025-08-09 09:42:43.103 | DEBUG    | database.document_service:_debounced_update_loop:426 - 启动去抖更新循环
2025-08-09 09:42:48.873 | INFO     | core.session:attempt_login:142 - 用户 'admin' (会话: be83e5ed-cd52-48fb-b524-ba3436abcd65, IP: 240e:3a1:7d0:ab80::e7) 登录/状态更新成功。
2025-08-09 09:42:48.873 | INFO     | api.route:login:69 - 用户 'admin' (IP: 240e:3a1:7d0:ab80::e7, Session: be83e5ed-cd52-48fb-b524-ba3436abcd65) 登录成功。
2025-08-09 09:42:49.155 | INFO     | core.session:connect_websocket:93 - 用户 'admin' (会话: be83e5ed-cd52-48fb-b524-ba3436abcd65) 的 WebSocket 已连接并关联。
2025-08-09 09:42:49.227 | DEBUG    | sse_proxy.sse2websocket1:run:243 - 获取到的工具列表: ['query_specification_knowledge_base', 'diff_project_file', 'read_project_file', 'query_project_files', 'open_specification_files', 'write_review_doc']
2025-08-09 09:42:51.509 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-09 09:43:09.178 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-09 09:43:09.179 | INFO     | api.admin:update_admin_config:164 - 从服务商 'zhipu' 的预设中加载了 API Key。
2025-08-09 09:43:09.179 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_API_BASE_URL' 已更新为: https://open.bigmodel.cn/api/paas/v4/
2025-08-09 09:43:09.179 | INFO     | api.admin:update_admin_config:183 - 运行时配置 'OPENAI_MODEL_NAME' 已更新为: GLM-4.5-Air
2025-08-09 09:43:09.179 | INFO     | api.admin:update_admin_config:180 - 运行时配置 'OPENAI_API_KEY' 已更新为: ******Yj8a
2025-08-09 09:43:09.202 | DEBUG    | api.admin:admin_access:38 - Admin access granted for user 'admin' from IP '240e:3a1:7d0:ab80::e7'.
2025-08-09 09:43:15.703 | INFO     | sse_proxy.sse2websocket1:run:276 - 收到新对话开始事件，对话ID: de1bdf62-0986-43a1-8c52-d76f8257f2fd。清空历史记录。
2025-08-09 09:43:21.610 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-09 09:43:21.611 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 be83e5ed-cd52-48fb-b524-ba3436abcd65, 对话ID: de1bdf62-0986-43a1-8c52-d76f8257f2fd, 查询: 找下二次的规范
2025-08-09 09:43:21.611 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Air
2025-08-09 09:43:25.630 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_86bd3c7744a043e9a8e66864', 'type': 'function', 'function': {'name': 'open_specification_files', 'arguments': '{"user": "admin", "query_spec_filename": "二次的规范", "category": "二次"}'}}]
2025-08-09 09:43:25.630 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: open_specification_files with args: {"user": "admin", "query_spec_filename": "二次的规范", "category": "二次"}
2025-08-09 09:43:25.673 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:835 - 工具调用: open_specification_files, 查询: '二次的规范', 类别: '二次', 读取文件: False, Top N: 10
2025-08-09 09:43:25.673 | DEBUG    | database.document_service:_db_query:550 - 查询规范文件分类 (适配器): 二次
2025-08-09 09:43:25.674 | INFO     | database.document_service:_db_query:571 - 查询到 '二次' 分类的规范共 16 条
2025-08-09 09:43:25.674 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-09 09:43:25.878 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-10 结果: [('变电站辅助设备监控系统设计规范', 0.4869622268802327), ('QGDW 11486-2022 继电保护和安全自动装置验收规范', 0.4852414133568225), ('GB∕T 38435-2019 牵引站供电线路的继电保护配置及整定计算原则', 0.47240110362443405), ('QGDW 10766-2024 10kV～110（66）kV 线路保护及辅助装置标准化设计规范', 0.4715388421897029), ('GB∕T_40581-2021 电力系统安全稳定计算规范', 0.4626402130415741), ('IEEE 移相变压器继电保护应用指南 双语对照-2024-12-31-20-34-13', 0.4619650271556448), ('45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md', 0.4528124753333614), ('NBT 11315-2023 变电站辅助控制系统设计规程', 0.44499179521143195), ('DL∕T 448-2016 电能计量装置技术管理规程', 0.4427666324269439), ('GB∕T 37755-2019 智能变电站光纤回路建模及编码技术规范', 0.4318646629419164)]
2025-08-09 09:43:25.884 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Air
2025-08-09 09:43:37.365 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-09 09:43:37.365 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 be83e5ed-cd52-48fb-b524-ba3436abcd65, 对话ID: de1bdf62-0986-43a1-8c52-d76f8257f2fd, 查询: 打开2
2025-08-09 09:43:37.365 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Air
2025-08-09 09:43:41.254 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_9a4104a61f01487d88f96f0d', 'type': 'function', 'function': {'name': 'open_specification_files', 'arguments': '{"user": "admin", "query_spec_filename": "QGDW 11486-2022 继电保护和安全自动装置验收规范", "category": "二次", "read_file": true, "top_n": 1}'}}]
2025-08-09 09:43:41.254 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: open_specification_files with args: {"user": "admin", "query_spec_filename": "QGDW 11486-2022 继电保护和安全自动装置验收规范", "category": "二次", "read_file": true, "top_n": 1}
2025-08-09 09:43:41.297 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:835 - 工具调用: open_specification_files, 查询: 'QGDW 11486-2022 继电保护和安全自动装置验收规范', 类别: '二次', 读取文件: True, Top N: 1
2025-08-09 09:43:41.298 | DEBUG    | database.document_service:_db_query:550 - 查询规范文件分类 (适配器): 二次
2025-08-09 09:43:41.298 | INFO     | database.document_service:_db_query:571 - 查询到 '二次' 分类的规范共 16 条
2025-08-09 09:43:41.298 | DEBUG    | my_mcp_tools.mcp_tools:_get_embeddings:171 - 正在调用嵌入模型: base_url='http://127.0.0.1:8001/v1', model='/home/zhouxiang/models/BAAI_bge-m3'
2025-08-09 09:43:41.506 | DEBUG    | my_mcp_tools.mcp_tools:_find_similar_items_with_scores:201 - 向量检索 Top-1 结果: [('QGDW 11486-2022 继电保护和安全自动装置验收规范', 0.9999999999999999)]
2025-08-09 09:43:41.506 | INFO     | my_mcp_tools.mcp_tools:open_specification_files:882 - 最匹配文件 '二次/QGDW 11486-2022 继电保护和安全自动装置验收规范/QGDW 11486-2022 继电保护和安全自动装置验收规范.pdf' 相似度(1.0000) > 0.7，准备读取内容。
2025-08-09 09:43:41.506 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:83 - MCP Tool: 尝试解析文件: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/QGDW 11486-2022 继电保护和安全自动装置验收规范/QGDW 11486-2022 继电保护和安全自动装置验收规范.pdf (相对路径: 二次/QGDW 11486-2022 继电保护和安全自动装置验收规范/QGDW 11486-2022 继电保护和安全自动装置验收规范.pdf)，分隔符: '
'
2025-08-09 09:43:43.278 | DEBUG    | my_mcp_tools.mcp_tools:_get_file_content:88 - MCP Tool: 解析完成，文件: QGDW 11486-2022 继电保护和安全自动装置验收规范.pdf, 内容长度: 35097
2025-08-09 09:43:43.278 | INFO     | core.session:update_opened_file:310 - 用户 'admin' 已打开文件 '二次/QGDW 11486-2022 继电保护和安全自动装置验收规范/QGDW 11486-2022 继电保护和安全自动装置验收规范.pdf' (token: fde4b7fdb8b548cb8c44653f6a96df2f), 有效期至: Sat Aug  9 17:43:43 2025
2025-08-09 09:43:43.292 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Air
2025-08-09 09:43:43.343 | DEBUG    | api.kkfileview:kkfileview_preview_encoder_proxy:31 - 用户 'admin' 请求预览文件，原始 kkFileView 目标 URL (来自前端): http://host.docker.internal:8888/download/fde4b7fdb8b548cb8c44653f6a96df2f/QGDW 11486-2022 继电保护和安全自动装置验收规范.pdf
2025-08-09 09:43:43.570 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'QGDW 11486-2022 继电保护和安全自动装置验收规范_5d8bb518.pdf' 与Token关联文件名 'QGDW 11486-2022 继电保护和安全自动装置验收规范.pdf' 不匹配。将使用Token关联文件名。
2025-08-09 09:43:43.570 | DEBUG    | api.route:download_file_via_token:186 - Token 'fde4b7fdb8b548cb8c44653f6a96df2f' 验证成功。准备下载文件: 'QGDW 11486-2022 继电保护和安全自动装置验收规范.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/规程规范/二次/QGDW 11486-2022 继电保护和安全自动装置验收规范/QGDW 11486-2022 继电保护和安全自动装置验收规范.pdf', URL文件名: 'QGDW 11486-2022 继电保护和安全自动装置验收规范_5d8bb518.pdf')
2025-08-09 09:43:43.572 | WARNING  | api.route:download_file_via_token:175 - 下载请求中URL文件名 'QGDW 11486-2022 继电保护和安全自动装置验收规范_5d8bb518.pdf' 与Token关联文件名 'QGDW 11486-2022 继电保护和安全自动装置验收规范.pdf' 不匹配。将使用Token关联文件名。
2025-08-09 09:43:43.572 | DEBUG    | api.route:download_file_via_token:186 - Token 'fde4b7fdb8b548cb8c44653f6a96df2f' 验证成功。准备下载文件: 'QGDW 11486-2022 继电保护和安全自动装置验收规范.pdf' (路径: '/media/zhouxiang/FC7C74827C743A0A/规程规范/二次/QGDW 11486-2022 继电保护和安全自动装置验收规范/QGDW 11486-2022 继电保护和安全自动装置验收规范.pdf', URL文件名: 'QGDW 11486-2022 继电保护和安全自动装置验收规范_5d8bb518.pdf')
2025-08-09 09:46:28.122 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-09 09:46:28.122 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 be83e5ed-cd52-48fb-b524-ba3436abcd65, 对话ID: de1bdf62-0986-43a1-8c52-d76f8257f2fd, 查询: 合并单元跟保护之间的经过5台交换机可以吗
2025-08-09 09:46:28.122 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Air
2025-08-09 09:47:41.203 | DEBUG    | sse_proxy.sse2websocket1:_stop:94 - OpenAIWebSocketProxy._stop stop_event.set()
2025-08-09 09:47:41.204 | INFO     | sse_proxy.sse2websocket1:run:299 - 启动OpenAI转发：用户 admin, 会话 be83e5ed-cd52-48fb-b524-ba3436abcd65, 对话ID: de1bdf62-0986-43a1-8c52-d76f8257f2fd, 查询: 二次接地铜排的小绝缘子是否需要，一般怎么接地
2025-08-09 09:47:41.204 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Air
2025-08-09 09:47:43.987 | INFO     | sse_proxy.sse2websocket1:_handle_stream:154 - 触发工具调用: [{'id': 'call_7ddc027694674e1f9af501b1', 'type': 'function', 'function': {'name': 'query_specification_knowledge_base', 'arguments': '{"user_query": "二次接地铜排 绝缘子 接地方式", "knowledge_base_name": "二次", "top_k": 5}'}}]
2025-08-09 09:47:43.987 | INFO     | sse_proxy.sse2websocket1:_execute_tool_calls:190 - 执行工具调用: query_specification_knowledge_base with args: {"user_query": "二次接地铜排 绝缘子 接地方式", "knowledge_base_name": "二次", "top_k": 5}
2025-08-09 09:47:44.029 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:266 - 工具调用: query_specification_knowledge_base, 知识库: 二次, 用户查询: '二次接地铜排 绝缘子 接地方式...', top_k: 5
2025-08-09 09:47:44.029 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:279 - 正在从 http://127.0.0.1/v1/datasets 获取知识库ID，参数: {'keyword': '二次', 'page': 1, 'limit': 10}
2025-08-09 09:47:44.227 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:293 - 成功获取到知识库 '二次' 的ID: eaee81cc-3cb5-4649-89b0-9e702a659131
2025-08-09 09:47:44.227 | DEBUG    | my_mcp_tools.mcp_tools:query_specification_knowledge_base:307 - 正在向 http://127.0.0.1/v1/datasets/eaee81cc-3cb5-4649-89b0-9e702a659131/retrieve 发起检索请求。Payload (部分): query='二次接地铜排 绝缘子 接地方式...', top_k=5
2025-08-09 09:47:44.704 | INFO     | my_mcp_tools.mcp_tools:query_specification_knowledge_base:314 - 从知识库 '二次' 检索到 3 条结果。
2025-08-09 09:47:44.711 | DEBUG    | sse_proxy.sse2websocket1:_handle_stream:119 - 调用openai_client,model:GLM-4.5-Air
2025-08-09 16:07:01.598 | INFO     | __main__:<module>:35 - Loguru 日志系统已初始化。
2025-08-09 16:07:01.598 | INFO     | __main__:<module>:36 - 项目根目录配置为: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-09 16:07:01.598 | INFO     | __main__:<module>:37 - 数据库路径配置为: data/document_service.db
2025-08-09 16:07:01.598 | INFO     | __main__:<module>:38 - 表格列读取配置已加载: {'变电站安装工程概算表': (2, 6), '变电站建筑工程概算表': (2, 6), '电缆输电线路安装工程概算表': (2, 6), '电缆输电线路建筑工程概算表': (2, 6)}
2025-08-09 16:07:01.598 | INFO     | __main__:<module>:39 - kkFileView 服务地址配置为: http://127.0.0.1:8012/kkfileview
2025-08-09 16:07:01.598 | INFO     | __main__:<module>:42 - Dify Agent API Key: ********kGHe
2025-08-09 16:07:01.598 | INFO     | __main__:<module>:43 - Session Secret Key: ********f930
2025-08-09 16:07:01.598 | INFO     | __main__:<module>:44 - 服务器ipv6地址为: http://[240e:479:668:3c1c:b5dc:e5a6:a573:f7a9]:8888
2025-08-09 16:07:01.599 | INFO     | __main__:<module>:151 - FastAPI 应用已实例化并注册到 app_state。
2025-08-09 16:07:01.599 | INFO     | __main__:<module>:154 - CORS中间件已添加，允许所有来源。
2025-08-09 16:07:01.609 | INFO     | __main__:<module>:174 - MCP 服务器 '项目文件检索服务器' 已挂载到 FastAPI 应用的 '/mcp/' 路径。
2025-08-09 16:07:01.623 | INFO     | __main__:combined_lifespan:64 - COMBINED LIFESPAN START - PID: 2187782 - 服务器启动中...
2025-08-09 16:07:01.656 | INFO     | __main__:combined_lifespan:69 - HTTPX 客户端已创建并注册到 app_state。
2025-08-09 16:07:01.657 | INFO     | utils.utils:check_embedding_service_health:28 - 正在检查嵌入模型服务，目标URL: http://127.0.0.1:8001/v1/models
2025-08-09 16:07:01.663 | INFO     | utils.utils:check_embedding_service_health:37 - 嵌入模型服务可用，模型列表: ['/home/zhouxiang/models/BAAI_bge-m3']
2025-08-09 16:07:01.663 | INFO     | core.session:__init__:79 - SessionStateManager已初始化。整体HTTP不活动超时: 3600秒
2025-08-09 16:07:01.663 | INFO     | __main__:combined_lifespan:77 - SessionStateManager 已实例化并注册到 app_state。
2025-08-09 16:07:01.663 | INFO     | database.document_service:__init__:164 - 有效文档根目录: {'项目文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/Projects1'), '规范文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/规程规范'), '管理文件': PosixPath('/media/zhouxiang/FC7C74827C743A0A/管理文件')}
2025-08-09 16:07:01.663 | DEBUG    | database.document_service:_init_db:180 - 初始化数据库
2025-08-09 16:07:01.663 | DEBUG    | database.document_service:_init_db:201 - 数据库初始化完成
2025-08-09 16:07:01.664 | INFO     | database.document_service:__init__:177 - DocumentQueryService 初始化完成
2025-08-09 16:07:01.664 | INFO     | database.document_service:full_scan:324 - 开始全量扫描...
2025-08-09 16:07:01.664 | INFO     | database.document_service:full_scan:327 - 正在扫描 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-09 16:07:06.960 | INFO     | database.document_service:full_scan:327 - 正在扫描 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-09 16:07:07.170 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_12_479_254_639_268_0.jpg
2025-08-09 16:07:07.171 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/45_DLT-559-2018《220kV～750kV电网继电保护装置运行整定规程》_md/images/01930a72-0c64-7cdb-a401-2ec51e0c6a0c_19_1142_1062_132_174_0.jpg
2025-08-09 16:07:07.171 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_67_179_250_1020_1864_0.jpg
2025-08-09 16:07:07.171 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_68_163_248_1019_1887_0.jpg
2025-08-09 16:07:07.171 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_235_1053_1153_960_0.jpg
2025-08-09 16:07:07.171 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_69_257_392_1118_414_0.jpg
2025-08-09 16:07:07.171 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_227_383_1163_510_0.jpg
2025-08-09 16:07:07.171 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_70_234_1152_1146_503_0.jpg
2025-08-09 16:07:07.172 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_71_416_1374_824_646_0.jpg
2025-08-09 16:07:07.172 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_73_362_1146_917_618_0.jpg
2025-08-09 16:07:07.172 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_74_573_1274_462_123_0.jpg
2025-08-09 16:07:07.172 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_76_248_1224_1104_782_0.jpg
2025-08-09 16:07:07.172 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_78_242_276_1113_842_0.jpg
2025-08-09 16:07:07.172 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_80_347_280_898_515_0.jpg
2025-08-09 16:07:07.172 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_86_210_747_1187_915_0.jpg
2025-08-09 16:07:07.173 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_87_238_256_1180_936_0.jpg
2025-08-09 16:07:07.173 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_91_256_269_1156_955_0.jpg
2025-08-09 16:07:07.173 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_232_301_1140_940_0.jpg
2025-08-09 16:07:07.173 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_92_233_1466_1147_602_0.jpg
2025-08-09 16:07:07.173 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/二次/GB／T-14285—2023《继电保护和安全自动装置技术规程》_md/images/0192c7f5-081b-72f2-a3c6-178676ec608a_93_324_268_737_1834_0.jpg
2025-08-09 16:07:07.176 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_361_435_977_304_0.jpg
2025-08-09 16:07:07.177 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_616_930_468_258_0.jpg
2025-08-09 16:07:07.177 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_287_1114_1128_645_0.jpg
2025-08-09 16:07:07.177 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_68_304_320_1113_638_0.jpg
2025-08-09 16:07:07.177 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_214_315_1133_645_0.jpg
2025-08-09 16:07:07.177 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_69_220_1122_1142_645_0.jpg
2025-08-09 16:07:07.177 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_287_1119_1136_651_0.jpg
2025-08-09 16:07:07.178 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_70_299_324_1134_642_0.jpg
2025-08-09 16:07:07.178 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_203_320_1145_655_0.jpg
2025-08-09 16:07:07.178 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_71_227_1129_1130_645_0.jpg
2025-08-09 16:07:07.178 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_290_1126_1125_656_0.jpg
2025-08-09 16:07:07.178 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_72_306_322_1119_646_0.jpg
2025-08-09 16:07:07.178 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_212_221_1133_659_0.jpg
2025-08-09 16:07:07.178 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_73_225_1049_1127_636_0.jpg
2025-08-09 16:07:07.178 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_0_1237_154_289_162_0.jpg
2025-08-09 16:07:07.179 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_253_704_552_467_0.jpg
2025-08-09 16:07:07.179 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_141_884_684_459_455_0.jpg
2025-08-09 16:07:07.179 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_143_500_318_578_556_0.jpg
2025-08-09 16:07:07.179 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_146_315_228_1095_400_0.jpg
2025-08-09 16:07:07.179 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_150_286_250_1129_814_0.jpg
2025-08-09 16:07:07.179 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_248_725_1164_564_0.jpg
2025-08-09 16:07:07.179 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_152_388_215_897_435_0.jpg
2025-08-09 16:07:07.179 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/33-GB-50217-2018-电力工程电缆设计标准_md/33-GB-50217-2018-电力工程电缆设计标准_md/images/0193193b-d97d-7cb4-99d2-4c7216026569_32_287_1311_1133_384_0.jpg
2025-08-09 16:07:07.180 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_70_393_948_902_341_0.jpg
2025-08-09 16:07:07.180 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_72_258_681_1160_1355_0.jpg
2025-08-09 16:07:07.180 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_75_240_362_1177_1656_0.jpg
2025-08-09 16:07:07.180 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_78_240_318_1168_1731_0.jpg
2025-08-09 16:07:07.180 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_81_248_343_1165_1687_0.jpg
2025-08-09 16:07:07.180 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_84_238_386_1162_1624_0.jpg
2025-08-09 16:07:07.180 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_86_239_653_1166_1338_0.jpg
2025-08-09 16:07:07.180 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_88_623_450_653_646_0.jpg
2025-08-09 16:07:07.181 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_90_238_296_1174_1720_0.jpg
2025-08-09 16:07:07.181 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_91_225_299_1187_1707_0.jpg
2025-08-09 16:07:07.181 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_94_257_289_1171_1697_0.jpg
2025-08-09 16:07:07.181 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_97_227_303_1170_1731_0.jpg
2025-08-09 16:07:07.181 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_101_225_672_1178_1353_0.jpg
2025-08-09 16:07:07.181 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_102_240_291_1203_1722_0.jpg
2025-08-09 16:07:07.181 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_103_240_297_1178_1734_0.jpg
2025-08-09 16:07:07.181 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_119_475_1184_667_691_0.jpg
2025-08-09 16:07:07.182 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_121_593_1023_425_178_0.jpg
2025-08-09 16:07:07.182 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_122_444_294_775_206_0.jpg
2025-08-09 16:07:07.182 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_413_902_778_279_0.jpg
2025-08-09 16:07:07.182 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_123_419_1314_768_347_0.jpg
2025-08-09 16:07:07.182 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_126_387_330_904_455_0.jpg
2025-08-09 16:07:07.182 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_129_362_691_912_684_0.jpg
2025-08-09 16:07:07.182 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_137_501_1634_612_391_0.jpg
2025-08-09 16:07:07.182 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_138_536_226_623_387_0.jpg
2025-08-09 16:07:07.183 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_177_316_1559_1037_507_0.jpg
2025-08-09 16:07:07.183 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_187_373_890_922_309_0.jpg
2025-08-09 16:07:07.183 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_389_874_879_339_0.jpg
2025-08-09 16:07:07.183 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_509_232_635_564_0.jpg
2025-08-09 16:07:07.183 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_188_514_1307_644_653_0.jpg
2025-08-09 16:07:07.183 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_318_1309_1020_458_0.jpg
2025-08-09 16:07:07.183 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_397_458_892_388_0.jpg
2025-08-09 16:07:07.183 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_193_539_1403_583_424_0.jpg
2025-08-09 16:07:07.184 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_194_438_645_754_434_0.jpg
2025-08-09 16:07:07.184 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_365_222_908_608_0.jpg
2025-08-09 16:07:07.184 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_205_385_1267_869_447_0.jpg
2025-08-09 16:07:07.184 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_206_501_795_660_1153_0.jpg
2025-08-09 16:07:07.184 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_208_581_1522_499_443_0.jpg
2025-08-09 16:07:07.184 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_209_536_235_551_971_0.jpg
2025-08-09 16:07:07.184 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_210_246_516_270_300_0.jpg
2025-08-09 16:07:07.184 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_128_411_445_833_494_0.jpg
2025-08-09 16:07:07.185 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_192_428_384_769_490_0.jpg
2025-08-09 16:07:07.185 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_49_529_271_627_470_0.jpg
2025-08-09 16:07:07.185 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_66_257_325_1140_552_0.jpg
2025-08-09 16:07:07.185 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_1090_878_289_229_0.jpg
2025-08-09 16:07:07.185 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_432_894_219_206_0.jpg
2025-08-09 16:07:07.185 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_62_728_895_247_200_0.jpg
2025-08-09 16:07:07.185 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1095_623_266_169_0.jpg
2025-08-09 16:07:07.185 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_1141_832_201_101_0.jpg
2025-08-09 16:07:07.186 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_444_641_235_139_0.jpg
2025-08-09 16:07:07.186 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_459_831_166_104_0.jpg
2025-08-09 16:07:07.186 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_724_603_276_178_0.jpg
2025-08-09 16:07:07.186 | DEBUG    | database.document_service:upsert_document:284 - 跳过空文档或元信息失败: /media/zhouxiang/FC7C74827C743A0A/规程规范/电气/DLT-866-2015 电流互感器和电压互感器选择及计算规程_md/images/0192c8e0-9c9d-7840-a544-288f16eaf20f_63_747_821_223_122_0.jpg
2025-08-09 16:07:07.193 | INFO     | database.document_service:full_scan:327 - 正在扫描 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-09 16:07:07.193 | INFO     | database.document_service:full_scan:332 - 全量扫描完成，共处理文件数: 1581
2025-08-09 16:07:07.193 | DEBUG    | database.document_service:_start_watchdog:335 - 启动文件监控 Watchdog
2025-08-09 16:07:07.194 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '项目文件' 目录: /media/zhouxiang/FC7C74827C743A0A/Projects1
2025-08-09 16:07:07.194 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '规范文件' 目录: /media/zhouxiang/FC7C74827C743A0A/规程规范
2025-08-09 16:07:07.194 | INFO     | database.document_service:_start_watchdog:421 - 正在监控 '管理文件' 目录: /media/zhouxiang/FC7C74827C743A0A/管理文件
2025-08-09 16:07:07.210 | INFO     | database.document_service:_start_watchdog:423 - Watchdog 已启动
2025-08-09 16:07:07.211 | INFO     | database.document_service:start:465 - DocumentQueryService 已启动
2025-08-09 16:07:07.211 | INFO     | __main__:combined_lifespan:83 - 统一文档查询服务 (DocumentQueryService) 已启动。
2025-08-09 16:07:07.211 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/Projects1', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-09 16:07:07.211 | INFO     | core.file_service:__init__:38 - FileService 初始化完成。根目录: '/media/zhouxiang/FC7C74827C743A0A/规程规范', 临时目录: '/home/zhouxiang/mcp_file_server/tempfile'
2025-08-09 16:07:07.211 | INFO     | __main__:combined_lifespan:88 - 项目和规程的文件服务已初始化。
2025-08-09 16:07:07.212 | INFO     | __main__:combined_lifespan:93 - AsyncIOScheduler 已实例化并注册到 app_state。
2025-08-09 16:07:07.212 | INFO     | __main__:combined_lifespan:97 - FastMCP lifespan context entered.
2025-08-09 16:07:07.213 | INFO     | __main__:combined_lifespan:117 - 处理不活动用户会话任务已添加到APScheduler (每 60s)。
2025-08-09 16:07:07.213 | INFO     | __main__:combined_lifespan:120 - 清理用户会话中已打开文件token任务已添加到APScheduler (每 120s)。
2025-08-09 16:07:07.214 | INFO     | __main__:combined_lifespan:123 - APScheduler 调度器已启动。
2025-08-09 16:07:07.214 | INFO     | __main__:combined_lifespan:124 - 所有初始化完成... yield
2025-08-09 16:07:07.214 | DEBUG    | database.document_service:_debounced_update_loop:426 - 启动去抖更新循环
